!function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let s;function a(e,t){return e===t||(s||(s=document.createElement("a")),s.href=t,e===s.href)}function c(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t){for(const e of n)e(void 0);return e}const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(e){return null==e?"":e}function l(e,t,n){return e.set(n),t}const h="undefined"!=typeof window;let f=h?()=>window.performance.now():()=>Date.now(),d=h?e=>requestAnimationFrame(e):e;const p=new Set;function y(e){p.forEach((t=>{t.c(e)||(p.delete(t),t.f())})),0!==p.size&&d(y)}var g="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function b(e,t){e.appendChild(t)}function w(e,t,n){e.insertBefore(t,n||null)}function v(e){e.parentNode&&e.parentNode.removeChild(e)}function m(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function _(e){return document.createElement(e)}function x(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function E(e){return document.createTextNode(e)}function k(){return E(" ")}function S(){return E("")}function A(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function O(e){return function(t){return t.preventDefault(),e.call(this,t)}}function C(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function P(e,t){t=""+t,e.data!==t&&(e.data=t)}let I;function L(e){I=e}function j(){if(!I)throw new Error("Function called outside component initialization");return I}function T(e){j().$$.on_mount.push(e)}const B=[],R=[];let $=[];const U=[],N=Promise.resolve();let H=!1;function M(e){$.push(e)}function q(e){U.push(e)}const F=new Set;let D=0;function z(){if(0!==D)return;const e=I;do{try{for(;D<B.length;){const e=B[D];D++,L(e),K(e.$$)}}catch(e){throw B.length=0,D=0,e}for(L(null),B.length=0,D=0;R.length;)R.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];F.has(t)||(F.add(t),t())}$.length=0}while(B.length);for(;U.length;)U.pop()();H=!1,F.clear(),L(e)}function K(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(M)}}const G=new Set;let W;function V(){W={r:0,c:[],p:W}}function Y(){W.r||r(W.c),W=W.p}function Z(e,t){e&&e.i&&(G.delete(e),e.i(t))}function J(e,t,n,r){if(e&&e.o){if(G.has(e))return;G.add(e),W.c.push((()=>{G.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}function Q(e){return void 0!==e?.length?e:Array.from(e)}function X(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function ee(e){e&&e.c()}function te(e,n,i){const{fragment:s,after_update:a}=e.$$;s&&s.m(n,i),M((()=>{const n=e.$$.on_mount.map(t).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...n):r(n),e.$$.on_mount=[]})),a.forEach(M)}function ne(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];$.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),$=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function re(e,t){-1===e.$$.dirty[0]&&(B.push(e),H||(H=!0,N.then(z)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function oe(t,o,i,s,a,c,u,l=[-1]){const h=I;L(t);const f=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(h?h.$$.context:[])),callbacks:n(),dirty:l,skip_bound:!1,root:o.target||h.$$.root};u&&u(f.root);let d=!1;if(f.ctx=i?i(t,o.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&a(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),d&&re(t,e)),n})):[],f.update(),d=!0,r(f.before_update),f.fragment=!!s&&s(f.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);f.fragment&&f.fragment.l(e),e.forEach(v)}else f.fragment&&f.fragment.c();o.intro&&Z(t.$$.fragment),te(t,o.target,o.anchor),z()}L(h)}class ie{$$=void 0;$$set=void 0;$destroy(){ne(this,1),this.$destroy=e}$on(t,n){if(!o(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const se=[];function ae(t,n=e){let r;const o=new Set;function s(e){if(i(t,e)&&(t=e,r)){const e=!se.length;for(const e of o)e[1](),se.push(e,t);if(e){for(let e=0;e<se.length;e+=2)se[e][0](se[e+1]);se.length=0}}}function a(e){s(e(t))}return{set:s,update:a,subscribe:function(i,c=e){const u=[i,c];return o.add(u),1===o.size&&(r=n(s,a)||e),i(t),()=>{o.delete(u),0===o.size&&r&&(r(),r=null)}}}}const ce=ae(null),ue=ae({events:[],profiles:{}}),le=ae(null),he=ae(null),fe=ae({});function de(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function pe(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}const ye={number:de,bool:function(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)},bytes:pe,hash:function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");de(e.outputLen),de(e.blockLen)},exists:function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},output:function(e,t){pe(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}},ge="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,be=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),we=(e,t)=>e<<32-t|e>>>t;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function ve(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new TypeError("utf8ToBytes expected string, got "+typeof e);return(new TextEncoder).encode(e)}(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));let me=class{clone(){return this._cloneInto()}};function _e(e){const t=t=>e().update(ve(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function xe(e=32){if(ge&&"function"==typeof ge.getRandomValues)return ge.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}let Ee=class extends me{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=be(this.buffer)}update(e){ye.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=ve(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=be(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){ye.exists(this),ye.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=be(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}};const ke=(e,t,n)=>e&t^e&n^t&n,Se=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ae=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Oe=new Uint32Array(64);let Ce=class extends Ee{constructor(){super(64,32,8,!1),this.A=0|Ae[0],this.B=0|Ae[1],this.C=0|Ae[2],this.D=0|Ae[3],this.E=0|Ae[4],this.F=0|Ae[5],this.G=0|Ae[6],this.H=0|Ae[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)Oe[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Oe[e-15],n=Oe[e-2],r=we(t,7)^we(t,18)^t>>>3,o=we(n,17)^we(n,19)^n>>>10;Oe[e]=o+Oe[e-7]+r+Oe[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(we(s,6)^we(s,11)^we(s,25))+((l=s)&a^~l&c)+Se[e]+Oe[e]|0,h=(we(n,2)^we(n,13)^we(n,22))+ke(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+h|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){Oe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Pe=class extends Ce{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};const Ie=_e((()=>new Ce));_e((()=>new Pe));
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Le=BigInt(0),je=BigInt(1),Te=BigInt(2),Be=e=>e instanceof Uint8Array,Re=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function $e(e){if(!Be(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Re[e[n]];return t}function Ue(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function Ne(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function He(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("invalid byte sequence");t[n]=i}return t}function Me(e){return Ne($e(e))}function qe(e){if(!Be(e))throw new Error("Uint8Array expected");return Ne($e(Uint8Array.from(e).reverse()))}const Fe=(e,t)=>He(e.toString(16).padStart(2*t,"0")),De=(e,t)=>Fe(e,t).reverse();function ze(e,t,n){let r;if("string"==typeof t)try{r=He(t)}catch(n){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${n}`)}else{if(!Be(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function Ke(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!Be(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}function Ge(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return(new TextEncoder).encode(e)}const We=e=>(Te<<BigInt(e-1))-je,Ve=e=>new Uint8Array(e),Ye=e=>Uint8Array.from(e);function Ze(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=Ve(e),o=Ve(e),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...e)=>n(o,r,...e),c=(e=Ve())=>{o=a(Ye([0]),e),r=a(),0!==e.length&&(o=a(Ye([1]),e),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return Ke(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(u()));)c();return s(),n}}const Je={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Qe(e,t,n={}){const r=(t,n,r)=>{const o=Je[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=e[t];if(!(r&&void 0===i||o(i,e)))throw new Error(`Invalid param ${String(t)}=${i} (${typeof i}), expected ${n}`)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}var Xe=Object.freeze({__proto__:null,bitGet:(e,t)=>e>>BigInt(t)&je,bitLen:function(e){let t;for(t=0;e>Le;e>>=je,t+=1);return t},bitMask:We,bitSet:(e,t,n)=>e|(n?je:Le)<<BigInt(t),bytesToHex:$e,bytesToNumberBE:Me,bytesToNumberLE:qe,concatBytes:Ke,createHmacDrbg:Ze,ensureBytes:ze,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},hexToBytes:He,hexToNumber:Ne,numberToBytesBE:Fe,numberToBytesLE:De,numberToHexUnpadded:Ue,numberToVarBytesBE:e=>He(Ue(e)),utf8ToBytes:Ge,validateObject:Qe});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const et=BigInt(0),tt=BigInt(1),nt=BigInt(2),rt=BigInt(3),ot=BigInt(4),it=BigInt(5),st=BigInt(8);function at(e,t){const n=e%t;return n>=et?n:t+n}function ct(e,t,n){if(n<=et||t<et)throw new Error("Expected power/modulo > 0");if(n===tt)return et;let r=tt;for(;t>et;)t&tt&&(r=r*e%n),e=e*e%n,t>>=tt;return r}function ut(e,t,n){let r=e;for(;t-- >et;)r*=r,r%=n;return r}function lt(e,t){if(e===et||t<=et)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=at(e,t),r=t,o=et,i=tt;for(;n!==et;){const e=r%n,t=o-i*(r/n);r=n,n=e,o=i,i=t}if(r!==tt)throw new Error("invert: does not exist");return at(o,t)}function ht(e){if(e%ot===rt){const t=(e+tt)/ot;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%st===it){const t=(e-it)/st;return function(e,n){const r=e.mul(n,nt),o=e.pow(r,t),i=e.mul(n,o),s=e.mul(e.mul(i,nt),o),a=e.mul(i,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-tt)/nt;let n,r,o;for(n=e-tt,r=0;n%nt===et;n/=nt,r++);for(o=nt;o<e&&ct(o,t,e)!==e-tt;o++);if(1===r){const t=(e+tt)/ot;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+tt)/nt;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,o),n),u=e.pow(s,i),l=e.pow(s,n);for(;!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(l);t<a&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(c,tt<<BigInt(a-t-1));c=e.sqr(n),u=e.mul(u,n),l=e.mul(l,c),a=t}return u}}(e)}BigInt(9),BigInt(16);const ft=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dt(e){return Qe(e,ft.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function pt(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const yt=BigInt(0),gt=BigInt(1);function bt(e){return dt(e.Fp),Qe(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...pt(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const{bytesToNumberBE:wt,hexToBytes:vt}=Xe,mt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=mt;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:wt(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=mt,n="string"==typeof e?vt(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=mt._parseInt(n.subarray(2)),{d:s,l:a}=mt._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),o=t(n(e.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},_t=BigInt(0),xt=BigInt(1),Et=BigInt(2),kt=BigInt(3),St=BigInt(4);function At(e){const t=function(e){const t=bt(e);Qe(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const o=t.toAffine();return Ke(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function i(e){const{a:r,b:o}=t,i=n.sqr(e),s=n.mul(i,e);return n.add(n.add(s,n.mul(e,r)),o)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&_t<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=t;if(n&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=$e(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:Me(ze("private key",e,r))}catch(t){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof e}`)}return o&&(s=at(s,i)),a(s),s}const u=new Map;function l(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const o=e=>n.eql(e,n.ZERO);return o(t)&&o(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(o(ze("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(e);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:r,pz:o}=this,{px:i,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,o=n.mul(r,kt),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,f=n.mul(i,i),d=n.mul(s,s),p=n.mul(a,a),y=n.mul(i,s);return y=n.add(y,y),l=n.mul(i,a),l=n.add(l,l),c=n.mul(e,l),u=n.mul(o,p),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(y,c),l=n.mul(o,l),p=n.mul(e,p),y=n.sub(f,p),y=n.mul(e,y),y=n.add(y,l),l=n.add(f,f),f=n.add(l,f),f=n.add(f,p),f=n.mul(f,y),u=n.add(u,f),p=n.mul(s,a),p=n.add(p,p),f=n.mul(p,y),c=n.sub(c,f),l=n.mul(p,d),l=n.add(l,l),l=n.add(l,l),new h(c,u,l)}add(e){l(e);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=e;let u=n.ZERO,f=n.ZERO,d=n.ZERO;const p=t.a,y=n.mul(t.b,kt);let g=n.mul(r,s),b=n.mul(o,a),w=n.mul(i,c),v=n.add(r,o),m=n.add(s,a);v=n.mul(v,m),m=n.add(g,b),v=n.sub(v,m),m=n.add(r,i);let _=n.add(s,c);return m=n.mul(m,_),_=n.add(g,w),m=n.sub(m,_),_=n.add(o,i),u=n.add(a,c),_=n.mul(_,u),u=n.add(b,w),_=n.sub(_,u),d=n.mul(p,m),u=n.mul(y,w),d=n.add(u,d),u=n.sub(b,d),d=n.add(b,d),f=n.mul(u,d),b=n.add(g,g),b=n.add(b,g),w=n.mul(p,w),m=n.mul(y,m),b=n.add(b,w),w=n.sub(g,w),w=n.mul(p,w),m=n.add(m,w),g=n.mul(b,m),f=n.add(f,g),g=n.mul(_,m),u=n.mul(v,u),u=n.sub(u,g),g=n.mul(v,b),d=n.mul(_,d),d=n.add(d,g),new h(u,f,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return d.wNAFCached(this,u,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}))}multiplyUnsafe(e){const r=h.ZERO;if(e===_t)return r;if(a(e),e===xt)return this;const{endo:o}=t;if(!o)return d.unsafeLadder(this,e);let{k1neg:i,k1:s,k2neg:c,k2:u}=o.splitScalar(e),l=r,f=r,p=this;for(;s>_t||u>_t;)s&xt&&(l=l.add(p)),u&xt&&(f=f.add(p)),p=p.double(),s>>=xt,u>>=xt;return i&&(l=l.negate()),c&&(f=f.negate()),f=new h(n.mul(f.px,o.beta),f.py,f.pz),l.add(f)}multiply(e){a(e);let r,o,i=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(t),{p:f,f:p}=this.wNAF(c);u=d.constTimeNegate(e,u),f=d.constTimeNegate(a,f),f=new h(n.mul(f.px,s.beta),f.py,f.pz),r=u.add(f),o=l.add(p)}else{const{p:e,f:t}=this.wNAF(i);r=e,o=t}return h.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,o=(e,t)=>t!==_t&&t!==xt&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),i=o(this,t).add(o(e,n));return i.is0()?void 0:i}toAffine(e){const{px:t,py:r,pz:o}=this,i=this.is0();null==e&&(e=i?n.ONE:n.inv(o));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(o,e);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===xt)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===xt?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),r(h,this,e)}toHex(e=!0){return $e(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=t.nBitLength,d=function(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,o=t;for(;n>yt;)n&gt&&(r=r.add(o)),o=o.double(),n>>=gt;return r},precomputeWindow(e,t){const{windows:n,windowSize:o}=r(t),i=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,i.push(a);for(let e=1;e<o;e++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(t,o,i){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,u=e.BASE;const l=BigInt(2**t-1),h=2**t,f=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(i&l);i>>=f,r>a&&(r-=h,i+=gt);const s=t,d=t+Math.abs(r)-1,p=e%2!=0,y=r<0;0===r?u=u.add(n(p,o[s])):c=c.add(n(y,o[d]))}return{p:c,f:u}},wNAFCached(e,t,n,r){const o=e._WINDOW_SIZE||1;let i=t.get(e);return i||(i=this.precomputeWindow(e,o),1!==o&&t.set(e,r(i))),this.wNAF(o,i,n)}}}(h,t.endo?Math.ceil(f/2):f);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function Ot(e){const t=function(e){const t=bt(e);return Qe(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,o=n.BYTES+1,i=2*n.BYTES+1;function s(e){return at(e,r)}function a(e){return lt(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=At({...t,toBytes(e,t,r){const o=t.toAffine(),i=n.toBytes(o.x),s=Ke;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==o||2!==r&&3!==r){if(t===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${t} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const e=Me(s);if(!(_t<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=l(e);let o=n.sqrt(t);return 1==(1&r)!==((o&xt)===xt)&&(o=n.neg(o)),{x:e,y:o}}var a}}),f=e=>$e(Fe(e,t.nByteLength));function d(e){return e>r>>xt}const p=(e,t,n)=>Me(e.slice(t,n));class y{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=ze("compactSignature",e,2*n),new y(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=mt.toSig(ze("DER",e));return new y(t,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:o,recovery:i}=this,u=v(ze("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+t.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=0==(1&i)?"02":"03",d=c.fromHex(h+f(l)),p=a(l),y=s(-u*p),g=s(o*p),b=c.BASE.multiplyAndAddUnsafe(d,y,g);if(!b)throw new Error("point at infinify");return b.assertValidity(),b}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return He(this.toDERHex())}toDERHex(){return mt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return He(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const g={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=function(e,t,n=!1){const r=(e=ze("privateHash",e)).length,o=pt(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${r}`);return at(n?qe(e):Me(e),t-tt)+tt}(t.randomBytes(n.BYTES+8),r);return Fe(e,t.nByteLength)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function b(e){const t=e instanceof Uint8Array,n="string"==typeof e,r=(t||n)&&e.length;return t?r===o||r===i:n?r===2*o||r===2*i:e instanceof c}const w=t.bits2int||function(e){const n=Me(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},v=t.bits2int_modN||function(e){return s(w(e))},m=We(t.nBitLength);function _(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(_t<=e&&e<m))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Fe(e,t.nByteLength)}function x(e,r,o=E){if(["recovered","canonical"].some((e=>e in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=t;let{lowS:f,prehash:p,extraEntropy:g}=o;null==f&&(f=!0),e=ze("msgHash",e),p&&(e=ze("prehashed msgHash",i(e)));const b=v(e),m=u(r),x=[_(m),_(b)];if(null!=g){const e=!0===g?l(n.BYTES):g;x.push(ze("extraEntropy",e,n.BYTES))}const k=Ke(...x),S=b;return{seed:k,k2sig:function(e){const t=w(e);if(!h(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),o=s(r.x);if(o===_t)return;const i=s(n*s(S+o*m));if(i===_t)return;let u=(r.x===o?0:2)|Number(r.y&xt),l=i;return f&&d(i)&&(l=function(e){return d(e)?s(-e):e}(i),u^=1),new y(o,l,u)}}}const E={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(b(e))throw new Error("first arg must be private key");if(!b(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(n)},sign:function(e,n,r=E){const{seed:o,k2sig:i}=x(e,n,r);return Ze(t.hash.outputLen,t.nByteLength,t.hmac)(o,i)},verify:function(e,n,r,o=k){const i=e;if(n=ze("msgHash",n),r=ze("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:l}=o;let h,f;try{if("string"==typeof i||i instanceof Uint8Array)try{h=y.fromDER(i)}catch(e){if(!(e instanceof mt.Err))throw e;h=y.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:e,s:t}=i;h=new y(e,t)}}f=c.fromHex(r)}catch(e){if("PARSE"===e.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;l&&(n=t.hash(n));const{r:d,s:p}=h,g=v(n),b=a(p),w=s(g*b),m=s(d*b),_=c.BASE.multiplyAndAddUnsafe(f,w,m)?.toAffine();return!!_&&s(_.x)===d},ProjectivePoint:c,Signature:y,utils:g}}let Ct=class extends me{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ye.hash(e);const n=ve(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return ye.exists(this),this.iHash.update(e),this}digestInto(e){ye.exists(this),ye.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Pt=(e,t,n)=>new Ct(e,t).update(n).digest();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function It(e){return{hash:e,hmac:(t,...n)=>Pt(e,t,function(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const o=e[t];n.set(o,r),r+=o.length}return n}(...n)),randomBytes:xe}}Pt.create=(e,t)=>new Ct(e,t);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Lt=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),jt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Tt=BigInt(1),Bt=BigInt(2),Rt=(e,t)=>(e+t/Bt)/t;function $t(e){const t=Lt,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,l=u*u*e%t,h=ut(l,n,t)*l%t,f=ut(h,n,t)*l%t,d=ut(f,Bt,t)*u%t,p=ut(d,o,t)*d%t,y=ut(p,i,t)*p%t,g=ut(y,a,t)*y%t,b=ut(g,c,t)*g%t,w=ut(b,a,t)*y%t,v=ut(w,n,t)*l%t,m=ut(v,s,t)*p%t,_=ut(m,r,t)*u%t,x=ut(_,Bt,t);if(!Ut.eql(Ut.sqr(x),e))throw new Error("Cannot find square root");return x}const Ut=function(e,t,n=!1,r={}){if(e<=et)throw new Error(`Expected Fp ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=pt(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=ht(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:We(o),ZERO:et,ONE:tt,create:t=>at(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return et<=t&&t<e},is0:e=>e===et,isOdd:e=>(e&tt)===tt,neg:t=>at(-t,e),eql:(e,t)=>e===t,sqr:t=>at(t*t,e),add:(t,n)=>at(t+n,e),sub:(t,n)=>at(t-n,e),mul:(t,n)=>at(t*n,e),pow:(e,t)=>function(e,t,n){if(n<et)throw new Error("Expected power > 0");if(n===et)return e.ONE;if(n===tt)return t;let r=e.ONE,o=t;for(;n>et;)n&tt&&(r=e.mul(r,o)),o=e.sqr(o),n>>=tt;return r}(a,e,t),div:(t,n)=>at(t*lt(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>lt(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce(((t,r,o)=>e.is0(r)?t:(n[o]=t,e.mul(t,r))),e.ONE),o=e.inv(r);return t.reduceRight(((t,r,o)=>e.is0(r)?t:(n[o]=e.mul(t,n[o]),e.mul(t,r))),o),n}(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?De(e,i):Fe(e,i),fromBytes:e=>{if(e.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${e.length}`);return n?qe(e):Me(e)}});return Object.freeze(a)}(Lt,void 0,void 0,{sqrt:$t}),Nt=function(e,t){const n=t=>Ot({...e,...It(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:Ut,n:jt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=jt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Tt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=Rt(i*e,t),c=Rt(-r*e,t);let u=at(e-a*n-c*o,t),l=at(-a*r-c*i,t);const h=u>s,f=l>s;if(h&&(u=t-u),f&&(l=t-l),u>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:f,k2:l}}}},Ie),Ht=BigInt(0),Mt=e=>"bigint"==typeof e&&Ht<e&&e<Lt,qt=e=>"bigint"==typeof e&&Ht<e&&e<jt,Ft={};function Dt(e,...t){let n=Ft[e];if(void 0===n){const t=Ie(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=Ke(t,t),Ft[e]=n}return Ie(Ke(n,...t))}const zt=e=>e.toRawBytes(!0).slice(1),Kt=e=>Fe(e,32),Gt=e=>at(e,Lt),Wt=e=>at(e,jt),Vt=Nt.ProjectivePoint,Yt=(e,t,n)=>Vt.BASE.multiplyAndAddUnsafe(e,t,n);function Zt(e){let t=Nt.utils.normPrivateKeyToScalar(e),n=Vt.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:Wt(-t),bytes:zt(n)}}function Jt(e){if(!Mt(e))throw new Error("bad x: need 0 < x < p");const t=Gt(e*e);let n=$t(Gt(t*e+BigInt(7)));n%Bt!==Ht&&(n=Gt(-n));const r=new Vt(e,n,Tt);return r.assertValidity(),r}function Qt(...e){return Wt(Me(Dt("BIP0340/challenge",...e)))}function Xt(e,t,n){const r=ze("signature",e,64),o=ze("message",t),i=ze("publicKey",n,32);try{const e=Jt(Me(i)),t=Me(r.subarray(0,32));if(!Mt(t))return!1;const n=Me(r.subarray(32,64));if(!qt(n))return!1;const s=Qt(Kt(t),zt(e),o),a=Yt(e,n,Wt(-s));return!(!a||!a.hasEvenY()||a.toAffine().x!==t)}catch(e){return!1}}const en={getPublicKey:function(e){return Zt(e).bytes},sign:function(e,t,n=xe(32)){const r=ze("message",e),{bytes:o,scalar:i}=Zt(t),s=ze("auxRand",n,32),a=Kt(i^Me(Dt("BIP0340/aux",s))),c=Dt("BIP0340/nonce",a,o,r),u=Wt(Me(c));if(u===Ht)throw new Error("sign failed: k is zero");const{bytes:l,scalar:h}=Zt(u),f=Qt(l,o,r),d=new Uint8Array(64);if(d.set(l,0),d.set(Kt(Wt(h+f*i)),32),!Xt(d,r,o))throw new Error("sign: Invalid signature produced");return d},verify:Xt,utils:{randomPrivateKey:Nt.utils.randomPrivateKey,lift_x:Jt,pointToBytes:zt,numberToBytesBE:Fe,bytesToNumberBE:Me,taggedHash:Dt,mod:at}},tn=function(e,t){const n=t.map((e=>Array.from(e).reverse()));return(t,r)=>{const[o,i,s,a]=n.map((n=>n.reduce(((n,r)=>e.add(e.mul(n,t),r)))));return t=e.div(o,i),r=e.mul(r,e.div(s,a)),{x:t,y:r}}}(Ut,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((e=>e.map((e=>BigInt(e)))))),nn=function(e,t){if(dt(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=function(e,t){const n=e.ORDER;let r=_t;for(let e=n-xt;e%Et===_t;e/=Et)r+=xt;const o=r,i=(n-xt)/Et**o,s=(i-xt)/Et,a=Et**o-xt,c=Et**(o-xt),u=e.pow(t,i),l=e.pow(t,(i+xt)/Et);let h=(t,n)=>{let r=u,i=e.pow(n,a),h=e.sqr(i);h=e.mul(h,n);let f=e.mul(t,h);f=e.pow(f,s),f=e.mul(f,i),i=e.mul(f,n),h=e.mul(f,t);let d=e.mul(h,i);f=e.pow(d,c);let p=e.eql(f,e.ONE);i=e.mul(h,l),f=e.mul(d,r),h=e.cmov(i,h,p),d=e.cmov(f,d,p);for(let t=o;t>xt;t--){let n=Et**(t-Et),o=e.pow(d,n);const s=e.eql(o,e.ONE);i=e.mul(h,r),r=e.mul(r,r),o=e.mul(d,r),h=e.cmov(i,h,s),d=e.cmov(o,d,s)}return{isValid:p,value:h}};if(e.ORDER%St===kt){const n=(e.ORDER-kt)/St,r=e.sqrt(e.neg(t));h=(t,o)=>{let i=e.sqr(o);const s=e.mul(t,o);i=e.mul(i,s);let a=e.pow(i,n);a=e.mul(a,s);const c=e.mul(a,r),u=e.mul(e.sqr(a),o),l=e.eql(u,t);return{isValid:l,value:e.cmov(c,a,l)}}}return h}(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let o,i,s,a,c,u,l,h;o=e.sqr(r),o=e.mul(o,t.Z),i=e.sqr(o),i=e.add(i,o),s=e.add(i,e.ONE),s=e.mul(s,t.B),a=e.cmov(t.Z,e.neg(i),!e.eql(i,e.ZERO)),a=e.mul(a,t.A),i=e.sqr(s),u=e.sqr(a),c=e.mul(u,t.A),i=e.add(i,c),i=e.mul(i,s),u=e.mul(u,a),c=e.mul(u,t.B),i=e.add(i,c),l=e.mul(o,s);const{isValid:f,value:d}=n(i,u);h=e.mul(o,r),h=e.mul(h,d),l=e.cmov(l,s,f),h=e.cmov(h,d,f);const p=e.isOdd(r)===e.isOdd(h);return h=e.cmov(e.neg(h),h,p),l=e.div(l,a),{x:l,y:h}}}(Ut,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Ut.create(BigInt("-11"))});!function(e,t,n){if("function"!=typeof t)throw new Error("mapToCurve() must be defined")}(Nt.ProjectivePoint,(e=>{const{x:t,y:n}=nn(Ut.create(e[0]));return tn(t,n)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Ut.ORDER,m:1,k:128,expand:"xmd",hash:Ie});const rn="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,on=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),sn=(e,t)=>e<<32-t|e>>>t;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const an=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function cn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=an[e[n]];return t}function un(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function ln(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new TypeError("utf8ToBytes expected string, got "+typeof e);return(new TextEncoder).encode(e)}(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}let hn=class{clone(){return this._cloneInto()}};function fn(e){const t=t=>e().update(ln(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function dn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function pn(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}const yn={number:dn,bool:function(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)},bytes:pn,hash:function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");dn(e.outputLen),dn(e.blockLen)},exists:function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},output:function(e,t){pn(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}};let gn=class extends hn{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=on(this.buffer)}update(e){yn.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=ln(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=on(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){yn.exists(this),yn.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=on(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}};const bn=(e,t,n)=>e&t^e&n^t&n,wn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),vn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),mn=new Uint32Array(64);let _n=class extends gn{constructor(){super(64,32,8,!1),this.A=0|vn[0],this.B=0|vn[1],this.C=0|vn[2],this.D=0|vn[3],this.E=0|vn[4],this.F=0|vn[5],this.G=0|vn[6],this.H=0|vn[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)mn[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=mn[e-15],n=mn[e-2],r=sn(t,7)^sn(t,18)^t>>>3,o=sn(n,17)^sn(n,19)^n>>>10;mn[e]=o+mn[e-7]+r+mn[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(sn(s,6)^sn(s,11)^sn(s,25))+((l=s)&a^~l&c)+wn[e]+mn[e]|0,h=(sn(n,2)^sn(n,13)^sn(n,22))+bn(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+h|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){mn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},xn=class extends _n{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};const En=fn((()=>new _n));
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function kn(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function Sn(...e){const t=(e,t)=>n=>e(t(n));return{encode:Array.from(e).reverse().reduce(((e,n)=>e?t(e,n.encode):n.encode),void 0),decode:e.reduce(((e,n)=>e?t(e,n.decode):n.decode),void 0)}}function An(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(kn(t),t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function On(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function Cn(e,t="="){if(kn(e),"string"!=typeof t)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Pn(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function In(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const o=[],i=Array.from(e);for(i.forEach((e=>{if(kn(e),e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,s=!0;for(let o=r;o<i.length;o++){const a=i[o],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");if(e=c%n,i[o]=Math.floor(c/n),!Number.isSafeInteger(i[o])||i[o]*n+e!==c)throw new Error("convertRadix: carry overflow");s&&(i[o]?s=!1:r=o)}if(o.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)o.push(0);return o.reverse()}fn((()=>new xn));const Ln=(e,t)=>t?Ln(t,e%t):e,jn=(e,t)=>e+(t-Ln(e,t));function Tn(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(jn(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${jn(t,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const r of e){if(kn(r),r>=2**t)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(o=o<<t|r,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function Bn(e,t=!1){if(kn(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(jn(8,e)>32||jn(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Tn(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Tn(n,e,8,t))}}}function Rn(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}const $n=Sn(Bn(4),An("0123456789ABCDEF"),On("")),Un=Sn(Bn(5),An("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Cn(5),On(""));Sn(Bn(5),An("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Cn(5),On("")),Sn(Bn(5),An("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),On(""),Pn((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))));const Nn=Sn(Bn(6),An("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Cn(6),On("")),Hn=Sn(Bn(6),An("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Cn(6),On("")),Mn=e=>{return Sn((kn(t=58),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return In(Array.from(e),256,t)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(In(e,t,256))}}),An(e),On(""));var t},qn=Mn("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Mn("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Mn("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Fn=[0,2,3,5,6,7,9,10,11],Dn={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=qn.encode(r).padStart(Fn[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),o=Fn.indexOf(r.length),i=qn.decode(r);for(let e=0;e<i.length-o;e++)if(0!==i[e])throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(t)}},zn=Sn(An("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),On("")),Kn=[996825010,642813549,513874426,1027748829,705979059];function Gn(e){const t=e>>25;let n=(33554431&e)<<5;for(let e=0;e<Kn.length;e++)1==(t>>e&1)&&(n^=Kn[e]);return n}function Wn(e,t,n=1){const r=e.length;let o=1;for(let t=0;t<r;t++){const n=e.charCodeAt(t);if(n<33||n>126)throw new Error(`Invalid prefix (${e})`);o=Gn(o)^n>>5}o=Gn(o);for(let t=0;t<r;t++)o=Gn(o)^31&e.charCodeAt(t);for(let e of t)o=Gn(o)^e;for(let e=0;e<6;e++)o=Gn(o);return o^=n,zn.encode(Tn([o%2**30],30,5,!1))}function Vn(e){const t="bech32"===e?1:734539939,n=Bn(5),r=n.decode,o=n.encode,i=Rn(r);function s(e,n=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==n&&e.length>n)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${n})`);const r=e.toLowerCase();if(e!==r&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(e=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=e.slice(0,o),s=e.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=zn.decode(s).slice(0,-6),c=Wn(i,a,t);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${e}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(e,n,r=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=e.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${e=e.toLowerCase()}1${zn.encode(n)}${Wn(e,n,t)}`},decode:s,decodeToBytes:function(e){const{prefix:t,words:n}=s(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:Rn(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}const Yn=Vn("bech32");Vn("bech32m");const Zn={utf8:{encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},hex:Sn(Bn(4),An("0123456789abcdef"),On(""),Pn((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}))),base16:$n,base32:Un,base64:Nn,base64url:Hn,base58:qn,base58xmr:Dn};Object.keys(Zn).join(", ");var Jn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Qn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0});var er=Xn.wordlist=void 0;er=Xn.wordlist="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n");var tr={},nr={};function rr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function or(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)}function ir(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function sr(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");rr(e.outputLen),rr(e.blockLen)}function ar(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function cr(e,t){ir(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(nr,"__esModule",{value:!0}),nr.output=nr.exists=nr.hash=nr.bytes=nr.bool=nr.number=void 0,nr.number=rr,nr.bool=or,nr.bytes=ir,nr.hash=sr,nr.exists=ar,nr.output=cr;const ur={number:rr,bool:or,bytes:ir,hash:sr,exists:ar,output:cr};nr.default=ur;var lr={},hr={},fr={},dr={};Object.defineProperty(dr,"__esModule",{value:!0}),dr.crypto=void 0,dr.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,function(e){
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=dr,n=e=>e instanceof Uint8Array;e.u8=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);e.u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));e.createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(e.rotr=(e,t)=>e<<32-t|e>>>t,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));e.bytesToHex=function(e){if(!n(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=r[e[n]];return t},e.hexToBytes=function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let t=0;t<n.length;t++){const r=2*t,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[t]=i}return n};function o(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function i(e){if("string"==typeof e&&(e=o(e)),!n(e))throw new Error("expected Uint8Array, got "+typeof e);return e}e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let i=0;i<t;i++){r(i);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=o,e.toBytes=i,e.concatBytes=function(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let r=0;return e.forEach((e=>{if(!n(e))throw new Error("Uint8Array expected");t.set(e,r),r+=e.length})),t};e.Hash=class{clone(){return this._cloneInto()}};e.checkOpts=function(e,t){if(void 0!==t&&("object"!=typeof t||(n=t,"[object Object]"!==Object.prototype.toString.call(n)||n.constructor!==Object)))throw new Error("Options should be object or undefined");var n;return Object.assign(e,t)},e.wrapConstructor=function(e){const t=t=>e().update(i(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t},e.wrapConstructorWithOpts=function(e){const t=(t,n)=>e(n).update(i(t)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t},e.wrapXOFConstructorWithOpts=function(e){const t=(t,n)=>e(n).update(i(t)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t},e.randomBytes=function(e=32){if(t.crypto&&"function"==typeof t.crypto.getRandomValues)return t.crypto.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}}(fr),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const t=nr,n=fr;class r extends n.Hash{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,t.default.hash(e);const o=(0,n.toBytes)(r);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(o.length>i?e.create().update(o).digest():o);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return t.default.exists(this),this.iHash.update(e),this}digestInto(e){t.default.exists(this),t.default.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=r;e.hmac=(e,t,n)=>new r(e,t).update(n).digest(),e.hmac.create=(e,t)=>new r(e,t)}(hr),Object.defineProperty(lr,"__esModule",{value:!0}),lr.pbkdf2Async=lr.pbkdf2=void 0;const pr=nr,yr=hr,gr=fr;function br(e,t,n,r){pr.default.hash(e);const o=(0,gr.checkOpts)({dkLen:32,asyncTick:10},r),{c:i,dkLen:s,asyncTick:a}=o;if(pr.default.number(i),pr.default.number(s),pr.default.number(a),i<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,gr.toBytes)(t),u=(0,gr.toBytes)(n),l=new Uint8Array(s),h=yr.hmac.create(e,c),f=h._cloneInto().update(u);return{c:i,dkLen:s,asyncTick:a,DK:l,PRF:h,PRFSalt:f}}function wr(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),o.fill(0),n}lr.pbkdf2=function(e,t,n,r){const{c:o,dkLen:i,DK:s,PRF:a,PRFSalt:c}=br(e,t,n,r);let u;const l=new Uint8Array(4),h=(0,gr.createView)(l),f=new Uint8Array(a.outputLen);for(let e=1,t=0;t<i;e++,t+=a.outputLen){const n=s.subarray(t,t+a.outputLen);h.setInt32(0,e,!1),(u=c._cloneInto(u)).update(l).digestInto(f),n.set(f.subarray(0,n.length));for(let e=1;e<o;e++){a._cloneInto(u).update(f).digestInto(f);for(let e=0;e<n.length;e++)n[e]^=f[e]}}return wr(a,c,s,u,f)},lr.pbkdf2Async=async function(e,t,n,r){const{c:o,dkLen:i,asyncTick:s,DK:a,PRF:c,PRFSalt:u}=br(e,t,n,r);let l;const h=new Uint8Array(4),f=(0,gr.createView)(h),d=new Uint8Array(c.outputLen);for(let e=1,t=0;t<i;e++,t+=c.outputLen){const n=a.subarray(t,t+c.outputLen);f.setInt32(0,e,!1),(l=u._cloneInto(l)).update(h).digestInto(d),n.set(d.subarray(0,n.length)),await(0,gr.asyncLoop)(o-1,s,(e=>{c._cloneInto(l).update(d).digestInto(d);for(let e=0;e<n.length;e++)n[e]^=d[e]}))}return wr(c,u,a,l,d)};var vr={},mr={};Object.defineProperty(mr,"__esModule",{value:!0}),mr.SHA2=void 0;const _r=nr,xr=fr;mr.SHA2=class extends xr.Hash{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,xr.createView)(this.buffer)}update(e){_r.default.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=(0,xr.toBytes)(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=(0,xr.createView)(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){_r.default.exists(this),_r.default.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=(0,xr.createView)(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}},Object.defineProperty(vr,"__esModule",{value:!0}),vr.sha224=vr.sha256=void 0;const Er=mr,kr=fr,Sr=(e,t,n)=>e&t^e&n^t&n,Ar=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Or=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Cr=new Uint32Array(64);let Pr=class extends Er.SHA2{constructor(){super(64,32,8,!1),this.A=0|Or[0],this.B=0|Or[1],this.C=0|Or[2],this.D=0|Or[3],this.E=0|Or[4],this.F=0|Or[5],this.G=0|Or[6],this.H=0|Or[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)Cr[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Cr[e-15],n=Cr[e-2],r=(0,kr.rotr)(t,7)^(0,kr.rotr)(t,18)^t>>>3,o=(0,kr.rotr)(n,17)^(0,kr.rotr)(n,19)^n>>>10;Cr[e]=o+Cr[e-7]+r+Cr[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+((0,kr.rotr)(s,6)^(0,kr.rotr)(s,11)^(0,kr.rotr)(s,25))+((l=s)&a^~l&c)+Ar[e]+Cr[e]|0,h=((0,kr.rotr)(n,2)^(0,kr.rotr)(n,13)^(0,kr.rotr)(n,22))+Sr(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+h|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){Cr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Ir=class extends Pr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};vr.sha256=(0,kr.wrapConstructor)((()=>new Pr)),vr.sha224=(0,kr.wrapConstructor)((()=>new Ir));var Lr={},jr={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),n=BigInt(32);function r(e,r=!1){return r?{h:Number(e&t),l:Number(e>>n&t)}:{h:0|Number(e>>n&t),l:0|Number(e&t)}}function o(e,t=!1){let n=new Uint32Array(e.length),o=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:a}=r(e[i],t);[n[i],o[i]]=[s,a]}return[n,o]}e.fromBig=r,e.split=o;e.toBig=(e,t)=>BigInt(e>>>0)<<n|BigInt(t>>>0);function i(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:0|o}}e.add=i;const s={fromBig:r,split:o,toBig:e.toBig,shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:i,add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,add5H:(e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,add5L:(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0)};e.default=s}(jr),Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.sha384=Lr.sha512_256=Lr.sha512_224=Lr.sha512=Lr.SHA512=void 0;const Tr=mr,Br=jr,Rr=fr,[$r,Ur]=Br.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))),Nr=new Uint32Array(80),Hr=new Uint32Array(80);let Mr=class extends Tr.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:o,Cl:i,Dh:s,Dl:a,Eh:c,El:u,Fh:l,Fl:h,Gh:f,Gl:d,Hh:p,Hl:y}=this;return[e,t,n,r,o,i,s,a,c,u,l,h,f,d,p,y]}set(e,t,n,r,o,i,s,a,c,u,l,h,f,d,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|o,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let n=0;n<16;n++,t+=4)Nr[n]=e.getUint32(t),Hr[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|Nr[e-15],n=0|Hr[e-15],r=Br.default.rotrSH(t,n,1)^Br.default.rotrSH(t,n,8)^Br.default.shrSH(t,n,7),o=Br.default.rotrSL(t,n,1)^Br.default.rotrSL(t,n,8)^Br.default.shrSL(t,n,7),i=0|Nr[e-2],s=0|Hr[e-2],a=Br.default.rotrSH(i,s,19)^Br.default.rotrBH(i,s,61)^Br.default.shrSH(i,s,6),c=Br.default.rotrSL(i,s,19)^Br.default.rotrBL(i,s,61)^Br.default.shrSL(i,s,6),u=Br.default.add4L(o,c,Hr[e-7],Hr[e-16]),l=Br.default.add4H(u,r,a,Nr[e-7],Nr[e-16]);Nr[e]=0|l,Hr[e]=0|u}let{Ah:n,Al:r,Bh:o,Bl:i,Ch:s,Cl:a,Dh:c,Dl:u,Eh:l,El:h,Fh:f,Fl:d,Gh:p,Gl:y,Hh:g,Hl:b}=this;for(let e=0;e<80;e++){const t=Br.default.rotrSH(l,h,14)^Br.default.rotrSH(l,h,18)^Br.default.rotrBH(l,h,41),w=Br.default.rotrSL(l,h,14)^Br.default.rotrSL(l,h,18)^Br.default.rotrBL(l,h,41),v=l&f^~l&p,m=h&d^~h&y,_=Br.default.add5L(b,w,m,Ur[e],Hr[e]),x=Br.default.add5H(_,g,t,v,$r[e],Nr[e]),E=0|_,k=Br.default.rotrSH(n,r,28)^Br.default.rotrBH(n,r,34)^Br.default.rotrBH(n,r,39),S=Br.default.rotrSL(n,r,28)^Br.default.rotrBL(n,r,34)^Br.default.rotrBL(n,r,39),A=n&o^n&s^o&s,O=r&i^r&a^i&a;g=0|p,b=0|y,p=0|f,y=0|d,f=0|l,d=0|h,({h:l,l:h}=Br.default.add(0|c,0|u,0|x,0|E)),c=0|s,u=0|a,s=0|o,a=0|i,o=0|n,i=0|r;const C=Br.default.add3L(E,S,O);n=Br.default.add3H(C,x,k,A),r=0|C}({h:n,l:r}=Br.default.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:i}=Br.default.add(0|this.Bh,0|this.Bl,0|o,0|i)),({h:s,l:a}=Br.default.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=Br.default.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:h}=Br.default.add(0|this.Eh,0|this.El,0|l,0|h)),({h:f,l:d}=Br.default.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:y}=Br.default.add(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:b}=Br.default.add(0|this.Hh,0|this.Hl,0|g,0|b)),this.set(n,r,o,i,s,a,c,u,l,h,f,d,p,y,g,b)}roundClean(){Nr.fill(0),Hr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Lr.SHA512=Mr;let qr=class extends Mr{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},Fr=class extends Mr{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Dr=class extends Mr{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};Lr.sha512=(0,Rr.wrapConstructor)((()=>new Mr)),Lr.sha512_224=(0,Rr.wrapConstructor)((()=>new qr)),Lr.sha512_256=(0,Rr.wrapConstructor)((()=>new Fr)),Lr.sha384=(0,Rr.wrapConstructor)((()=>new Dr));var zr={};!function(e){function t(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function n(...e){const t=(e,t)=>n=>e(t(n));return{encode:Array.from(e).reverse().reduce(((e,n)=>e?t(e,n.encode):n.encode),void 0),decode:e.reduce(((e,n)=>e?t(e,n.decode):n.decode),void 0)}}function r(e){return{encode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("alphabet.encode input should be an array of numbers");return n.map((n=>{if(t(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function o(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function i(e,n="="){if(t(e),"string"!=typeof n)throw new Error("padding chr should be string");return{encode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;t.length*e%8;)t.push(n);return t},decode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=t.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&t[r-1]===n;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return t.slice(0,r)}}}function s(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function a(e,n,r){if(n<2)throw new Error(`convertRadix: wrong from=${n}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let o=0;const i=[],s=Array.from(e);for(s.forEach((e=>{if(t(e),e<0||e>=n)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,t=!0;for(let i=o;i<s.length;i++){const a=s[i],c=n*e+a;if(!Number.isSafeInteger(c)||n*e/n!==e||c-a!=n*e)throw new Error("convertRadix: carry overflow");if(e=c%r,s[i]=Math.floor(c/r),!Number.isSafeInteger(s[i])||s[i]*r+e!==c)throw new Error("convertRadix: carry overflow");t&&(s[i]?t=!1:o=i)}if(i.push(e),t)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0,e.assertNumber=t;const c=(e,t)=>t?c(t,e%t):e,u=(e,t)=>e+(t-c(e,t));function l(e,n,r,o){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(n<=0||n>32)throw new Error(`convertRadix2: wrong from=${n}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(u(n,r)>32)throw new Error(`convertRadix2: carry overflow from=${n} to=${r} carryBits=${u(n,r)}`);let i=0,s=0;const a=2**r-1,c=[];for(const o of e){if(t(o),o>=2**n)throw new Error(`convertRadix2: invalid data word=${o} from=${n}`);if(i=i<<n|o,s+n>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${n}`);for(s+=n;s>=r;s-=r)c.push((i>>s-r&a)>>>0);i&=2**s-1}if(i=i<<r-s&a,!o&&s>=n)throw new Error("Excess padding");if(!o&&i)throw new Error(`Non-zero padding: ${i}`);return o&&s>0&&c.push(i>>>0),c}function h(e){return t(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a(t,e,256))}}}function f(e,n=!1){if(t(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,e)>32||u(e,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return l(Array.from(t),8,e,!n)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(l(t,e,8,n))}}}function d(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}function p(e,n){if(t(e),"function"!=typeof n)throw new Error("checksum fn should be function");return{encode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=n(t).slice(0,e),o=new Uint8Array(t.length+e);return o.set(t),o.set(r,t.length),o},decode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=t.slice(0,-e),o=n(r).slice(0,e),i=t.slice(-e);for(let t=0;t<e;t++)if(o[t]!==i[t])throw new Error("Invalid checksum");return r}}}e.utils={alphabet:r,chain:n,checksum:p,radix:h,radix2:f,join:o,padding:i},e.base16=n(f(4),r("0123456789ABCDEF"),o("")),e.base32=n(f(5),r("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),i(5),o("")),e.base32hex=n(f(5),r("0123456789ABCDEFGHIJKLMNOPQRSTUV"),i(5),o("")),e.base32crockford=n(f(5),r("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),s((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),e.base64=n(f(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),i(6),o("")),e.base64url=n(f(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),i(6),o(""));const y=e=>n(h(58),r(e),o(""));e.base58=y("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=y("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=y("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const g=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(t){let n="";for(let r=0;r<t.length;r+=8){const o=t.subarray(r,r+8);n+=e.base58.encode(o).padStart(g[o.length],"1")}return n},decode(t){let n=[];for(let r=0;r<t.length;r+=11){const o=t.slice(r,r+11),i=g.indexOf(o.length),s=e.base58.decode(o);for(let e=0;e<s.length-i;e++)if(0!==s[e])throw new Error("base58xmr: wrong padding");n=n.concat(Array.from(s.slice(s.length-i)))}return Uint8Array.from(n)}};e.base58check=t=>n(p(4,(e=>t(t(e)))),e.base58);const b=n(r("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),w=[996825010,642813549,513874426,1027748829,705979059];function v(e){const t=e>>25;let n=(33554431&e)<<5;for(let e=0;e<w.length;e++)1==(t>>e&1)&&(n^=w[e]);return n}function m(e,t,n=1){const r=e.length;let o=1;for(let t=0;t<r;t++){const n=e.charCodeAt(t);if(n<33||n>126)throw new Error(`Invalid prefix (${e})`);o=v(o)^n>>5}o=v(o);for(let t=0;t<r;t++)o=v(o)^31&e.charCodeAt(t);for(let e of t)o=v(o)^e;for(let e=0;e<6;e++)o=v(o);return o^=n,b.encode(l([o%2**30],30,5,!1))}function _(e){const t="bech32"===e?1:734539939,n=f(5),r=n.decode,o=n.encode,i=d(r);function s(e,n=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==n&&e.length>n)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${n})`);const r=e.toLowerCase();if(e!==r&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(e=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=e.slice(0,o),s=e.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=b.decode(s).slice(0,-6),c=m(i,a,t);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${e}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(e,n,r=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=e.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${e=e.toLowerCase()}1${b.encode(n)}${m(e,n,t)}`},decode:s,decodeToBytes:function(e){const{prefix:t,words:n}=s(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:d(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}e.bech32=_("bech32"),e.bech32m=_("bech32m"),e.utf8={encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},e.hex=n(f(4),r("0123456789abcdef"),o(""),s((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})));const x={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},E=`Invalid encoding type. Available types: ${Object.keys(x).join(", ")}`;e.bytesToString=(e,t)=>{if("string"!=typeof e||!x.hasOwnProperty(e))throw new TypeError(E);if(!(t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return x[e].encode(t)},e.str=e.bytesToString;e.stringToBytes=(e,t)=>{if(!x.hasOwnProperty(e))throw new TypeError(E);if("string"!=typeof t)throw new TypeError("stringToBytes() expects string");return x[e].decode(t)},e.bytes=e.stringToBytes}(zr),Object.defineProperty(tr,"__esModule",{value:!0});var Kr=tr.mnemonicToSeedSync=tr.mnemonicToSeed=ao=tr.validateMnemonic=tr.entropyToMnemonic=tr.mnemonicToEntropy=no=tr.generateMnemonic=void 0;
/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const Gr=nr,Wr=lr,Vr=vr,Yr=Lr,Zr=fr,Jr=zr,Qr=e=>""===e[0];function Xr(e){if("string"!=typeof e)throw new TypeError("Invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function eo(e){const t=Xr(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function to(e){Gr.default.bytes(e,16,20,24,28,32)}var no=tr.generateMnemonic=function(e,t=128){if(Gr.default.number(t),t%32!=0||t>256)throw new TypeError("Invalid entropy");return so((0,Zr.randomBytes)(t/8),e)};const ro=e=>{const t=8-e.length/4;return new Uint8Array([(0,Vr.sha256)(e)[0]>>t<<t])};function oo(e){if(!Array.isArray(e)||2048!==e.length||"string"!=typeof e[0])throw new Error("Worlist: expected array of 2048 strings");return e.forEach((e=>{if("string"!=typeof e)throw new Error(`Wordlist: non-string element: ${e}`)})),Jr.utils.chain(Jr.utils.checksum(1,ro),Jr.utils.radix2(11,!0),Jr.utils.alphabet(e))}function io(e,t){const{words:n}=eo(e),r=oo(t).decode(n);return to(r),r}function so(e,t){to(e);return oo(t).encode(e).join(Qr(t)?"":" ")}tr.mnemonicToEntropy=io,tr.entropyToMnemonic=so;var ao=tr.validateMnemonic=function(e,t){try{io(e,t)}catch(e){return!1}return!0};const co=e=>Xr(`mnemonic${e}`);function uo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function lo(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}tr.mnemonicToSeed=function(e,t=""){return(0,Wr.pbkdf2Async)(Yr.sha512,eo(e).nfkd,co(t),{c:2048,dkLen:64})},Kr=tr.mnemonicToSeedSync=function(e,t=""){return(0,Wr.pbkdf2)(Yr.sha512,eo(e).nfkd,co(t),{c:2048,dkLen:64})};const ho={number:uo,bool:function(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)},bytes:lo,hash:function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");uo(e.outputLen),uo(e.blockLen)},exists:function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},output:function(e,t){lo(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}},fo=e=>e instanceof Uint8Array,po=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),yo=(e,t)=>e<<32-t|e>>>t;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const go=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bo(e){if(!fo(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=go[e[n]];return t}function wo(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function vo(e){if("string"==typeof e&&(e=wo(e)),!fo(e))throw new Error("expected Uint8Array, got "+typeof e);return e}function mo(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!fo(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}class _o{clone(){return this._cloneInto()}}function xo(e){const t=t=>e().update(vo(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class Eo extends _o{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ho.hash(e);const n=vo(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return ho.exists(this),this.iHash.update(e),this}digestInto(e){ho.exists(this),ho.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ko=(e,t,n)=>new Eo(e,t).update(n).digest();ko.create=(e,t)=>new Eo(e,t);class So extends _o{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=po(this.buffer)}update(e){ho.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=vo(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=po(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){ho.exists(this),ho.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=po(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}}const Ao=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Oo=Uint8Array.from({length:16},((e,t)=>t)),Co=Oo.map((e=>(9*e+5)%16));let Po=[Oo],Io=[Co];for(let e=0;e<4;e++)for(let t of[Po,Io])t.push(t[e].map((e=>Ao[e])));const Lo=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((e=>new Uint8Array(e))),jo=Po.map(((e,t)=>e.map((e=>Lo[t][e])))),To=Io.map(((e,t)=>e.map((e=>Lo[t][e])))),Bo=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Ro=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),$o=(e,t)=>e<<t|e>>>32-t;function Uo(e,t,n,r){return 0===e?t^n^r:1===e?t&n|~t&r:2===e?(t|~n)^r:3===e?t&r|n&~r:t^(n|~r)}const No=new Uint32Array(16);class Ho extends So{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:n,h3:r,h4:o}=this;return[e,t,n,r,o]}set(e,t,n,r,o){this.h0=0|e,this.h1=0|t,this.h2=0|n,this.h3=0|r,this.h4=0|o}process(e,t){for(let n=0;n<16;n++,t+=4)No[n]=e.getUint32(t,!0);let n=0|this.h0,r=n,o=0|this.h1,i=o,s=0|this.h2,a=s,c=0|this.h3,u=c,l=0|this.h4,h=l;for(let e=0;e<5;e++){const t=4-e,f=Bo[e],d=Ro[e],p=Po[e],y=Io[e],g=jo[e],b=To[e];for(let t=0;t<16;t++){const r=$o(n+Uo(e,o,s,c)+No[p[t]]+f,g[t])+l|0;n=l,l=c,c=0|$o(s,10),s=o,o=r}for(let e=0;e<16;e++){const n=$o(r+Uo(t,i,a,u)+No[y[e]]+d,b[e])+h|0;r=h,h=u,u=0|$o(a,10),a=i,i=n}}this.set(this.h1+s+u|0,this.h2+c+h|0,this.h3+l+r|0,this.h4+n+i|0,this.h0+o+a|0)}roundClean(){No.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const Mo=xo((()=>new Ho)),qo=(e,t,n)=>e&t^e&n^t&n,Fo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Do=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),zo=new Uint32Array(64);class Ko extends So{constructor(){super(64,32,8,!1),this.A=0|Do[0],this.B=0|Do[1],this.C=0|Do[2],this.D=0|Do[3],this.E=0|Do[4],this.F=0|Do[5],this.G=0|Do[6],this.H=0|Do[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)zo[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=zo[e-15],n=zo[e-2],r=yo(t,7)^yo(t,18)^t>>>3,o=yo(n,17)^yo(n,19)^n>>>10;zo[e]=o+zo[e-7]+r+zo[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(yo(s,6)^yo(s,11)^yo(s,25))+((l=s)&a^~l&c)+Fo[e]+zo[e]|0,h=(yo(n,2)^yo(n,13)^yo(n,22))+qo(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+h|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){zo.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Go extends Ko{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Wo=xo((()=>new Ko));xo((()=>new Go));const Vo=BigInt(2**32-1),Yo=BigInt(32);function Zo(e,t=!1){return t?{h:Number(e&Vo),l:Number(e>>Yo&Vo)}:{h:0|Number(e>>Yo&Vo),l:0|Number(e&Vo)}}const Jo={fromBig:Zo,split:function(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){const{h:i,l:s}=Zo(e[o],t);[n[o],r[o]]=[i,s]}return[n,r]},toBig:(e,t)=>BigInt(e>>>0)<<Yo|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:function(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:0|o}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,add5H:(e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,add5L:(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0)},[Qo,Xo]=Jo.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))),ei=new Uint32Array(80),ti=new Uint32Array(80);class ni extends So{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:o,Cl:i,Dh:s,Dl:a,Eh:c,El:u,Fh:l,Fl:h,Gh:f,Gl:d,Hh:p,Hl:y}=this;return[e,t,n,r,o,i,s,a,c,u,l,h,f,d,p,y]}set(e,t,n,r,o,i,s,a,c,u,l,h,f,d,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|o,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let n=0;n<16;n++,t+=4)ei[n]=e.getUint32(t),ti[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|ei[e-15],n=0|ti[e-15],r=Jo.rotrSH(t,n,1)^Jo.rotrSH(t,n,8)^Jo.shrSH(t,n,7),o=Jo.rotrSL(t,n,1)^Jo.rotrSL(t,n,8)^Jo.shrSL(t,n,7),i=0|ei[e-2],s=0|ti[e-2],a=Jo.rotrSH(i,s,19)^Jo.rotrBH(i,s,61)^Jo.shrSH(i,s,6),c=Jo.rotrSL(i,s,19)^Jo.rotrBL(i,s,61)^Jo.shrSL(i,s,6),u=Jo.add4L(o,c,ti[e-7],ti[e-16]),l=Jo.add4H(u,r,a,ei[e-7],ei[e-16]);ei[e]=0|l,ti[e]=0|u}let{Ah:n,Al:r,Bh:o,Bl:i,Ch:s,Cl:a,Dh:c,Dl:u,Eh:l,El:h,Fh:f,Fl:d,Gh:p,Gl:y,Hh:g,Hl:b}=this;for(let e=0;e<80;e++){const t=Jo.rotrSH(l,h,14)^Jo.rotrSH(l,h,18)^Jo.rotrBH(l,h,41),w=Jo.rotrSL(l,h,14)^Jo.rotrSL(l,h,18)^Jo.rotrBL(l,h,41),v=l&f^~l&p,m=h&d^~h&y,_=Jo.add5L(b,w,m,Xo[e],ti[e]),x=Jo.add5H(_,g,t,v,Qo[e],ei[e]),E=0|_,k=Jo.rotrSH(n,r,28)^Jo.rotrBH(n,r,34)^Jo.rotrBH(n,r,39),S=Jo.rotrSL(n,r,28)^Jo.rotrBL(n,r,34)^Jo.rotrBL(n,r,39),A=n&o^n&s^o&s,O=r&i^r&a^i&a;g=0|p,b=0|y,p=0|f,y=0|d,f=0|l,d=0|h,({h:l,l:h}=Jo.add(0|c,0|u,0|x,0|E)),c=0|s,u=0|a,s=0|o,a=0|i,o=0|n,i=0|r;const C=Jo.add3L(E,S,O);n=Jo.add3H(C,x,k,A),r=0|C}({h:n,l:r}=Jo.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:i}=Jo.add(0|this.Bh,0|this.Bl,0|o,0|i)),({h:s,l:a}=Jo.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=Jo.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:h}=Jo.add(0|this.Eh,0|this.El,0|l,0|h)),({h:f,l:d}=Jo.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:y}=Jo.add(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:b}=Jo.add(0|this.Hh,0|this.Hl,0|g,0|b)),this.set(n,r,o,i,s,a,c,u,l,h,f,d,p,y,g,b)}roundClean(){ei.fill(0),ti.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ri extends ni{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class oi extends ni{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class ii extends ni{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const si=xo((()=>new ni));xo((()=>new ri)),xo((()=>new oi)),xo((()=>new ii));const ai=Nt.ProjectivePoint,ci=(e=>Sn(function(e,t){if(kn(e),"function"!=typeof t)throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),o=t(r).slice(0,e),i=n.slice(-e);for(let t=0;t<e;t++)if(o[t]!==i[t])throw new Error("Invalid checksum");return r}}}(4,(t=>e(e(t)))),qn))(Wo);function ui(e){return BigInt(`0x${bo(e)}`)}function li(e){return function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let t=0;t<n.length;t++){const r=2*t,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[t]=i}return n}(e.toString(16).padStart(64,"0"))}const hi=wo("Bitcoin seed"),fi={private:76066276,public:76067358},di=2147483648,pi=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error(`Invalid number=${e}. Should be from 0 to 2 ** 32 - 1`);const t=new Uint8Array(4);return po(t).setUint32(0,e,!1),t};class yi{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return e=this.pubHash,po(e).getUint32(0,!1);var e}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const e=this.privateKey;if(!e)throw new Error("No private key");return ci.encode(this.serialize(this.versions.private,mo(new Uint8Array([0]),e)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return ci.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(e,t=fi){if(lo(e),8*e.length<128||8*e.length>512)throw new Error(`HDKey: wrong seed length=${e.length}. Should be between 128 and 512 bits; 256 bits is advised)`);const n=ko(si,hi,e);return new yi({versions:t,chainCode:n.slice(32),privateKey:n.slice(0,32)})}static fromExtendedKey(e,t=fi){const n=ci.decode(e),r=po(n),o=r.getUint32(0,!1),i={versions:t,depth:n[4],parentFingerprint:r.getUint32(5,!1),index:r.getUint32(9,!1),chainCode:n.slice(13,45)},s=n.slice(45),a=0===s[0];if(o!==t[a?"private":"public"])throw new Error("Version mismatch");return new yi(a?{...i,privateKey:s.slice(1)}:{...i,publicKey:s})}static fromJSON(e){return yi.fromExtendedKey(e.xpriv)}constructor(e){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!e||"object"!=typeof e)throw new Error("HDKey.constructor must not be called directly");if(this.versions=e.versions||fi,this.depth=e.depth||0,this.chainCode=e.chainCode,this.index=e.index||0,this.parentFingerprint=e.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(e.publicKey&&e.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(e.privateKey){if(!Nt.utils.isValidPrivateKey(e.privateKey))throw new Error("Invalid private key");this.privKey="bigint"==typeof e.privateKey?e.privateKey:ui(e.privateKey),this.privKeyBytes=li(this.privKey),this.pubKey=Nt.getPublicKey(e.privateKey,!0)}else{if(!e.publicKey)throw new Error("HDKey: no public or private key provided");this.pubKey=ai.fromHex(e.publicKey).toRawBytes(!0)}var t;this.pubHash=(t=this.pubKey,Mo(Wo(t)))}derive(e){if(!/^[mM]'?/.test(e))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(e))return this;const t=e.replace(/^[mM]'?\//,"").split("/");let n=this;for(const e of t){const t=/^(\d+)('?)$/.exec(e);if(!t||3!==t.length)throw new Error(`Invalid child index: ${e}`);let r=+t[1];if(!Number.isSafeInteger(r)||r>=di)throw new Error("Invalid index");"'"===t[2]&&(r+=di),n=n.deriveChild(r)}return n}deriveChild(e){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let t=pi(e);if(e>=di){const e=this.privateKey;if(!e)throw new Error("Could not derive hardened child key");t=mo(new Uint8Array([0]),e,t)}else t=mo(this.pubKey,t);const n=ko(si,this.chainCode,t),r=ui(n.slice(0,32)),o=n.slice(32);if(!Nt.utils.isValidPrivateKey(r))throw new Error("Tweak bigger than curve order");const i={versions:this.versions,chainCode:o,depth:this.depth+1,parentFingerprint:this.fingerprint,index:e};try{if(this.privateKey){const e=at(this.privKey+r,Nt.CURVE.n);if(!Nt.utils.isValidPrivateKey(e))throw new Error("The tweak was out of range or the resulted private key is invalid");i.privateKey=e}else{const e=ai.fromHex(this.pubKey).add(ai.fromPrivateKey(r));if(e.equals(ai.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");i.publicKey=e.toRawBytes(!0)}return new yi(i)}catch(t){return this.deriveChild(e+1)}}sign(e){if(!this.privateKey)throw new Error("No privateKey set!");return lo(e,32),Nt.sign(e,this.privKey).toCompactRawBytes()}verify(e,t){if(lo(e,32),lo(t,64),!this.publicKey)throw new Error("No publicKey set!");let n;try{n=Nt.Signature.fromCompact(t)}catch(e){return!1}return Nt.verify(n,e,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(e,t){if(!this.chainCode)throw new Error("No chainCode set");return lo(t,33),mo(pi(e),new Uint8Array([this.depth]),pi(this.parentFingerprint),pi(this.index),this.chainCode,t)}}var gi=Object.defineProperty,bi=(e,t)=>{for(var n in t)gi(e,n,{get:t[n],enumerable:!0})};function wi(){return cn(en.utils.randomPrivateKey())}function vi(e){return cn(en.getPublicKey(e))}bi({},{MessageNode:()=>Si,MessageQueue:()=>Ai,insertEventIntoAscendingList:()=>ki,insertEventIntoDescendingList:()=>Ei,normalizeURL:()=>xi,utf8Decoder:()=>mi,utf8Encoder:()=>_i});var mi=new TextDecoder("utf-8"),_i=new TextEncoder;function xi(e){let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),("80"===t.port&&"ws:"===t.protocol||"443"===t.port&&"wss:"===t.protocol)&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}function Ei(e,t){let n,r=0,o=e.length-1,i=r;if(o<0)i=0;else if(t.created_at<e[o].created_at)i=o+1;else if(t.created_at>=e[r].created_at)i=r;else for(;;){if(o<=r+1){i=o;break}if(n=Math.floor(r+(o-r)/2),e[n].created_at>t.created_at)r=n;else{if(!(e[n].created_at<t.created_at)){i=n;break}o=n}}return e[i]?.id!==t.id?[...e.slice(0,i),t,...e.slice(i)]:e}function ki(e,t){let n,r=0,o=e.length-1,i=r;if(o<0)i=0;else if(t.created_at>e[o].created_at)i=o+1;else if(t.created_at<=e[r].created_at)i=r;else for(;;){if(o<=r+1){i=o;break}if(n=Math.floor(r+(o-r)/2),e[n].created_at<t.created_at)r=n;else{if(!(e[n].created_at>t.created_at)){i=n;break}o=n}}return e[i]?.id!==t.id?[...e.slice(0,i),t,...e.slice(i)]:e}var Si=class{_value;_next;get value(){return this._value}set value(e){this._value=e}get next(){return this._next}set next(e){this._next=e}constructor(e){this._value=e,this._next=null}},Ai=class{_first;_last;get first(){return this._first}set first(e){this._first=e}get last(){return this._last}set last(e){this._last=e}_size;get size(){return this._size}set size(e){this._size=e}constructor(){this._first=null,this._last=null,this._size=0}enqueue(e){const t=new Si(e);return 0!==this._size&&this._last?(this._last.next=t,this._last=t):(this._first=t,this._last=t),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let e=this._first;return this._first=e.next,e.next=null,this._size--,e.value}};function Oi(e,t){let n=e;return n.pubkey=vi(t),n.id=Ci(n),n.sig=Ti(n,t),n}function Ci(e){return cn(En(_i.encode(function(e){if(!Ii(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}(e))))}var Pi=e=>e instanceof Object;function Ii(e){if(!Pi(e))return!1;if("number"!=typeof e.kind)return!1;if("string"!=typeof e.content)return!1;if("number"!=typeof e.created_at)return!1;if("string"!=typeof e.pubkey)return!1;if(!e.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let e=0;e<n.length;e++)if("object"==typeof n[e])return!1}return!0}function Li(e){try{return en.verify(e.sig,Ci(e),e.pubkey)}catch(e){return!1}}function ji(e,t){return console.warn("nostr-tools: `signEvent` is deprecated and will be removed or changed in the future. Please use `getSignature` instead."),Ti(e,t)}function Ti(e,t){return cn(en.sign(Ci(e),t))}function Bi(e,t){if(e.ids&&-1===e.ids.indexOf(t.id)&&!e.ids.some((e=>t.id.startsWith(e))))return!1;if(e.kinds&&-1===e.kinds.indexOf(t.kind))return!1;if(e.authors&&-1===e.authors.indexOf(t.pubkey)&&!e.authors.some((e=>t.pubkey.startsWith(e))))return!1;for(let n in e)if("#"===n[0]){let r=e[`#${n.slice(1)}`];if(r&&!t.tags.find((([e,t])=>e===n.slice(1)&&-1!==r.indexOf(t))))return!1}return!(e.since&&t.created_at<e.since)&&!(e.until&&t.created_at>=e.until)}function Ri(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function $i(e,t){let n=t.length,r=e.indexOf(`"${t}":`)+n+3,o=e.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function Ui(e){let t=e.slice(0,22).indexOf('"EVENT"');if(-1===t)return null;let n=e.slice(t+7+1).indexOf('"');if(-1===n)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return e.slice(r+1,i)}function Ni(e,t){return t===Ri(e,"id")}function Hi(e,t){return t===Ri(e,"pubkey")}function Mi(e,t){return t===$i(e,"kind")}bi({},{getHex64:()=>Ri,getInt:()=>$i,getSubscriptionId:()=>Ui,matchEventId:()=>Ni,matchEventKind:()=>Mi,matchEventPubkey:()=>Hi});var qi=()=>({connect:[],disconnect:[],error:[],notice:[],auth:[]});function Fi(e,t={}){let{listTimeout:n=3e3,getTimeout:r=3e3,countTimeout:o=3e3}=t;var i,s,a={},c=qi(),u={},l={};async function h(){return s||(s=new Promise(((t,n)=>{try{i=new WebSocket(e)}catch(e){n(e)}i.onopen=()=>{c.connect.forEach((e=>e())),t()},i.onerror=()=>{s=void 0,c.error.forEach((e=>e())),n()},i.onclose=async()=>{s=void 0,c.disconnect.forEach((e=>e()))};let r,o=new Ai;function h(){if(0===o.size)return clearInterval(r),void(r=null);var t=o.dequeue();if(!t)return;let n=Ui(t);if(n){let r=a[n];if(r&&r.alreadyHaveEvent&&r.alreadyHaveEvent(Ri(t,"id"),e))return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":{let t=e[1],n=e[2];return void(Ii(n)&&a[t]&&(a[t].skipVerification||Li(n))&&function(e,t){for(let n=0;n<e.length;n++)if(Bi(e[n],t))return!0;return!1}(a[t].filters,n)&&(a[t],(u[t]?.event||[]).forEach((e=>e(n)))))}case"COUNT":let t=e[1],n=e[2];return void(a[t]&&(u[t]?.count||[]).forEach((e=>e(n))));case"EOSE":{let t=e[1];return void(t in u&&(u[t].eose.forEach((e=>e())),u[t].eose=[]))}case"OK":{let t=e[1],n=e[2],r=e[3]||"";return void(t in l&&(n?l[t].ok.forEach((e=>e())):l[t].failed.forEach((e=>e(r))),l[t].ok=[],l[t].failed=[]))}case"NOTICE":let r=e[1];return void c.notice.forEach((e=>e(r)));case"AUTH":{let t=e[1];return void c.auth?.forEach((e=>e(t)))}}}catch(e){return}}i.onmessage=e=>{o.enqueue(e.data),r||(r=setInterval(h,0))}})),s)}function f(){return 1===i?.readyState}async function d(e){let t=JSON.stringify(e);if(f()||(await new Promise((e=>setTimeout(e,1e3))),f()))try{i.send(t)}catch(e){console.log(e)}}const p=(e,{verb:t="REQ",skipVerification:n=!1,alreadyHaveEvent:r=null,id:o=Math.random().toString().slice(2)}={})=>{let i=o;return a[i]={id:i,filters:e,skipVerification:n,alreadyHaveEvent:r},d([t,i,...e]),{sub:(t,o={})=>p(t||e,{skipVerification:o.skipVerification||n,alreadyHaveEvent:o.alreadyHaveEvent||r,id:i}),unsub:()=>{delete a[i],delete u[i],d(["CLOSE",i])},on:(e,t)=>{u[i]=u[i]||{event:[],count:[],eose:[]},u[i][e].push(t)},off:(e,t)=>{let n=u[i],r=n[e].indexOf(t);r>=0&&n[e].splice(r,1)}}};function y(e,t){if(!e.id)throw new Error(`event ${e} has no id`);let n=e.id;return d([t,e]),{on:(e,t)=>{l[n]=l[n]||{ok:[],failed:[]},l[n][e].push(t)},off:(e,t)=>{let r=l[n];if(!r)return;let o=r[e].indexOf(t);o>=0&&r[e].splice(o,1)}}}return{url:e,sub:p,on:(e,t)=>{c[e].push(t),"connect"===e&&1===i?.readyState&&t()},off:(e,t)=>{let n=c[e].indexOf(t);-1!==n&&c[e].splice(n,1)},list:(e,t)=>new Promise((r=>{let o=p(e,t),i=[],s=setTimeout((()=>{o.unsub(),r(i)}),n);o.on("eose",(()=>{o.unsub(),clearTimeout(s),r(i)})),o.on("event",(e=>{i.push(e)}))})),get:(e,t)=>new Promise((n=>{let o=p([e],t),i=setTimeout((()=>{o.unsub(),n(null)}),r);o.on("event",(e=>{o.unsub(),clearTimeout(i),n(e)}))})),count:e=>new Promise((t=>{let n=p(e,{...p,verb:"COUNT"}),r=setTimeout((()=>{n.unsub(),t(null)}),o);n.on("count",(e=>{n.unsub(),clearTimeout(r),t(e)}))})),publish:e=>y(e,"EVENT"),auth:e=>y(e,"AUTH"),connect:async function(){f()||await h()},close(){c=qi(),u={},l={},i.readyState===WebSocket.OPEN&&i?.close()},get status(){return i?.readyState??3}}}var Di={};bi(Di,{BECH32_REGEX:()=>Ki,decode:()=>Gi,naddrEncode:()=>es,neventEncode:()=>Xi,noteEncode:()=>Zi,nprofileEncode:()=>Qi,npubEncode:()=>Yi,nrelayEncode:()=>ts,nsecEncode:()=>Vi});var zi=5e3,Ki=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Gi(e){let{prefix:t,words:n}=Yn.decode(e,zi),r=new Uint8Array(Yn.fromWords(n));switch(t){case"nprofile":{let e=Wi(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:cn(e[0][0]),relays:e[1]?e[1].map((e=>mi.decode(e))):[]}}}case"nevent":{let e=Wi(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(e[2]&&32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");return{type:"nevent",data:{id:cn(e[0][0]),relays:e[1]?e[1].map((e=>mi.decode(e))):[],author:e[2]?.[0]?cn(e[2][0]):void 0}}}case"naddr":{let e=Wi(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!e[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!e[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:mi.decode(e[0][0]),pubkey:cn(e[2][0]),kind:parseInt(cn(e[3][0]),16),relays:e[1]?e[1].map((e=>mi.decode(e))):[]}}}case"nrelay":{let e=Wi(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:mi.decode(e[0][0])}}case"nsec":case"npub":case"note":return{type:t,data:cn(r)};default:throw new Error(`unknown prefix ${t}`)}}function Wi(e){let t={},n=e;for(;n.length>0;){let e=n[0],r=n[1];if(!r)throw new Error(`malformed TLV ${e}`);let o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${e}`);t[e]=t[e]||[],t[e].push(o)}return t}function Vi(e){return Ji("nsec",e)}function Yi(e){return Ji("npub",e)}function Zi(e){return Ji("note",e)}function Ji(e,t){let n=un(t),r=Yn.toWords(n);return Yn.encode(e,r,zi)}function Qi(e){let t=ns({0:[un(e.pubkey)],1:(e.relays||[]).map((e=>_i.encode(e)))}),n=Yn.toWords(t);return Yn.encode("nprofile",n,zi)}function Xi(e){let t=ns({0:[un(e.id)],1:(e.relays||[]).map((e=>_i.encode(e))),2:e.author?[un(e.author)]:[]}),n=Yn.toWords(t);return Yn.encode("nevent",n,zi)}function es(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=ns({0:[_i.encode(e.identifier)],1:(e.relays||[]).map((e=>_i.encode(e))),2:[un(e.pubkey)],3:[new Uint8Array(t)]}),r=Yn.toWords(n);return Yn.encode("naddr",r,zi)}function ts(e){let t=ns({0:[_i.encode(e)]}),n=Yn.toWords(t);return Yn.encode("nrelay",n,zi)}function ns(e){let t=[];return Object.entries(e).forEach((([e,n])=>{n.forEach((n=>{let r=new Uint8Array(n.length+2);r.set([parseInt(e)],0),r.set([n.length],1),r.set(n,2),t.push(r)}))})),function(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const o=e[t];n.set(o,r),r+=o.length}return n}(...t)}var rs={};async function os(e,t,n){const r=ss(Nt.getSharedSecret(e,"02"+t));let o=Uint8Array.from(function(e=32){if(rn&&"function"==typeof rn.getRandomValues)return rn.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(16)),i=_i.encode(n),s=await crypto.subtle.importKey("raw",r,{name:"AES-CBC"},!1,["encrypt"]),a=await crypto.subtle.encrypt({name:"AES-CBC",iv:o},s,i);return`${Nn.encode(new Uint8Array(a))}?iv=${Nn.encode(new Uint8Array(o.buffer))}`}async function is(e,t,n){let[r,o]=n.split("?iv="),i=ss(Nt.getSharedSecret(e,"02"+t)),s=await crypto.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["decrypt"]),a=Nn.decode(r),c=Nn.decode(o),u=await crypto.subtle.decrypt({name:"AES-CBC",iv:c},s,a);return mi.decode(u)}function ss(e){return e.slice(1,33)}bi(rs,{decrypt:()=>is,encrypt:()=>os}),"undefined"!=typeof crypto&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle);var as={};bi(as,{NIP05_REGEX:()=>us,queryProfile:()=>fs,searchDomain:()=>hs,useFetchImplementation:()=>ls});var cs,us=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{cs=fetch}catch{}function ls(e){cs=e}async function hs(e,t=""){try{return(await(await cs(`https://${e}/.well-known/nostr.json?name=${t}`)).json()).names}catch(e){return{}}}async function fs(e){const t=e.match(us);if(!t)return null;const[n,r="_",o]=t;try{const e=await cs(`https://${o}/.well-known/nostr.json?name=${r}`),{names:t,relays:n}=function(e){const t={names:{}};for(const[n,r]of Object.entries(e.names))"string"==typeof n&&"string"==typeof r&&(t.names[n]=r);if(e.relays){t.relays={};for(const[n,r]of Object.entries(e.relays))"string"==typeof n&&Array.isArray(r)&&(t.relays[n]=r.filter((e=>"string"==typeof e)))}return t}(await e.json()),i=t[r];return i?{pubkey:i,relays:n?.[i]}:null}catch(e){return null}}function ds(e,t){let n=yi.fromMasterSeed(Kr(e,t)).derive("m/44'/1237'/0'/0/0").privateKey;if(!n)throw new Error("could not derive private key");return cn(n)}function ps(){return no(er)}function ys(e){return ao(e,er)}bi({},{generateSeedWords:()=>ps,privateKeyFromSeedWords:()=>ds,validateWords:()=>ys});function gs(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[]},n=[];for(const r of e.tags)"e"===r[0]&&r[1]&&n.push(r),"p"===r[0]&&r[1]&&t.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let e=0;e<n.length;e++){const r=n[e],[o,i,s,a]=r,c={id:i,relays:s?[s]:[]},u=0===e,l=e===n.length-1;"root"!==a?"reply"!==a?"mention"!==a?u?t.root=c:l?t.reply=c:t.mentions.push(c):t.mentions.push(c):t.reply=c:t.root=c}return t}bi({},{parse:()=>gs});function bs(e){return function(e){let t,n,r;for(n=0,t=0;n<e.length&&(r=ws(e[n]),t+=r,8===r);n++);return t}(un(e))}function ws(e){let t=0;if(0===e)return 8;for(;e>>=1;)t++;return 7-t}bi({},{getPow:()=>bs});function vs(e,t,n,r){return Oi({kind:6,tags:[...e.tags??[],["e",t.id,n],["p",t.pubkey]],content:""===e.content?"":JSON.stringify(t),created_at:e.created_at},r)}function ms(e){if(6!==e.kind)return;let t,n;for(let r=e.tags.length-1;r>=0&&(void 0===t||void 0===n);r--){const o=e.tags[r];o.length>=2&&("e"===o[0]&&void 0===t?t=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==t?{id:t[1],relays:[t[2],n?.[2]].filter((e=>"string"==typeof e)),author:n?.[1]}:void 0}function _s(e,{skipVerification:t}={}){const n=ms(e);if(void 0===n||""===e.content)return;let r;try{r=JSON.parse(e.content)}catch(e){return}return r.id===n.id&&(t||Li(r))?r:void 0}bi({},{finishRepostEvent:()=>vs,getRepostedEvent:()=>_s,getRepostedEventPointer:()=>ms});bi({},{NOSTR_URI_REGEX:()=>xs,parse:()=>ks,test:()=>Es});var xs=new RegExp(`nostr:(${Ki.source})`);function Es(e){return"string"==typeof e&&new RegExp(`^${xs.source}$`).test(e)}function ks(e){const t=e.match(new RegExp(`^${xs.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:Gi(t[1])}}function Ss(e,t,n){const r=t.tags.filter((e=>e.length>=2&&("e"===e[0]||"p"===e[0])));return Oi({...e,kind:7,tags:[...e.tags??[],...r,["e",t.id],["p",t.pubkey]],content:e.content??"+"},n)}function As(e){if(7!==e.kind)return;let t,n;for(let r=e.tags.length-1;r>=0&&(void 0===t||void 0===n);r--){const o=e.tags[r];o.length>=2&&("e"===o[0]&&void 0===t?t=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==t&&void 0!==n?{id:t[1],relays:[t[2],n[2]].filter((e=>void 0!==e)),author:n[1]}:void 0}bi({},{finishReactionEvent:()=>Ss,getReactedEventPointer:()=>As});function Os(e,t){let n=[];(t.kind||-1)>=0&&n.push(`kind=${t.kind}`),t.until&&n.push(`created_at<${t.until}`),t.since&&n.push(`created_at>${t.since}`);let r=n.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let o=En(_i.encode(`nostr:delegation:${t.pubkey}:${r}`)),i=cn(en.sign(o,e));return{from:vi(e),to:t.pubkey,cond:r,sig:i}}function Cs(e){let t=e.tags.find((e=>"delegation"===e[0]&&e.length>=4));if(!t)return null;let n=t[1],r=t[2],o=t[3],i=r.split("&");for(let t=0;t<i.length;t++){let[n,r,o]=i[t].split(/\b/);if(("kind"!==n||"="!==r||e.kind!==parseInt(o))&&!("created_at"===n&&"<"===r&&e.created_at<parseInt(o)||"created_at"===n&&">"===r&&e.created_at>parseInt(o)))return null}let s=En(_i.encode(`nostr:delegation:${e.pubkey}:${r}`));return en.verify(o,s,n)?n:null}bi({},{createDelegation:()=>Os,getDelegator:()=>Cs});bi({},{matchAll:()=>Is,regex:()=>Ps,replaceAll:()=>Ls});var Ps=()=>new RegExp(`\\b${xs.source}\\b`,"g");function*Is(e){const t=e.matchAll(Ps());for(const e of t)try{const[t,n]=e;yield{uri:t,value:n,decoded:Gi(n),start:e.index,end:e.index+t.length}}catch(e){}}function Ls(e,t){return e.replaceAll(Ps(),((e,n)=>t({uri:e,value:n,decoded:Gi(n)})))}var js;bi({},{useFetchImplementation:()=>Ts,validateGithub:()=>Bs});try{js=fetch}catch{}function Ts(e){js=e}async function Bs(e,t,n){try{return await(await js(`https://gist.github.com/${t}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch(e){return!1}}bi({},{authenticate:()=>Ns});var Rs,$s,Us,Ns=async({challenge:e,relay:t,sign:n})=>{const r={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t.url],["challenge",e]],content:""},o=t.auth(await n(r));return new Promise(((e,t)=>{o.on("ok",(function t(){o.off("ok",t),e()})),o.on("failed",(function e(n){o.off("failed",e),t(n)}))}))},Hs={};bi(Hs,{getZapEndpoint:()=>qs,makeZapReceipt:()=>zs,makeZapRequest:()=>Fs,useFetchImplementation:()=>Ms,validateZapRequest:()=>Ds});try{Rs=fetch}catch{}function Ms(e){Rs=e}async function qs(e){try{let t="",{lud06:n,lud16:r}=JSON.parse(e.content);if(n){let{words:e}=Yn.decode(n,1e3),r=Yn.fromWords(e);t=mi.decode(r)}else{if(!r)return null;{let[e,n]=r.split("@");t=`https://${n}/.well-known/lnurlp/${e}`}}let o=await Rs(t),i=await o.json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch(e){}return null}function Fs({profile:e,event:t,amount:n,relays:r,comment:o=""}){if(!n)throw new Error("amount not given");if(!e)throw new Error("profile not given");let i={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e],["amount",n.toString()],["relays",...r]]};return t&&i.tags.push(["e",t]),i}function Ds(e){let t;try{t=JSON.parse(e)}catch(e){return"Invalid zap request JSON."}if(!Ii(t))return"Zap request is not a valid Nostr event.";if(!Li(t))return"Invalid signature on zap request.";let n=t.tags.find((([e,t])=>"p"===e&&t));if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=t.tags.find((([e,t])=>"e"===e&&t));return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find((([e,t])=>"relays"===e&&t))?null:"Zap request doesn't have a 'relays' tag."}function zs({zapRequest:e,preimage:t,bolt11:n,paidAt:r}){let o=JSON.parse(e).tags.filter((([e])=>"e"===e||"p"===e||"a"===e)),i={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...o,["bolt11",n],["description",e]]};return t&&i.tags.push(["preimage",t]),i}const Ks="undefined"!=typeof WebSocket?WebSocket:Us?$s:(Us=1,$s=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")});function Gs(e,t={}){if(!(this instanceof Gs))return new Gs(e,t);this.url=e,this.opts=t,null==t.reconnect&&(t.reconnect=!0);const n=this;return n.onfn={},Ws(n).catch((e=>{n.onfn.error&&n.onfn.error(e)})),this}function Ws(e){return new Promise(((t,n)=>{const r=e.ws=new Ks(e.url);let o=!1;r.onmessage=t=>{!function(e,t){let n;try{n=JSON.parse(t.data)}catch(e){return void console.error("handle_nostr_message",e)}if(n.length>=2)switch(n[0]){case"EVENT":if(n.length<3)return;return e.onfn.event&&e.onfn.event(n[1],n[2]);case"EOSE":return e.onfn.eose&&e.onfn.eose(n[1]);case"NOTICE":return e.onfn.notice&&e.onfn.notice(...n.slice(1));case"OK":e.onfn.ok&&e.onfn.ok(...n.slice(1))}}(e,t),e.onfn.message&&e.onfn.message(t)},r.onclose=t=>{if(e.onfn.close&&e.onfn.close(t),e.reconnecting)return n(new Error("close during reconnect"));!e.manualClose&&e.opts.reconnect&&Ys(e)},r.onerror=t=>{if(e.onfn.error&&e.onfn.error(t),e.reconnecting)return n(new Error("error during reconnect"));e.opts.reconnect&&Ys(e)},r.onopen=n=>{e.onfn.open&&e.onfn.open(n),o||(o=!0,t(e))}}))}function Vs(e){return new Promise((t=>setTimeout(t,e)))}async function Ys(e){let t=100;try{e.reconnecting=!0,await Ws(e),e.reconnecting=!1}catch{await Vs(t),t*=1.5}}Gs.prototype.wait_connected=async function(e){let t=1e3;for(;;){if(1===this.ws.readyState)return;await Vs(t),t*=1.5}},Gs.prototype.on=function(e,t){return this.onfn[e]=t,this},Gs.prototype.close=function(){this.ws&&(this.manualClose=!0,this.ws.close())},Gs.prototype.subscribe=function(e,t){Array.isArray(t)?this.send(["REQ",e,...t]):this.send(["REQ",e,t])},Gs.prototype.unsubscribe=function(e){this.send(["CLOSE",e])},Gs.prototype.send=async function(e){await this.wait_connected(),this.ws.send(JSON.stringify(e))};const Zs=Gs;function Js(e,t){if(!(this instanceof Js))return new Js(e,t);this.onfn={},this.relays=[],this.opts=t;for(const t of e)this.add(t);return this}Js.prototype.close=function(){for(const e of this.relays)e.close()},Js.prototype.on=function(e,t){for(const n of this.relays)this.onfn[e]=t,n.onfn[e]=t.bind(null,n);return this},Js.prototype.has=function(e){for(const t of this.relays)if(t.url===e)return!0;return!1},Js.prototype.send=function(e,t){const n=t?this.find_relays(t):this.relays;for(const t of n)t.send(e)},Js.prototype.setupHandlers=function(){const e=Object.keys(this.onfn);for(const t of e)for(const e of this.relays)e.onfn[t]=this.onfn[t].bind(null,e)},Js.prototype.remove=function(e){let t=0;for(const n of this.relays){if(n.url===e)return n.ws&&n.ws.close(),this.relays=this.replays.splice(t,1),!0;t+=1}return!1},Js.prototype.subscribe=function(e,t,n){const r=n?this.find_relays(n):this.relays;for(const n of r)n.subscribe(e,t)},Js.prototype.unsubscribe=function(e,t){const n=t?this.find_relays(t):this.relays;for(const t of n)t.unsubscribe(e)},Js.prototype.add=function(e){if(e instanceof Zs)return!this.has(e.url)&&(this.relays.push(e),this.setupHandlers(),!0);if(this.has(e))return!1;const t=Zs(e,this.opts);return this.relays.push(t),this.setupHandlers(),!0},Js.prototype.find_relays=function(e){if(e instanceof Zs)return[e];if(0===e.length)return[];if(!e[0])throw new Error("what!?");return e[0]instanceof Zs?e:this.relays.reduce(((t,n)=>(e.some((e=>n.url===e))&&t.push(n),t)),[])};var Qs=Qn(Js);function Xs(){}function ea(){ea.init.call(this)}function ta(e){return void 0===e._maxListeners?ea.defaultMaxListeners:e._maxListeners}function na(e,t,n,r){var o,i,s,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]):(i=e._events=new Xs,e._eventsCount=0),s){if("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(o=ta(e))&&o>0&&s.length>o){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,"function"==typeof console.warn?console.warn(a):console.log(a)}}else s=i[t]=n,++e._eventsCount;return e}function ra(e,t,n){var r=!1;function o(){e.removeListener(t,o),r||(r=!0,n.apply(e,arguments))}return o.listener=n,o}function oa(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function ia(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}let sa;Xs.prototype=Object.create(null),ea.EventEmitter=ea,ea.usingDomains=!1,ea.prototype.domain=void 0,ea.prototype._events=void 0,ea.prototype._maxListeners=void 0,ea.defaultMaxListeners=10,ea.init=function(){this.domain=null,ea.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Xs,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ea.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},ea.prototype.getMaxListeners=function(){return ta(this)},ea.prototype.emit=function(e){var t,n,r,o,i,s,a,c="error"===e;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(a=this.domain,c){if(t=arguments[1],!a){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,o=ia(e,r),i=0;i<r;++i)o[i].call(n)}(n,l,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,i=ia(e,o),s=0;s<o;++s)i[s].call(n,r)}(n,l,this,arguments[1]);break;case 3:!function(e,t,n,r,o){if(t)e.call(n,r,o);else for(var i=e.length,s=ia(e,i),a=0;a<i;++a)s[a].call(n,r,o)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,o,i){if(t)e.call(n,r,o,i);else for(var s=e.length,a=ia(e,s),c=0;c<s;++c)a[c].call(n,r,o,i)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];!function(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,i=ia(e,o),s=0;s<o;++s)i[s].apply(n,r)}(n,l,this,o)}return!0},ea.prototype.addListener=function(e,t){return na(this,e,t,!1)},ea.prototype.on=ea.prototype.addListener,ea.prototype.prependListener=function(e,t){return na(this,e,t,!0)},ea.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,ra(this,e,t)),this},ea.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,ra(this,e,t)),this},ea.prototype.removeListener=function(e,t){var n,r,o,i,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Xs:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Xs,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,o=e.length;r<o;n+=1,r+=1)e[n]=e[r];e.pop()}(n,o);r.removeListener&&this.emit("removeListener",e,s||t)}return this},ea.prototype.off=function(e,t){return this.removeListener(e,t)},ea.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Xs,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Xs:delete n[e]),this;if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Xs,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},ea.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},ea.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):oa.call(e,t)},ea.prototype.listenerCount=oa,ea.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};const aa=new Uint8Array(16);function ca(){if(!sa&&(sa="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!sa))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return sa(aa)}const ua=[];for(let e=0;e<256;++e)ua.push((e+256).toString(16).slice(1));var la={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function ha(e,t,n){if(la.randomUUID&&!t&&!e)return la.randomUUID();const r=(e=e||{}).random||(e.rng||ca)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(ua[e[t+0]]+ua[e[t+1]]+ua[e[t+2]]+ua[e[t+3]]+"-"+ua[e[t+4]]+ua[e[t+5]]+"-"+ua[e[t+6]]+ua[e[t+7]]+"-"+ua[e[t+8]]+ua[e[t+9]]+"-"+ua[e[t+10]]+ua[e[t+11]]+ua[e[t+12]]+ua[e[t+13]]+ua[e[t+14]]+ua[e[t+15]]).toLowerCase()}(r)}function fa(){throw new Error("setTimeout has not been defined")}function da(){throw new Error("clearTimeout has not been defined")}var pa=fa,ya=da;function ga(e){if(pa===setTimeout)return setTimeout(e,0);if((pa===fa||!pa)&&setTimeout)return pa=setTimeout,setTimeout(e,0);try{return pa(e,0)}catch(t){try{return pa.call(null,e,0)}catch(t){return pa.call(this,e,0)}}}"function"==typeof g.setTimeout&&(pa=setTimeout),"function"==typeof g.clearTimeout&&(ya=clearTimeout);var ba,wa=[],va=!1,ma=-1;function _a(){va&&ba&&(va=!1,ba.length?wa=ba.concat(wa):ma=-1,wa.length&&xa())}function xa(){if(!va){var e=ga(_a);va=!0;for(var t=wa.length;t;){for(ba=wa,wa=[];++ma<t;)ba&&ba[ma].run();ma=-1,t=wa.length}ba=null,va=!1,function(e){if(ya===clearTimeout)return clearTimeout(e);if((ya===da||!ya)&&clearTimeout)return ya=clearTimeout,clearTimeout(e);try{return ya(e)}catch(t){try{return ya.call(null,e)}catch(t){return ya.call(this,e)}}}(e)}}function Ea(e,t){this.fun=e,this.array=t}Ea.prototype.run=function(){this.fun.apply(null,this.array)};function ka(){}var Sa=ka,Aa=ka,Oa=ka,Ca=ka,Pa=ka,Ia=ka,La=ka;var ja=g.performance||{},Ta=ja.now||ja.mozNow||ja.msNow||ja.oNow||ja.webkitNow||function(){return(new Date).getTime()};var Ba=new Date;var Ra,$a,Ua={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];wa.push(new Ea(e,t)),1!==wa.length||va||ga(xa)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Sa,addListener:Aa,once:Oa,off:Ca,removeListener:Pa,removeAllListeners:Ia,emit:La,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*Ta.call(ja),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ba)/1e3}},Na={exports:{}};function Ha(){if($a)return Ra;$a=1;var e=1e3,t=60*e,n=60*t,r=24*n,o=7*r,i=365.25*r;function s(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}return Ra=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===u&&isFinite(a))return c.long?function(o){var i=Math.abs(o);if(i>=r)return s(o,i,r,"day");if(i>=n)return s(o,i,n,"hour");if(i>=t)return s(o,i,t,"minute");if(i>=e)return s(o,i,e,"second");return o+" ms"}(a):function(o){var i=Math.abs(o);if(i>=r)return Math.round(o/r)+"d";if(i>=n)return Math.round(o/n)+"h";if(i>=t)return Math.round(o/t)+"m";if(i>=e)return Math.round(o/e)+"s";return o+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}var Ma=function(e){function t(e){let r,o,i,s=null;function a(...e){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Ha(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t};!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==Ua&&"env"in Ua&&(e=Ua.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Ma(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Na,Na.exports);var qa=Qn(Na.exports),Fa={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,s),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,o);break;default:if(!c)for(f=1,c=new Array(h-1);f<h;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||o&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(Fa);var Da=Qn(Fa.exports),za={};Object.defineProperty(za,"__esModule",{value:!0}),za.is_node=void 0;var Ka=null;za.is_node=function(){return null===Ka&&(Ka="object"==typeof Jn&&"object"==typeof Jn.process&&"object"==typeof Jn.process.versions&&void 0!==Jn.process.versions.node),Ka};var Ga=[],Wa=[],Va="undefined"!=typeof Uint8Array?Uint8Array:Array,Ya=!1;function Za(){Ya=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)Ga[t]=e[t],Wa[e.charCodeAt(t)]=t;Wa["-".charCodeAt(0)]=62,Wa["_".charCodeAt(0)]=63}function Ja(e,t,n){for(var r,o,i=[],s=t;s<n;s+=3)r=(e[s]<<16)+(e[s+1]<<8)+e[s+2],i.push(Ga[(o=r)>>18&63]+Ga[o>>12&63]+Ga[o>>6&63]+Ga[63&o]);return i.join("")}function Qa(e){var t;Ya||Za();for(var n=e.length,r=n%3,o="",i=[],s=16383,a=0,c=n-r;a<c;a+=s)i.push(Ja(e,a,a+s>c?c:a+s));return 1===r?(t=e[n-1],o+=Ga[t>>2],o+=Ga[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=Ga[t>>10],o+=Ga[t>>4&63],o+=Ga[t<<2&63],o+="="),i.push(o),i.join("")}function Xa(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?o-1:0,f=n?-1:1,d=e[t+h];for(h+=f,i=d&(1<<-l)-1,d>>=-l,l+=a;l>0;i=256*i+e[t+h],h+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),i-=u}return(d?-1:1)*s*Math.pow(2,i-r)}function ec(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,h=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,p=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,o),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;e[n+d]=255&a,d+=p,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+d]=255&s,d+=p,s/=256,u-=8);e[n+d-p]|=128*y}var tc={}.toString,nc=Array.isArray||function(e){return"[object Array]"==tc.call(e)};function rc(){return ic.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function oc(e,t){if(rc()<t)throw new RangeError("Invalid typed array length");return ic.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=ic.prototype:(null===e&&(e=new ic(t)),e.length=t),e}function ic(e,t,n){if(!(ic.TYPED_ARRAY_SUPPORT||this instanceof ic))return new ic(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return cc(this,e)}return sc(this,e,t,n)}function sc(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);ic.TYPED_ARRAY_SUPPORT?(e=t).__proto__=ic.prototype:e=uc(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!ic.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|fc(t,n);e=oc(e,r);var o=e.write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(hc(t)){var n=0|lc(t.length);return 0===(e=oc(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?oc(e,0):uc(e,t);if("Buffer"===t.type&&nc(t.data))return uc(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function ac(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function cc(e,t){if(ac(t),e=oc(e,t<0?0:0|lc(t)),!ic.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function uc(e,t){var n=t.length<0?0:0|lc(t.length);e=oc(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function lc(e){if(e>=rc())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+rc().toString(16)+" bytes");return 0|e}function hc(e){return!(null==e||!e._isBuffer)}function fc(e,t){if(hc(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Hc(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Mc(e).length;default:if(r)return Hc(e).length;t=(""+t).toLowerCase(),r=!0}}function dc(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Cc(this,t,n);case"utf8":case"utf-8":return kc(this,t,n);case"ascii":return Ac(this,t,n);case"latin1":case"binary":return Oc(this,t,n);case"base64":return Ec(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pc(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function pc(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function yc(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=ic.from(t,r)),hc(t))return 0===t.length?-1:gc(e,t,n,r,o);if("number"==typeof t)return t&=255,ic.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):gc(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function gc(e,t,n,r,o){var i,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var h=!0,f=0;f<c;f++)if(u(e,i+f)!==u(t,f)){h=!1;break}if(h)return i}return-1}function bc(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function wc(e,t,n,r){return qc(Hc(t,e.length-n),e,n,r)}function vc(e,t,n,r){return qc(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function mc(e,t,n,r){return vc(e,t,n,r)}function _c(e,t,n,r){return qc(Mc(t),e,n,r)}function xc(e,t,n,r){return qc(function(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function Ec(e,t,n){return 0===t&&n===e.length?Qa(e):Qa(e.slice(t,n))}function kc(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],l=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=n)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=h}return function(e){var t=e.length;if(t<=Sc)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Sc));return n}(r)}ic.TYPED_ARRAY_SUPPORT=void 0===g.TYPED_ARRAY_SUPPORT||g.TYPED_ARRAY_SUPPORT,rc(),ic.poolSize=8192,ic._augment=function(e){return e.__proto__=ic.prototype,e},ic.from=function(e,t,n){return sc(null,e,t,n)},ic.TYPED_ARRAY_SUPPORT&&(ic.prototype.__proto__=Uint8Array.prototype,ic.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&ic[Symbol.species]),ic.alloc=function(e,t,n){return function(e,t,n,r){return ac(t),t<=0?oc(e,t):void 0!==n?"string"==typeof r?oc(e,t).fill(n,r):oc(e,t).fill(n):oc(e,t)}(null,e,t,n)},ic.allocUnsafe=function(e){return cc(null,e)},ic.allocUnsafeSlow=function(e){return cc(null,e)},ic.isBuffer=function(e){return null!=e&&(!!e._isBuffer||Fc(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&Fc(e.slice(0,0))}(e))},ic.compare=function(e,t){if(!hc(e)||!hc(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},ic.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ic.concat=function(e,t){if(!nc(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return ic.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=ic.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!hc(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},ic.byteLength=fc,ic.prototype._isBuffer=!0,ic.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)pc(this,t,t+1);return this},ic.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)pc(this,t,t+3),pc(this,t+1,t+2);return this},ic.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)pc(this,t,t+7),pc(this,t+1,t+6),pc(this,t+2,t+5),pc(this,t+3,t+4);return this},ic.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?kc(this,0,e):dc.apply(this,arguments)},ic.prototype.equals=function(e){if(!hc(e))throw new TypeError("Argument must be a Buffer");return this===e||0===ic.compare(this,e)},ic.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},ic.prototype.compare=function(e,t,n,r,o){if(!hc(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),c=this.slice(r,o),u=e.slice(t,n),l=0;l<a;++l)if(c[l]!==u[l]){i=c[l],s=u[l];break}return i<s?-1:s<i?1:0},ic.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},ic.prototype.indexOf=function(e,t,n){return yc(this,e,t,n,!0)},ic.prototype.lastIndexOf=function(e,t,n){return yc(this,e,t,n,!1)},ic.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return bc(this,e,t,n);case"utf8":case"utf-8":return wc(this,e,t,n);case"ascii":return vc(this,e,t,n);case"latin1":case"binary":return mc(this,e,t,n);case"base64":return _c(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xc(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},ic.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Sc=4096;function Ac(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function Oc(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function Cc(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=Nc(e[i]);return o}function Pc(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function Ic(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Lc(e,t,n,r,o,i){if(!hc(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function jc(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function Tc(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function Bc(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Rc(e,t,n,r,o){return o||Bc(e,0,n,4),ec(e,t,n,r,23,4),n+4}function $c(e,t,n,r,o){return o||Bc(e,0,n,8),ec(e,t,n,r,52,8),n+8}ic.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),ic.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=ic.prototype;else{var o=t-e;n=new ic(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},ic.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||Ic(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},ic.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||Ic(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},ic.prototype.readUInt8=function(e,t){return t||Ic(e,1,this.length),this[e]},ic.prototype.readUInt16LE=function(e,t){return t||Ic(e,2,this.length),this[e]|this[e+1]<<8},ic.prototype.readUInt16BE=function(e,t){return t||Ic(e,2,this.length),this[e]<<8|this[e+1]},ic.prototype.readUInt32LE=function(e,t){return t||Ic(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},ic.prototype.readUInt32BE=function(e,t){return t||Ic(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},ic.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||Ic(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},ic.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||Ic(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},ic.prototype.readInt8=function(e,t){return t||Ic(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},ic.prototype.readInt16LE=function(e,t){t||Ic(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},ic.prototype.readInt16BE=function(e,t){t||Ic(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},ic.prototype.readInt32LE=function(e,t){return t||Ic(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},ic.prototype.readInt32BE=function(e,t){return t||Ic(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},ic.prototype.readFloatLE=function(e,t){return t||Ic(e,4,this.length),Xa(this,e,!0,23,4)},ic.prototype.readFloatBE=function(e,t){return t||Ic(e,4,this.length),Xa(this,e,!1,23,4)},ic.prototype.readDoubleLE=function(e,t){return t||Ic(e,8,this.length),Xa(this,e,!0,52,8)},ic.prototype.readDoubleBE=function(e,t){return t||Ic(e,8,this.length),Xa(this,e,!1,52,8)},ic.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||Lc(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},ic.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||Lc(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},ic.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,1,255,0),ic.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},ic.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,2,65535,0),ic.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):jc(this,e,t,!0),t+2},ic.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,2,65535,0),ic.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):jc(this,e,t,!1),t+2},ic.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,4,4294967295,0),ic.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Tc(this,e,t,!0),t+4},ic.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,4,4294967295,0),ic.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Tc(this,e,t,!1),t+4},ic.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);Lc(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},ic.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);Lc(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},ic.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,1,127,-128),ic.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},ic.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,2,32767,-32768),ic.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):jc(this,e,t,!0),t+2},ic.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,2,32767,-32768),ic.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):jc(this,e,t,!1),t+2},ic.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,4,2147483647,-2147483648),ic.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Tc(this,e,t,!0),t+4},ic.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Lc(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),ic.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Tc(this,e,t,!1),t+4},ic.prototype.writeFloatLE=function(e,t,n){return Rc(this,e,t,!0,n)},ic.prototype.writeFloatBE=function(e,t,n){return Rc(this,e,t,!1,n)},ic.prototype.writeDoubleLE=function(e,t,n){return $c(this,e,t,!0,n)},ic.prototype.writeDoubleBE=function(e,t,n){return $c(this,e,t,!1,n)},ic.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!ic.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},ic.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!ic.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=hc(e)?e:Hc(new ic(e,r).toString()),a=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var Uc=/[^+\/0-9A-Za-z-_]/g;function Nc(e){return e<16?"0"+e.toString(16):e.toString(16)}function Hc(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Mc(e){return function(e){var t,n,r,o,i,s;Ya||Za();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[a-2]?2:"="===e[a-1]?1:0,s=new Va(3*a/4-i),r=i>0?a-4:a;var c=0;for(t=0,n=0;t<r;t+=4,n+=3)o=Wa[e.charCodeAt(t)]<<18|Wa[e.charCodeAt(t+1)]<<12|Wa[e.charCodeAt(t+2)]<<6|Wa[e.charCodeAt(t+3)],s[c++]=o>>16&255,s[c++]=o>>8&255,s[c++]=255&o;return 2===i?(o=Wa[e.charCodeAt(t)]<<2|Wa[e.charCodeAt(t+1)]>>4,s[c++]=255&o):1===i&&(o=Wa[e.charCodeAt(t)]<<10|Wa[e.charCodeAt(t+1)]<<4|Wa[e.charCodeAt(t+2)]>>2,s[c++]=o>>8&255,s[c++]=255&o),s}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Uc,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function qc(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function Fc(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var Dc,zc,Kc={};var Gc,Wc,Vc,Yc,Zc={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",contributors:["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],version:"1.0.34",repository:{type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=4.0.0"},dependencies:{bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},devDependencies:{"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},config:{verbose:!1},scripts:{test:"tape test/unit/*.js",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",license:"Apache-2.0"};function Jc(){if(Yc)return Vc;var e;if(Yc=1,"object"==typeof globalThis)e=globalThis;else try{e=function(){if(zc)return Dc;zc=1;var e=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};return Dc=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}()}()}catch(e){}finally{if(e||"undefined"==typeof window||(e=window),!e)throw new Error("Could not determine global this")}var t=e.WebSocket||e.MozWebSocket,n=Wc?Gc:(Wc=1,Gc=Zc.version);function r(e,n){return n?new t(e,n):new t(e)}return t&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(r,e,{get:function(){return t[e]}})})),Vc={w3cwebsocket:t?r:null,version:n}}var Qc,Xc,eu={},tu={},nu={},ru={},ou={},iu={};function su(){if(Xc)return ou;Xc=1;var e=Jn&&Jn.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ou,"__esModule",{value:!0}),ou.Container=void 0;var t=function(){if(Qc)return iu;Qc=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.ForOfAdaptor=void 0;var e=function(){function e(e,t){this.it_=e,this.last_=t}return e.prototype.next=function(){if(this.it_.equals(this.last_))return{done:!0,value:void 0};var e=this.it_;return this.it_=this.it_.next(),{done:!1,value:e.value}},e.prototype[Symbol.iterator]=function(){return this},e}();return iu.ForOfAdaptor=e,iu}(),n=function(){function n(){}return n.prototype.empty=function(){return 0===this.size()},n.prototype.rbegin=function(){return this.end().reverse()},n.prototype.rend=function(){return this.begin().reverse()},n.prototype[Symbol.iterator]=function(){return new t.ForOfAdaptor(this.begin(),this.end())},n.prototype.toJSON=function(){var t,n,r=[];try{for(var o=e(this),i=o.next();!i.done;i=o.next()){var s=i.value;r.push(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},n}();return ou.Container=n,ou}var au,cu,uu={};function lu(){if(au)return uu;au=1;var e=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(uu,"__esModule",{value:!0}),uu.NativeArrayIterator=void 0;var t=function(){function t(e,t){this.data_=e,this.index_=t}return t.prototype.index=function(){return this.index_},Object.defineProperty(t.prototype,"value",{get:function(){return this.data_[this.index_]},enumerable:!1,configurable:!0}),t.prototype.prev=function(){return--this.index_,this},t.prototype.next=function(){return++this.index_,this},t.prototype.advance=function(e){return this.index_+=e,this},t.prototype.equals=function(e){return this.data_===e.data_&&this.index_===e.index_},t.prototype.swap=function(t){var n,r;n=e([t.data_,this.data_],2),this.data_=n[0],t.data_=n[1],r=e([t.index_,this.index_],2),this.index_=r[0],t.index_=r[1]},t}();return uu.NativeArrayIterator=t,uu}var hu,fu,du,pu={},yu={},gu={},bu={};function wu(){if(fu)return gu;fu=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(gu,"__esModule",{value:!0}),gu.LogicError=void 0;var n=function(){if(hu)return bu;hu=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(bu,"__esModule",{value:!0}),bu.Exception=void 0;var n=function(e){function n(t){var n=this.constructor,r=e.call(this,t)||this,o=n.prototype;return Object.setPrototypeOf?Object.setPrototypeOf(r,o):r.__proto__=o,r}return t(n,e),Object.defineProperty(n.prototype,"name",{get:function(){return this.constructor.name},enumerable:!1,configurable:!0}),n.prototype.what=function(){return this.message},n.prototype.toJSON=function(){return{name:this.name,message:this.message,stack:this.stack}},n}(Error);return bu.Exception=n,bu}(),r=function(e){function n(t){return e.call(this,t)||this}return t(n,e),n}(n.Exception);return gu.LogicError=r,gu}function vu(){if(du)return yu;du=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(yu,"__esModule",{value:!0}),yu.InvalidArgument=void 0;var n=function(e){function n(t){return e.call(this,t)||this}return t(n,e),n}(wu().LogicError);return yu.InvalidArgument=n,yu}var mu,_u,xu,Eu={};function ku(){return _u||(_u=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorGenerator=void 0;var t=vu(),n=function(){if(mu)return Eu;mu=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.OutOfRange=void 0;var n=function(e){function n(t){return e.call(this,t)||this}return t(n,e),n}(wu().LogicError);return Eu.OutOfRange=n,Eu}();!function(e){function r(e){if("string"==typeof e)return e;var t=e.constructor.name;return e.constructor.__MODULE&&(t="".concat(e.constructor.__MODULE,".").concat(t)),"std.".concat(t)}e.get_class_name=r,e.empty=function(e,t){return new n.OutOfRange("Error on ".concat(r(e),".").concat(t,"(): it's empty container."))},e.negative_index=function(e,t,o){return new n.OutOfRange("Error on ".concat(r(e),".").concat(t,"(): parametric index is negative -> (index = ").concat(o,")."))},e.excessive_index=function(e,t,o,i){return new n.OutOfRange("Error on ".concat(r(e),".").concat(t,"(): parametric index is equal or greater than size -> (index = ").concat(o,", size: ").concat(i,")."))},e.not_my_iterator=function(e,n){return new t.InvalidArgument("Error on ".concat(r(e),".").concat(n,"(): parametric iterator is not this container's own."))},e.erased_iterator=function(e,n){return new t.InvalidArgument("Error on ".concat(r(e),".").concat(n,"(): parametric iterator, it already has been erased."))},e.negative_iterator=function(e,t,o){return new n.OutOfRange("Error on ".concat(r(e),".").concat(t,"(): parametric iterator is directing negative position -> (index = ").concat(o,")."))},e.iterator_end_value=function(e,t){void 0===t&&(t="end");var o=r(e);return new n.OutOfRange("Error on ".concat(o,".Iterator.value: cannot access to the ").concat(o,".").concat(t,"().value."))},e.key_nout_found=function(e,t,o){throw new n.OutOfRange("Error on ".concat(r(e),".").concat(t,"(): unable to find the matched key -> ").concat(o))}}(e.ErrorGenerator||(e.ErrorGenerator={}))}(pu)),pu}function Su(){if(xu)return nu;xu=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),n=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},r=Jn&&Jn.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(nu,"__esModule",{value:!0}),nu.UniqueSet=void 0;var o=function(){if(cu)return ru;cu=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(ru,"__esModule",{value:!0}),ru.SetContainer=void 0;var n=su(),r=lu(),o=function(e){function n(t){var n=e.call(this)||this;return n.data_=t(n),n}return t(n,e),n.prototype.assign=function(e,t){this.clear(),this.insert(e,t)},n.prototype.clear=function(){this.data_.clear()},n.prototype.begin=function(){return this.data_.begin()},n.prototype.end=function(){return this.data_.end()},n.prototype.has=function(e){return!this.find(e).equals(this.end())},n.prototype.size=function(){return this.data_.size()},n.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this.size();var n=new r.NativeArrayIterator(e,0),o=new r.NativeArrayIterator(e,e.length);return this._Insert_by_range(n,o),this.size()},n.prototype.insert=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length?this._Insert_by_key(e[0]):e[0].next instanceof Function&&e[1].next instanceof Function?this._Insert_by_range(e[0],e[1]):this._Insert_by_hint(e[0],e[1])},n.prototype.erase=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1!==e.length||e[0]instanceof this.end().constructor&&e[0].source()===this?1===e.length?this._Erase_by_range(e[0]):this._Erase_by_range(e[0],e[1]):this._Erase_by_val(e[0])},n.prototype._Erase_by_range=function(e,t){void 0===t&&(t=e.next());var n=this.data_.erase(e,t);return this._Handle_erase(e,t),n},n}(n.Container);return ru.SetContainer=o,ru}(),i=ku(),s=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),o.prototype.count=function(e){return this.find(e).equals(this.end())?0:1},o.prototype.insert=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return e.prototype.insert.apply(this,r([],n(t),!1))},o.prototype._Insert_by_range=function(e,t){for(;!e.equals(t);e=e.next())this._Insert_by_key(e.value)},o.prototype.extract=function(e){return e instanceof this.end().constructor?this._Extract_by_iterator(e):this._Extract_by_val(e)},o.prototype._Extract_by_val=function(e){var t=this.find(e);if(!0===t.equals(this.end()))throw i.ErrorGenerator.key_nout_found(this,"extract",e);return this._Erase_by_range(t),e},o.prototype._Extract_by_iterator=function(e){return!0===e.equals(this.end())||!1===this.has(e.value)?this.end():(this._Erase_by_range(e),e)},o.prototype._Erase_by_val=function(e){var t=this.find(e);return!0===t.equals(this.end())?0:(this._Erase_by_range(t),1)},o.prototype.merge=function(e){for(var t=e.begin();!t.equals(e.end());)!1===this.has(t.value)?(this.insert(t.value),t=e.erase(t)):t=t.next()},o}(o.SetContainer);return nu.UniqueSet=s,nu}var Au,Ou={},Cu={};var Pu,Iu,Lu,ju={},Tu={},Bu={};function Ru(){if(Iu)return Tu;Iu=1,Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.get_uid=void 0;var e=function(){if(Pu)return Bu;Pu=1,Object.defineProperty(Bu,"__esModule",{value:!0}),Bu._Get_root=void 0;var e=za;Bu._Get_root=function(){return null===t&&void 0===(t=(0,e.is_node)()?Jn:self).__s_iUID&&(t.__s_iUID=0),t};var t=null;return Bu}();return Tu.get_uid=function(t){if(t instanceof Object){if(!1===t.hasOwnProperty("__get_m_iUID")){var n=++(0,e._Get_root)().__s_iUID;Object.defineProperty(t,"__get_m_iUID",{value:function(){return n}})}return t.__get_m_iUID()}return void 0===t?-1:0},Tu}function $u(){if(Lu)return ju;Lu=1;var e=Jn&&Jn.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ju,"__esModule",{value:!0}),ju.hash=void 0;var t=Ru();function n(e,t){return t^=e?1:0,t*=s}function r(e,t){return o(e.toString(),t)}function o(e,t){for(var n=0;n<e.length;++n)t^=e.charCodeAt(n),t*=s;return Math.abs(t)}ju.hash=function(){for(var a,c,u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];var h=i;try{for(var f=e(u),d=f.next();!d.done;d=f.next()){var p=d.value,y=typeof(p=p?p.valueOf():p);if("boolean"===y)h=n(p,h);else if("number"===y||"bigint"===y)h=r(p,h);else if("string"===y)h=o(p,h);else if(p instanceof Object&&p.hashCode instanceof Function){var g=p.hashCode();if(1===u.length)return g;h^=g,h*=s}else h=r((0,t.get_uid)(p),h)}}catch(e){a={error:e}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(a)throw a.error}}return Math.abs(h)};var i=2166136261,s=16777619;return ju}var Uu,Nu,Hu={};function Mu(){if(Uu)return Hu;Uu=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.greater_equal=Hu.greater=Hu.less_equal=Hu.less=Hu.not_equal_to=Hu.equal_to=void 0;var e=Ru();function t(e,t){return e=e?e.valueOf():e,t=t?t.valueOf():t,e instanceof Object&&e.equals instanceof Function?e.equals(t):e===t}function n(t,n){return t=t.valueOf(),n=n.valueOf(),t instanceof Object?t.less instanceof Function?t.less(n):(0,e.get_uid)(t)<(0,e.get_uid)(n):t<n}function r(e,r){return n(e,r)||t(e,r)}return Hu.equal_to=t,Hu.not_equal_to=function(e,n){return!t(e,n)},Hu.less=n,Hu.less_equal=r,Hu.greater=function(e,t){return!r(e,t)},Hu.greater_equal=function(e,t){return!n(e,t)},Hu}function qu(){return Nu||(Nu=1,function(e){var t=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},n=Jn&&Jn.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(e,"__esModule",{value:!0}),e.IHashContainer=void 0;var r=function(){return Au||(Au=1,e=Cu,t=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},n=Jn&&Jn.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Object.defineProperty(e,"__esModule",{value:!0}),e.IAssociativeContainer=void 0,function(e){e.construct=function(e){for(var r,o,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return i.length>=1&&i[0]instanceof Array?(r=function(){var r=i[0];e.push.apply(e,n([],t(r),!1))},o=i.slice(1)):i.length>=2&&i[0].next instanceof Function&&i[1].next instanceof Function?(r=function(){var t=i[0],n=i[1];e.assign(t,n)},o=i.slice(2)):(r=null,o=i),{ramda:r,tail:o}}}(e.IAssociativeContainer||(e.IAssociativeContainer={}))),Cu;var e,t,n}(),o=$u(),i=Mu();!function(e){e.construct=function(e,s,a){for(var c=[],u=3;u<arguments.length;u++)c[u-3]=arguments[u];var l=null,h=o.hash,f=i.equal_to;if(1===c.length&&c[0]instanceof s){var d=c[0];h=d.hash_function(),f=d.key_eq(),l=function(){var t=d.begin(),n=d.end();e.assign(t,n)}}else{var p=r.IAssociativeContainer.construct.apply(r.IAssociativeContainer,n([e],t(c),!1));l=p.ramda,p.tail.length>=1&&(h=p.tail[0]),p.tail.length>=2&&(f=p.tail[1])}a(h,f),null!==l&&l()}}(e.IHashContainer||(e.IHashContainer={}))}(Ou)),Ou}var Fu,Du={},zu={},Ku={};function Gu(){if(Fu)return Ku;Fu=1,Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.ListIterator=void 0;var e=ku(),t=function(){function t(e,t,n){this.prev_=e,this.next_=t,this.value_=n}return t._Set_prev=function(e,t){e.prev_=t},t._Set_next=function(e,t){e.next_=t},t.prototype.prev=function(){return this.prev_},t.prototype.next=function(){return this.next_},Object.defineProperty(t.prototype,"value",{get:function(){return this._Try_value(),this.value_},enumerable:!1,configurable:!0}),t.prototype._Try_value=function(){if(void 0===this.value_&&!0===this.equals(this.source().end()))throw e.ErrorGenerator.iterator_end_value(this.source())},t.prototype.equals=function(e){return this===e},t}();return Ku.ListIterator=t,Ku}var Wu,Vu={};var Yu,Zu,Ju={};function Qu(){if(Yu)return Ju;Yu=1,Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.next=Ju.prev=Ju.advance=Ju.distance=Ju.size=Ju.empty=void 0;var e=vu();function t(t,n){if(0===n)return t;if(t.advance instanceof Function)return t.advance(n);var r;if(n<0){if(!(t.prev instanceof Function))throw new e.InvalidArgument("Error on std.advance(): parametric iterator is not a bi-directional iterator, thus advancing to negative direction is not possible.");r=function(e){return e.prev()},n=-n}else r=function(e){return e.next()};for(;n-- >0;)t=r(t);return t}return Ju.empty=function(e){return e instanceof Array?0!==e.length:e.empty()},Ju.size=function(e){return e instanceof Array?e.length:e.size()},Ju.distance=function(e,t){if(e.index instanceof Function)return function(e,t){var n=e.index(),r=t.index();return e.base instanceof Function?n-r:r-n}(e,t);for(var n=0;!e.equals(t);e=e.next())++n;return n},Ju.advance=t,Ju.prev=function(e,n){return void 0===n&&(n=1),1===n?e.prev():t(e,-n)},Ju.next=function(e,n){return void 0===n&&(n=1),1===n?e.next():t(e,n)},Ju}function Xu(){if(Zu)return zu;Zu=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),n=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(zu,"__esModule",{value:!0}),zu.ListContainer=void 0;var r=su(),o=Gu(),i=function(){if(Wu)return Vu;Wu=1,Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.Repeater=void 0;var e=function(){function e(e,t){this.index_=e,this.value_=t}return e.prototype.index=function(){return this.index_},Object.defineProperty(e.prototype,"value",{get:function(){return this.value_},enumerable:!1,configurable:!0}),e.prototype.next=function(){return++this.index_,this},e.prototype.equals=function(e){return this.index_===e.index_},e}();return Vu.Repeater=e,Vu}(),s=lu(),a=Qu(),c=ku(),u=function(e){function r(){var t=e.call(this)||this;return t.end_=t._Create_iterator(null,null),t.clear(),t}return t(r,e),r.prototype.assign=function(e,t){this.clear(),this.insert(this.end(),e,t)},r.prototype.clear=function(){o.ListIterator._Set_prev(this.end_,this.end_),o.ListIterator._Set_next(this.end_,this.end_),this.begin_=this.end_,this.size_=0},r.prototype.resize=function(e){var t=e-this.size();t>0?this.insert(this.end(),t,void 0):t<0&&this.erase((0,a.advance)(this.end(),-t),this.end())},r.prototype.begin=function(){return this.begin_},r.prototype.end=function(){return this.end_},r.prototype.size=function(){return this.size_},r.prototype.push_front=function(e){this.insert(this.begin_,e)},r.prototype.push_back=function(e){this.insert(this.end_,e)},r.prototype.pop_front=function(){if(!0===this.empty())throw c.ErrorGenerator.empty(this.end_.source().constructor.name,"pop_front");this.erase(this.begin_)},r.prototype.pop_back=function(){if(!0===this.empty())throw c.ErrorGenerator.empty(this.end_.source().constructor.name,"pop_back");this.erase(this.end_.prev())},r.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this.size();var n=new s.NativeArrayIterator(e,0),r=new s.NativeArrayIterator(e,e.length);return this._Insert_by_range(this.end(),n,r),this.size()},r.prototype.insert=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e.source()!==this.end_.source())throw c.ErrorGenerator.not_my_iterator(this.end_.source(),"insert");if(!0===e.erased_)throw c.ErrorGenerator.erased_iterator(this.end_.source(),"insert");return 1===t.length?this._Insert_by_repeating_val(e,1,t[0]):2===t.length&&"number"==typeof t[0]?this._Insert_by_repeating_val(e,t[0],t[1]):this._Insert_by_range(e,t[0],t[1])},r.prototype._Insert_by_repeating_val=function(e,t,n){var r=new i.Repeater(0,n),o=new i.Repeater(t);return this._Insert_by_range(e,r,o)},r.prototype._Insert_by_range=function(e,t,n){for(var r=e.prev(),i=null,s=0,a=t;!1===a.equals(n);a=a.next()){var c=this._Create_iterator(r,null,a.value);0===s&&(i=c),o.ListIterator._Set_next(r,c),r=c,++s}return!0===e.equals(this.begin())&&(this.begin_=i),o.ListIterator._Set_next(r,e),o.ListIterator._Set_prev(e,r),this.size_+=s,i},r.prototype.erase=function(e,t){return void 0===t&&(t=e.next()),this._Erase_by_range(e,t)},r.prototype._Erase_by_range=function(e,t){if(e.source()!==this.end_.source())throw c.ErrorGenerator.not_my_iterator(this.end_.source(),"insert");if(!0===e.erased_)throw c.ErrorGenerator.erased_iterator(this.end_.source(),"insert");if(e.equals(this.end_))return this.end_;var n=e.prev();o.ListIterator._Set_next(n,t),o.ListIterator._Set_prev(t,n);for(var r=e;!r.equals(t);r=r.next())r.erased_=!0,--this.size_;return e.equals(this.begin_)&&(this.begin_=t),t},r.prototype.swap=function(e){var t,r,o;t=n([e.begin_,this.begin_],2),this.begin_=t[0],e.begin_=t[1],r=n([e.end_,this.end_],2),this.end_=r[0],e.end_=r[1],o=n([e.size_,this.size_],2),this.size_=o[0],e.size_=o[1]},r}(r.Container);return zu.ListContainer=u,zu}var el,tl,nl={};function rl(){if(el)return nl;el=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.ReverseIterator=void 0;var e=function(){function e(e){this.base_=e.prev()}return e.prototype.source=function(){return this.base_.source()},e.prototype.base=function(){return this.base_.next()},Object.defineProperty(e.prototype,"value",{get:function(){return this.base_.value},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return this._Create_neighbor(this.base().next())},e.prototype.next=function(){return this._Create_neighbor(this.base_)},e.prototype.equals=function(e){return this.base_.equals(e.base_)},e}();return nl.ReverseIterator=e,nl}var ol,il,sl={},al={};function cl(){if(ol)return al;ol=1;var e=Jn&&Jn.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(al,"__esModule",{value:!0}),al.HashBuckets=void 0;var t=function(){function t(e,t){this.fetcher_=e,this.hasher_=t,this.max_load_factor_=r,this.data_=[],this.size_=0,this.initialize()}return t.prototype.clear=function(){this.data_=[],this.size_=0,this.initialize()},t.prototype.rehash=function(t){var r,o,i,s;t=Math.max(t,n);for(var a=[],c=0;c<t;++c)a.push([]);try{for(var u=e(this.data_),l=u.next();!l.done;l=u.next()){var h=l.value;try{for(var f=(i=void 0,e(h)),d=f.next();!d.done;d=f.next()){var p=d.value;a[this.hasher_(this.fetcher_(p))%a.length].push(p)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}this.data_=a},t.prototype.reserve=function(e){e>this.capacity()&&(e=Math.floor(e/this.max_load_factor_),this.rehash(e))},t.prototype.initialize=function(){for(var e=0;e<n;++e)this.data_.push([])},t.prototype.length=function(){return this.data_.length},t.prototype.capacity=function(){return this.data_.length*this.max_load_factor_},t.prototype.at=function(e){return this.data_[e]},t.prototype.load_factor=function(){return this.size_/this.length()},t.prototype.max_load_factor=function(e){if(void 0===e&&(e=null),null===e)return this.max_load_factor_;this.max_load_factor_=e},t.prototype.hash_function=function(){return this.hasher_},t.prototype.index=function(e){return this.hasher_(this.fetcher_(e))%this.length()},t.prototype.insert=function(e){var t=this.capacity();++this.size_>t&&this.reserve(2*t);var n=this.index(e);this.data_[n].push(e)},t.prototype.erase=function(e){for(var t=this.index(e),n=this.data_[t],r=0;r<n.length;++r)if(n[r]===e){n.splice(r,1),--this.size_;break}},t}();al.HashBuckets=t;var n=10,r=1;return al}var ul,ll,hl={};function fl(){if(ul)return hl;ul=1,Object.defineProperty(hl,"__esModule",{value:!0}),hl.make_pair=hl.Pair=void 0;var e=$u(),t=Mu(),n=function(){function n(e,t){this.first=e,this.second=t}return n.prototype.equals=function(e){return(0,t.equal_to)(this.first,e.first)&&(0,t.equal_to)(this.second,e.second)},n.prototype.less=function(e){return!1===(0,t.equal_to)(this.first,e.first)?(0,t.less)(this.first,e.first):(0,t.less)(this.second,e.second)},n.prototype.hashCode=function(){return(0,e.hash)(this.first,this.second)},n}();return hl.Pair=n,hl.make_pair=function(e,t){return new n(e,t)},hl}function dl(){return ll||(ll=1,function(e){var t,n=Jn&&Jn.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},o=Jn&&Jn.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(e,"__esModule",{value:!0}),e.HashSet=void 0;var i=Su(),s=qu(),a=(tl||(tl=1,function(e){var t,n=Jn&&Jn.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.SetElementList=void 0;var o=Xu(),i=Gu(),s=rl(),a=function(e){function t(t){var n=e.call(this)||this;return n.associative_=t,n}return n(t,e),t.prototype._Create_iterator=function(e,n,r){return t.Iterator.create(this,e,n,r)},t._Swap_associative=function(e,t){var n;n=r([t.associative_,e.associative_],2),e.associative_=n[0],t.associative_=n[1]},t.prototype.associative=function(){return this.associative_},t}(o.ListContainer);e.SetElementList=a,function(e){var t=function(e){function t(t,n,r,o){var i=e.call(this,n,r,o)||this;return i.source_=t,i}return n(t,e),t.create=function(e,n,r,o){return new t(e,n,r,o)},t.prototype.reverse=function(){return new r(this)},t.prototype.source=function(){return this.source_.associative()},t}(i.ListIterator);e.Iterator=t;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._Create_neighbor=function(e){return new t(e)},t}(s.ReverseIterator);e.ReverseIterator=r}(a=e.SetElementList||(e.SetElementList={})),e.SetElementList=a}(Du)),Du),c=function(){if(il)return sl;il=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),n=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},r=Jn&&Jn.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(sl,"__esModule",{value:!0}),sl.SetHashBuckets=void 0;var o=function(e){function o(t,n,r){var o=e.call(this,i,n)||this;return o.source_=t,o.key_eq_=r,o}return t(o,e),o._Swap_source=function(e,t){var r;r=n([t.source_,e.source_],2),e.source_=r[0],t.source_=r[1]},o.prototype.key_eq=function(){return this.key_eq_},o.prototype.find=function(e){var t,n,o=this.hash_function()(e)%this.length(),i=this.at(o);try{for(var s=r(i),a=s.next();!a.done;a=s.next()){var c=a.value;if(this.key_eq_(c.value,e))return c}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return this.source_.end()},o}(cl().HashBuckets);function i(e){return e.value}return sl.SetHashBuckets=o,sl}(),u=fl(),l=function(e){function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var u=e.call(this,(function(e){return new a.SetElementList(e)}))||this;return s.IHashContainer.construct.apply(s.IHashContainer,o([u,t,function(e,t){u.buckets_=new c.SetHashBuckets(u,e,t)}],r(n),!1)),u}return n(t,e),t.prototype.clear=function(){this.buckets_.clear(),e.prototype.clear.call(this)},t.prototype.swap=function(e){var t,n;t=r([e.data_,this.data_],2),this.data_=t[0],e.data_=t[1],a.SetElementList._Swap_associative(this.data_,e.data_),c.SetHashBuckets._Swap_source(this.buckets_,e.buckets_),n=r([e.buckets_,this.buckets_],2),this.buckets_=n[0],e.buckets_=n[1]},t.prototype.find=function(e){return this.buckets_.find(e)},t.prototype.begin=function(t){return void 0===t&&(t=null),null===t?e.prototype.begin.call(this):this.buckets_.at(t)[0]},t.prototype.end=function(t){if(void 0===t&&(t=null),null===t)return e.prototype.end.call(this);var n=this.buckets_.at(t);return n[n.length-1].next()},t.prototype.rbegin=function(e){return void 0===e&&(e=null),this.end(e).reverse()},t.prototype.rend=function(e){return void 0===e&&(e=null),this.begin(e).reverse()},t.prototype.bucket_count=function(){return this.buckets_.length()},t.prototype.bucket_size=function(e){return this.buckets_.at(e).length},t.prototype.load_factor=function(){return this.buckets_.load_factor()},t.prototype.hash_function=function(){return this.buckets_.hash_function()},t.prototype.key_eq=function(){return this.buckets_.key_eq()},t.prototype.bucket=function(e){return this.hash_function()(e)%this.buckets_.length()},t.prototype.max_load_factor=function(e){return void 0===e&&(e=null),this.buckets_.max_load_factor(e)},t.prototype.reserve=function(e){this.buckets_.reserve(e)},t.prototype.rehash=function(e){this.buckets_.rehash(e)},t.prototype._Insert_by_key=function(e){var t=this.find(e);return!1===t.equals(this.end())?new u.Pair(t,!1):(this.data_.push(e),t=t.prev(),this._Handle_insert(t,t.next()),new u.Pair(t,!0))},t.prototype._Insert_by_hint=function(e,t){var n=this.find(t);return!0===n.equals(this.end())&&(n=this.data_.insert(e,t),this._Handle_insert(n,n.next())),n},t.prototype._Handle_insert=function(e,t){for(;!e.equals(t);e=e.next())this.buckets_.insert(e)},t.prototype._Handle_erase=function(e,t){for(;!e.equals(t);e=e.next())this.buckets_.erase(e)},t}(i.UniqueSet);e.HashSet=l,function(e){e.Iterator=a.SetElementList.Iterator,e.ReverseIterator=a.SetElementList.ReverseIterator}(l=e.HashSet||(e.HashSet={})),e.HashSet=l}(tu)),tu}var pl,yl,gl={},bl={},wl={};function vl(){if(yl)return bl;yl=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),n=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},r=Jn&&Jn.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(bl,"__esModule",{value:!0}),bl.UniqueMap=void 0;var o=function(){if(pl)return wl;pl=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(wl,"__esModule",{value:!0}),wl.MapContainer=void 0;var n=su(),r=lu(),o=function(e){function n(t){var n=e.call(this)||this;return n.data_=t(n),n}return t(n,e),n.prototype.assign=function(e,t){this.clear(),this.insert(e,t)},n.prototype.clear=function(){this.data_.clear()},n.prototype.begin=function(){return this.data_.begin()},n.prototype.end=function(){return this.data_.end()},n.prototype.has=function(e){return!this.find(e).equals(this.end())},n.prototype.size=function(){return this.data_.size()},n.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=new r.NativeArrayIterator(e,0),o=new r.NativeArrayIterator(e,e.length);return this.insert(n,o),this.size()},n.prototype.insert=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length?this.emplace(e[0].first,e[0].second):e[0].next instanceof Function&&e[1].next instanceof Function?this._Insert_by_range(e[0],e[1]):this.emplace_hint(e[0],e[1].first,e[1].second)},n.prototype.erase=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1!==e.length||e[0]instanceof this.end().constructor!=0&&e[0].source()===this?1===e.length?this._Erase_by_range(e[0]):this._Erase_by_range(e[0],e[1]):this._Erase_by_key(e[0])},n.prototype._Erase_by_range=function(e,t){void 0===t&&(t=e.next());var n=this.data_.erase(e,t);return this._Handle_erase(e,t),n},n}(n.Container);return wl.MapContainer=o,wl}(),i=ku(),s=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),o.prototype.count=function(e){return this.find(e).equals(this.end())?0:1},o.prototype.get=function(e){var t=this.find(e);if(!0===t.equals(this.end()))throw i.ErrorGenerator.key_nout_found(this,"get",e);return t.second},o.prototype.take=function(e,t){var n=this.find(e);return n.equals(this.end())?this.emplace(e,t()).first.second:n.second},o.prototype.set=function(e,t){this.insert_or_assign(e,t)},o.prototype.insert=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return e.prototype.insert.apply(this,r([],n(t),!1))},o.prototype._Insert_by_range=function(e,t){for(var n=e;!n.equals(t);n=n.next())this.emplace(n.value.first,n.value.second)},o.prototype.insert_or_assign=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 2===e.length?this._Insert_or_assign_with_key_value(e[0],e[1]):3===e.length?this._Insert_or_assign_with_hint(e[0],e[1],e[2]):void 0},o.prototype._Insert_or_assign_with_key_value=function(e,t){var n=this.emplace(e,t);return!1===n.second&&(n.first.second=t),n},o.prototype._Insert_or_assign_with_hint=function(e,t,n){var r=this.emplace_hint(e,t,n);return r.second!==n&&(r.second=n),r},o.prototype.extract=function(e){return e instanceof this.end().constructor?this._Extract_by_iterator(e):this._Extract_by_key(e)},o.prototype._Extract_by_key=function(e){var t=this.find(e);if(!0===t.equals(this.end()))throw i.ErrorGenerator.key_nout_found(this,"extract",e);var n=t.value;return this._Erase_by_range(t),n},o.prototype._Extract_by_iterator=function(e){return!0===e.equals(this.end())?this.end():(this._Erase_by_range(e),e)},o.prototype._Erase_by_key=function(e){var t=this.find(e);return!0===t.equals(this.end())?0:(this._Erase_by_range(t),1)},o.prototype.merge=function(e){for(var t=e.begin();!t.equals(e.end());)!1===this.has(t.first)?(this.insert(t.value),t=e.erase(t)):t=t.next()},o}(o.MapContainer);return bl.UniqueMap=s,bl}var ml,_l={};var xl,El={};var kl,Sl,Al,Ol={};function Cl(){return Sl||(Sl=1,function(e){var t,n=Jn&&Jn.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},o=Jn&&Jn.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(e,"__esModule",{value:!0}),e.HashMap=void 0;var i=vl(),s=qu(),a=(ml||(ml=1,function(e){var t,n=Jn&&Jn.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0}),e.MapElementList=void 0;var o=Xu(),i=Gu(),s=rl(),a=function(e){function t(t){var n=e.call(this)||this;return n.associative_=t,n}return n(t,e),t.prototype._Create_iterator=function(e,n,r){return t.Iterator.create(this,e,n,r)},t._Swap_associative=function(e,t){var n;n=r([t.associative_,e.associative_],2),e.associative_=n[0],t.associative_=n[1]},t.prototype.associative=function(){return this.associative_},t}(o.ListContainer);e.MapElementList=a,function(e){var t=function(e){function t(t,n,r,o){var i=e.call(this,n,r,o)||this;return i.list_=t,i}return n(t,e),t.create=function(e,n,r,o){return new t(e,n,r,o)},t.prototype.reverse=function(){return new r(this)},t.prototype.source=function(){return this.list_.associative()},Object.defineProperty(t.prototype,"first",{get:function(){return this.value.first},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"second",{get:function(){return this.value.second},set:function(e){this.value.second=e},enumerable:!1,configurable:!0}),t}(i.ListIterator);e.Iterator=t;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._Create_neighbor=function(e){return new t(e)},Object.defineProperty(t.prototype,"first",{get:function(){return this.base_.first},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"second",{get:function(){return this.base_.second},set:function(e){this.base_.second=e},enumerable:!1,configurable:!0}),t}(s.ReverseIterator);e.ReverseIterator=r}(a=e.MapElementList||(e.MapElementList={})),e.MapElementList=a}(_l)),_l),c=function(){if(xl)return El;xl=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),n=Jn&&Jn.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},r=Jn&&Jn.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(El,"__esModule",{value:!0}),El.MapHashBuckets=void 0;var o=function(e){function o(t,n,r){var o=e.call(this,i,n)||this;return o.source_=t,o.key_eq_=r,o}return t(o,e),o._Swap_source=function(e,t){var r;r=n([t.source_,e.source_],2),e.source_=r[0],t.source_=r[1]},o.prototype.key_eq=function(){return this.key_eq_},o.prototype.find=function(e){var t,n,o=this.hash_function()(e)%this.length(),i=this.at(o);try{for(var s=r(i),a=s.next();!a.done;a=s.next()){var c=a.value;if(this.key_eq_(c.first,e))return c}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return this.source_.end()},o}(cl().HashBuckets);function i(e){return e.first}return El.MapHashBuckets=o,El}(),u=function(){if(kl)return Ol;kl=1,Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.Entry=void 0;var e=$u(),t=Mu(),n=function(){function n(e,t){this.first=e,this.second=t}return n.prototype.equals=function(e){return(0,t.equal_to)(this.first,e.first)},n.prototype.less=function(e){return(0,t.less)(this.first,e.first)},n.prototype.hashCode=function(){return(0,e.hash)(this.first)},n}();return Ol.Entry=n,Ol}(),l=fl(),h=function(e){function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var u=e.call(this,(function(e){return new a.MapElementList(e)}))||this;return s.IHashContainer.construct.apply(s.IHashContainer,o([u,t,function(e,t){u.buckets_=new c.MapHashBuckets(u,e,t)}],r(n),!1)),u}return n(t,e),t.prototype.clear=function(){this.buckets_.clear(),e.prototype.clear.call(this)},t.prototype.swap=function(e){var t,n;t=r([e.data_,this.data_],2),this.data_=t[0],e.data_=t[1],a.MapElementList._Swap_associative(this.data_,e.data_),c.MapHashBuckets._Swap_source(this.buckets_,e.buckets_),n=r([e.buckets_,this.buckets_],2),this.buckets_=n[0],e.buckets_=n[1]},t.prototype.find=function(e){return this.buckets_.find(e)},t.prototype.begin=function(t){return void 0===t&&(t=null),null===t?e.prototype.begin.call(this):this.buckets_.at(t)[0]},t.prototype.end=function(t){if(void 0===t&&(t=null),null===t)return e.prototype.end.call(this);var n=this.buckets_.at(t);return n[n.length-1].next()},t.prototype.rbegin=function(e){return void 0===e&&(e=null),this.end(e).reverse()},t.prototype.rend=function(e){return void 0===e&&(e=null),this.begin(e).reverse()},t.prototype.bucket_count=function(){return this.buckets_.length()},t.prototype.bucket_size=function(e){return this.buckets_.at(e).length},t.prototype.load_factor=function(){return this.buckets_.load_factor()},t.prototype.hash_function=function(){return this.buckets_.hash_function()},t.prototype.key_eq=function(){return this.buckets_.key_eq()},t.prototype.bucket=function(e){return this.hash_function()(e)%this.buckets_.length()},t.prototype.max_load_factor=function(e){return void 0===e&&(e=null),this.buckets_.max_load_factor(e)},t.prototype.reserve=function(e){this.buckets_.reserve(e)},t.prototype.rehash=function(e){this.buckets_.rehash(e)},t.prototype.emplace=function(e,t){var n=this.find(e);return!1===n.equals(this.end())?new l.Pair(n,!1):(this.data_.push(new u.Entry(e,t)),n=n.prev(),this._Handle_insert(n,n.next()),new l.Pair(n,!0))},t.prototype.emplace_hint=function(e,t,n){var r=this.find(t);return!0===r.equals(this.end())&&(r=this.data_.insert(e,new u.Entry(t,n)),this._Handle_insert(r,r.next())),r},t.prototype._Handle_insert=function(e,t){for(;!e.equals(t);e=e.next())this.buckets_.insert(e)},t.prototype._Handle_erase=function(e,t){for(;!e.equals(t);e=e.next())this.buckets_.erase(e)},t}(i.UniqueMap);e.HashMap=h,function(e){e.Iterator=a.MapElementList.Iterator,e.ReverseIterator=a.MapElementList.ReverseIterator}(h=e.HashMap||(e.HashMap={})),e.HashMap=h}(gl)),gl}var Pl,Il={};function Ll(){if(Pl)return Il;Pl=1,Object.defineProperty(Il,"__esModule",{value:!0});var e=function(e,t){this.type=e,t&&Object.assign(this,t)};return Il.Event=e,Il}var jl,Tl={};var Bl,Rl={};var $l,Ul,Nl={};za.is_node()&&(Jn.WebSocket=(Ul||(Ul=1,function(e){var t,n=Jn&&Jn.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},t(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=Jn&&Jn.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=Jc(),i=function(){if(Al)return eu;Al=1;var e=Jn&&Jn.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(eu,"__esModule",{value:!0});var t=dl(),n=Cl(),r=function(){function r(){this.listeners_=new n.HashMap,this.created_at_=new Date}return r.prototype.dispatchEvent=function(t){var n,r,o=this.listeners_.find(t.type);if(!o.equals(this.listeners_.end())){t.target=this,t.timeStamp=(new Date).getTime()-this.created_at_.getTime();try{for(var i=e(o.second),s=i.next();!s.done;s=i.next())(0,s.value)(t)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}},r.prototype.addEventListener=function(e,n){var r=this.listeners_.find(e);r.equals(this.listeners_.end())&&(r=this.listeners_.emplace(e,new t.HashSet).first),r.second.insert(n)},r.prototype.removeEventListener=function(e,t){var n=this.listeners_.find(e);n.equals(this.listeners_.end())||(n.second.erase(t),n.second.empty()&&this.listeners_.erase(n))},r}();return eu.EventTarget=r,eu}(),s=Ll(),a=function(){if(jl)return Tl;jl=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(Tl,"__esModule",{value:!0});var n=function(e){function n(t,n){return e.call(this,t,n)||this}return t(n,e),n}(Ll().Event);return Tl.CloseEvent=n,Tl}(),c=function(){if(Bl)return Rl;Bl=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(Rl,"__esModule",{value:!0});var n=function(e){function n(t,n){return e.call(this,t,n)||this}return t(n,e),n}(Ll().Event);return Rl.MessageEvent=n,Rl}(),u=function(){if($l)return Nl;$l=1;var e,t=Jn&&Jn.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(Nl,"__esModule",{value:!0});var n=function(e){function n(t,n){return e.call(this,t,n)||this}return t(n,e),n}(Ll().Event);return Nl.ErrorEvent=n,Nl}(),l=function(e){function t(n,r){var i=e.call(this)||this;return i.on_={},i.state_=t.CONNECTING,i.client_=new o.client,i.client_.on("connect",i._Handle_connect.bind(i)),i.client_.on("connectFailed",i._Handle_error.bind(i)),"string"==typeof r&&(r=[r]),i.client_.connect(n,r),i}return n(t,e),t.prototype.close=function(e,n){this.state_=t.CLOSING,void 0===e?this.connection_.sendCloseFrame():this.connection_.sendCloseFrame(e,n,!0)},t.prototype.send=function(e){if("string"==typeof e.valueOf())this.connection_.sendUTF(e);else{var t=void 0;t=e instanceof ic?e:e instanceof Blob?new ic(e,"blob"):e.buffer?new ic(e.buffer):new ic(e),this.connection_.sendBytes(t)}},Object.defineProperty(t.prototype,"url",{get:function(){return this.client_.url.href},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this.client_.protocols?this.client_.protocols[0]:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this.connection_&&this.connection_.extensions?this.connection_.extensions[0].name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this.state_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){return this.connection_.bytesWaitingToFlush},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return"arraybuffer"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onopen",{get:function(){return this.on_.open},set:function(e){this._Set_on("open",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onclose",{get:function(){return this.on_.close},set:function(e){this._Set_on("close",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onmessage",{get:function(){return this.on_.message},set:function(e){this._Set_on("message",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onerror",{get:function(){return this.on_.error},set:function(e){this._Set_on("error",e)},enumerable:!0,configurable:!0}),t.prototype._Set_on=function(e,t){this.on_[e]&&this.removeEventListener(e,this.on_[e]),this.addEventListener(e,t),this.on_[e]=t},t.prototype._Handle_connect=function(e){this.connection_=e,this.state_=t.OPEN,this.connection_.on("message",this._Handle_message.bind(this)),this.connection_.on("error",this._Handle_error.bind(this)),this.connection_.on("close",this._Handle_close.bind(this));var n=new s.Event("open",h);this.dispatchEvent(n)},t.prototype._Handle_close=function(e,n){var o=new a.CloseEvent("close",r({},h,{code:e,reason:n}));this.state_=t.CLOSED,this.dispatchEvent(o)},t.prototype._Handle_message=function(e){var t=new c.MessageEvent("message",r({},h,{data:e.binaryData?e.binaryData:e.utf8Data}));this.dispatchEvent(t)},t.prototype._Handle_error=function(e){var n=new u.ErrorEvent("error",r({},h,{error:e,message:e.message}));this.state_===t.CONNECTING&&(this.state_=t.CLOSED),this.dispatchEvent(n)},t}(i.EventTarget);e.WebSocket=l,function(e){e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3}(l=e.WebSocket||(e.WebSocket={})),e.WebSocket=l;var h={bubbles:!1,cancelable:!1}}(Kc)),Kc).WebSocket);const{bech32:Hl,hex:Ml,utf8:ql}=zr,Fl={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},Dl={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},zl={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},Kl={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},Gl=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],Wl={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},Vl=BigInt("2100000000000000000"),Yl=BigInt(1e11),Zl={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},Jl={};for(let e=0,t=Object.keys(Zl);e<t.length;e++){const n=t[e],r=Zl[t[e]].toString();Jl[r]=n}const Ql={1:e=>Ml.encode(Hl.fromWordsUnsafe(e)),16:e=>Ml.encode(Hl.fromWordsUnsafe(e)),13:e=>ql.encode(Hl.fromWordsUnsafe(e)),19:e=>Ml.encode(Hl.fromWordsUnsafe(e)),23:e=>Ml.encode(Hl.fromWordsUnsafe(e)),27:e=>Ml.encode(Hl.fromWordsUnsafe(e)),6:eh,24:eh,3:function(e){const t=[];let n,r,o,i,s,a=Hl.fromWordsUnsafe(e);for(;a.length>0;)n=Ml.encode(a.slice(0,33)),r=Ml.encode(a.slice(33,41)),o=parseInt(Ml.encode(a.slice(41,45)),16),i=parseInt(Ml.encode(a.slice(45,49)),16),s=parseInt(Ml.encode(a.slice(49,51)),16),a=a.slice(51),t.push({pubkey:n,short_channel_id:r,fee_base_msat:o,fee_proportional_millionths:i,cltv_expiry_delta:s});return t},5:function(e){const t=e.slice().reverse().map((e=>[!!(1&e),!!(2&e),!!(4&e),!!(8&e),!!(16&e)])).reduce(((e,t)=>e.concat(t)),[]);for(;t.length<2*Gl.length;)t.push(!1);const n={};Gl.forEach(((e,r)=>{let o;o=t[2*r]?"required":t[2*r+1]?"supported":"unsupported",n[e]=o}));const r=t.slice(2*Gl.length);return n.extra_bits={start_bit:2*Gl.length,bits:r,has_required:r.reduce(((e,t,n)=>n%2!=0?e||!1:e||t),!1)},n}};function Xl(e){return t=>({tagCode:parseInt(e),words:Hl.encode("unknown",t,Number.MAX_SAFE_INTEGER)})}function eh(e){return e.reverse().reduce(((e,t,n)=>e+t*Math.pow(32,n)),0)}function th(e,t){let n,r;if(e.slice(-1).match(/^[munp]$/))n=e.slice(-1),r=e.slice(0,-1);else{if(e.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");r=e}if(!r.match(/^\d+$/))throw new Error("Not a valid human readable amount");const o=BigInt(r),i=n?o*Yl/Wl[n]:o*Yl;if("p"===n&&o%BigInt(10)!==BigInt(0)||i>Vl)throw new Error("Amount is outside of valid range");return t?i.toString():i}var nh={decode:function(e,t){if("string"!=typeof e)throw new Error("Lightning Payment Request must be string");if("ln"!==e.slice(0,2).toLowerCase())throw new Error("Not a proper lightning payment request");const n=[],r=Hl.decode(e,Number.MAX_SAFE_INTEGER);e=e.toLowerCase();const o=r.prefix;let i=r.words,s=e.slice(o.length+1),a=i.slice(-104);i=i.slice(0,-104);let c=o.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(c&&!c[2]&&(c=o.match(/^ln(\S+)$/)),!c)throw new Error("Not a proper lightning payment request");n.push({name:"lightning_network",letters:"ln"});const u=c[1];let l;if(t){if(void 0===t.bech32||void 0===t.pubKeyHash||void 0===t.scriptHash||!Array.isArray(t.validWitnessVersions))throw new Error("Invalid network");l=t}else switch(u){case Fl.bech32:l=Fl;break;case Dl.bech32:l=Dl;break;case zl.bech32:l=zl;break;case Kl.bech32:l=Kl}if(!l||l.bech32!==u)throw new Error("Unknown coin bech32 prefix");n.push({name:"coin_network",letters:u,value:l});const h=c[2];let f;if(h){f=th(h+c[3],!0),n.push({name:"amount",letters:c[2]+c[3],value:f})}else f=null;n.push({name:"separator",letters:"1"});const d=eh(i.slice(0,7));let p,y,g,b;for(i=i.slice(7),n.push({name:"timestamp",letters:s.slice(0,7),value:d}),s=s.slice(7);i.length>0;){const e=i[0].toString();p=Jl[e]||"unknown_tag",y=Ql[e]||Xl(e),i=i.slice(1),g=eh(i.slice(0,2)),i=i.slice(2),b=i.slice(0,g),i=i.slice(g),n.push({name:p,tag:s[0],letters:s.slice(0,3+g),value:y(b)}),s=s.slice(3+g)}n.push({name:"signature",letters:s.slice(0,104),value:Ml.encode(Hl.fromWordsUnsafe(a))}),s=s.slice(104),n.push({name:"checksum",letters:s});let w={paymentRequest:e,sections:n,get expiry(){let e=n.find((e=>"expiry"===e.name));if(e)return v("timestamp")+e.value},get route_hints(){return n.filter((e=>"route_hint"===e.name)).map((e=>e.value))}};for(let e in Zl)"route_hint"!==e&&Object.defineProperty(w,e,{get:()=>v(e)});return w;function v(e){let t=n.find((t=>t.name===e));return t?t.value:void 0}},hrpToMillisat:th};var rh=["wss://nos.lol","wss://relay.nostr.band","wss://relay.f7z.io","wss://relay.damus.io","wss://nostr.mom","wss://no.str.cr"],oh=class extends Da{ndk;zappedEvent;zappedUser;constructor(e){super(),this.ndk=e.ndk,this.zappedEvent=e.zappedEvent,this.zappedUser=e.zappedUser||this.ndk.getUser({hexpubkey:this.zappedEvent.pubkey})}async getZapEndpoint(){let e,t,n,r;if(this.zappedEvent){const n=(await this.zappedEvent.getMatchingTags("zap"))[0];if(n)switch(n[2]){case"lud06":e=n[1];break;case"lud16":t=n[1];break;default:throw new Error(`Unknown zap tag ${n}`)}}if(!this.zappedUser||e||t||(this.zappedUser.profile||await this.zappedUser.fetchProfile(),e=(this.zappedUser.profile||{}).lud06,t=(this.zappedUser.profile||{}).lud16),t){const[e,r]=t.split("@");n=`https://${r}/.well-known/lnurlp/${e}`}else if(e){const{words:t}=Yn.decode(e,1e3),r=Yn.fromWords(t);n=new TextDecoder("utf-8").decode(r)}if(!n)throw new Error("No zap endpoint found");const o=await fetch(n),i=await o.json();return i?.allowsNostr&&(i?.nostrPubkey||i?.nostrPubKey)&&(r=i.callback),r}async createZapRequest(e,t,n,r){const o=await this.getZapEndpoint();if(!o)throw new Error("No zap endpoint found");if(!this.zappedEvent)throw new Error("No zapped event found");const i=Hs.makeZapRequest({profile:this.zappedUser.hexpubkey(),event:null,amount:e,comment:t||"",relays:r??this.relays()});if(this.zappedEvent){const e=this.zappedEvent.tagReference();e&&i.tags.push(e)}i.tags.push(["lnurl",o]);const s=new ph(this.ndk,i);n&&(s.tags=s.tags.concat(n)),await s.sign();const a=await s.toNostrEvent(),c=await fetch(`${o}?`+new URLSearchParams({amount:e.toString(),nostr:JSON.stringify(a)}));return(await c.json()).pr}relays(){let e=[];return this.ndk?.pool?.relays&&(e=this.ndk.pool.urls()),e.length||(e=rh),e}};function ih(){if(void 0===this.kind)throw new Error("Kind not set");return this.kind>=1e4&&this.kind<2e4}function sh(){if(void 0===this.kind)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}async function ah(){if(!this.ndk)throw new Error("NDK not set");const e=await this.ndk.fetchEvents({kinds:[3],authors:[this.hexpubkey()]});if(e){const t=new Set;return e.forEach((e=>{e.tags.forEach((e=>{if("p"===e[0])try{const n=Di.npubEncode(e[1]);t.add(n)}catch(e){}}))})),[...t].reduce(((e,t)=>{const n=new ch({npub:t});return n.ndk=this.ndk,e.add(n),e}),new Set)}return new Set}var ch=class{ndk;profile;npub="";relayUrls=[];constructor(e){e.npub&&(this.npub=e.npub),e.hexpubkey&&(this.npub=Di.npubEncode(e.hexpubkey)),e.relayUrls&&(this.relayUrls=e.relayUrls)}static async fromNip05(e){const t=await as.queryProfile(e);if(t)return new ch({hexpubkey:t.pubkey,relayUrls:t.relays})}hexpubkey(){return Di.decode(this.npub).data}async fetchProfile(e){if(!this.ndk)throw new Error("NDK not set");this.profile||(this.profile={});const t=await this.ndk.fetchEvents({kinds:[0],authors:[this.hexpubkey()]},e);if(t){Array.from(t).sort(((e,t)=>e.created_at-t.created_at)).forEach((e=>{try{this.profile=function(e,t){const n=JSON.parse(e.content);return Object.keys(n).forEach((e=>{switch(e){case"name":t.name=n.name;break;case"display_name":case"displayName":t.displayName=n.displayName||n.display_name;break;case"image":case"picture":t.image=n.image||n.picture;break;case"banner":t.banner=n.banner;break;case"bio":t.bio=n.bio;break;case"nip05":t.nip05=n.nip05;break;case"lud06":t.lud06=n.lud06;break;case"lud16":t.lud16=n.lud16;break;case"about":t.about=n.about;break;case"zapService":t.zapService=n.zapService;break;case"website":t.website=n.website;break;default:t[e]=n[e]}})),t}(e,this.profile)}catch(e){}}))}return t}follows=ah.bind(this);async relayList(){if(!this.ndk)throw new Error("NDK not set");const e=await this.ndk.fetchEvents({kinds:[10002],authors:[this.hexpubkey()]});return e||new Set}tagReference(){return["p",this.hexpubkey()]}async publish(){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const e=new ph(this.ndk,{kind:0,content:JSON.stringify(this.profile)});await e.publish()}async follow(e,t){if(!this.ndk)throw new Error("No NDK instance found");if(this.ndk.assertSigner(),t||(t=await this.follows()),t.has(e))return!1;t.add(e);const n=new ph(this.ndk,{kind:3});for(const e of t)n.tag(e);return await n.publish(),!0}};async function uh(e,t){if(!t){if(!this.ndk)throw new Error("No signer available");await this.ndk.assertSigner(),t=this.ndk.signer}if(!e){const t=this.getMatchingTags("p");if(1!==t.length)throw new Error("No recipient could be determined and no explicit recipient was provided");(e=new ch({hexpubkey:t[0][1]})).ndk=this.ndk}this.content=await t.encrypt(e,this.content)}async function lh(e,t){if(!t){if(!this.ndk)throw new Error("No signer available");await this.ndk.assertSigner(),t=this.ndk.signer}e||(e=this.author),this.content=await t.decrypt(e,this.content)}function hh(){return this.isParamReplaceable()?Di.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag()}):Di.noteEncode(this.tagId())}async function fh(e=!0,t){if(!t){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),t=this.ndk.signer}if(!t)throw new Error("No signer available");const n=await t.user(),r=new ph(this.ndk,{kind:dh(this),content:"",pubkey:n.hexpubkey()});return r.tag(this),16===r.kind&&r.tags.push(["k",`${this.kind}`]),await r.sign(t),e&&await r.publish(),r}function dh(e){return 1===e.kind?6:16}var ph=class extends Da{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";relay;constructor(e,t){super(),this.created_at=t?.created_at,this.content=t?.content||"",this.tags=t?.tags||[],this.id=t?.id||"",this.sig=t?.sig,this.pubkey=t?.pubkey||"",this.kind=t?.kind}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(e){this.pubkey=e.hexpubkey()}get author(){const e=new ch({hexpubkey:this.pubkey});return e.ndk=this.ndk,e}tag(e,t){const n=e.tagReference();if(t&&n.push(t),this.tags.push(n),e instanceof ph){const t=e.author;t&&this.pubkey!==t.hexpubkey()&&this.tag(t);for(const t of e.getMatchingTags("p"))t[1]!==this.pubkey&&(this.tags.find((e=>"p"===e[0]&&e[1]===t[1]))||this.tags.push(["p",t[1]]))}}async toNostrEvent(e){if(!e&&""===this.pubkey){const e=await(this.ndk?.signer?.user());this.pubkey=e?.hexpubkey()||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const t=this.rawEvent(),{content:n,tags:r}=this.generateTags();t.content=n||"",t.tags=r;try{this.id=Ci(t)}catch(e){}return this.id&&(t.id=this.id),this.sig&&(t.sig=this.sig),t}isReplaceable=ih.bind(this);isParamReplaceable=sh.bind(this);encode=hh.bind(this);encrypt=uh.bind(this);decrypt=lh.bind(this);getMatchingTags(e){return this.tags.filter((t=>t[0]===e))}tagValue(e){const t=this.getMatchingTags(e);if(0!==t.length)return t[0][1]}removeTag(e){this.tags=this.tags.filter((t=>t[0]!==e))}async sign(e){e||this.ndk?.assertSigner(),await this.generateTags(),this.isReplaceable()&&(this.created_at=Math.floor(Date.now()/1e3));const t=await this.toNostrEvent(),n=e||this.ndk?.signer;this.sig=await n.sign(t)}async publish(e){return this.sig||await this.sign(),this.ndk?.publish(this,e)}generateTags(){let e=[];const t=function(e,t=[]){return{content:e=e.replace(/(@|nostr:)(npub|nprofile|note|nevent)[a-zA-Z0-9]+/g,(e=>{try{const n=e.split(/(@|nostr:)/)[2],{type:r,data:o}=Di.decode(n);let i;switch(r){case"npub":i=["p",o];break;case"nprofile":i=["p",o.pubkey];break;case"nevent":i=["e",o.id];break;case"note":i=["e",o];break;default:return e}return t.find((e=>e[0]===i[0]&&e[1]===i[1]))||t.push(i),`nostr:${n}`}catch(t){return e}})),tags:t}}(this.content,this.tags),n=t.content;if(e=t.tags,this.kind&&this.kind>=3e4&&this.kind<=4e4){if(!this.getMatchingTags("d")[0]){const t=[...Array(16)].map((()=>Math.random().toString(36)[2])).join("");e.push(["d",t])}}return{content:n||"",tags:e}}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const e=this.getMatchingTags("d")[0];return e?e[1]:""}throw new Error("Event is not a parameterized replaceable event")}tagId(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const e=this.replaceableDTag();return`${this.kind}:${this.pubkey}:${e}`}return this.id}tagReference(){return this.isParamReplaceable()?["a",this.tagId()]:["e",this.tagId()]}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}async zap(e,t,n){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const r=new oh({ndk:this.ndk,zappedEvent:this});return await r.createZapRequest(e,t,n)}async delete(e){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const t=new ph(this.ndk,{kind:5,content:e||""});return t.tag(this),await t.publish(),t}repost=fh.bind(this)},yh=class extends Da{url;scores;relay;_status;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};complaining=!1;debug;activeSubscriptions=new Set;constructor(e){super(),this.url=e,this.relay=Fi(e),this.scores=new Map,this._status=3,this.debug=qa(`ndk:relay:${e}`),this.relay.on("connect",(()=>{this.updateConnectionStats.connected(),this.emit("connect"),this._status=1})),this.relay.on("disconnect",(()=>{this.updateConnectionStats.disconnected(),this.emit("disconnect"),1===this._status&&(this._status=3,this.handleReconnection())})),this.relay.on("notice",(e=>this.handleNotice(e)))}isFlapping(){const e=this._connectionStats.durations;if(e.length<10)return!1;const t=e.reduce(((e,t)=>e+t),0)/e.length,n=e.map((e=>Math.pow(e-t,2))).reduce(((e,t)=>e+t),0)/e.length;return Math.sqrt(n)<1e3}handleReconnection(){this.isFlapping()&&(this.emit("flapping",this,this._connectionStats),this._status=5),this.connectedAt&&Date.now()-this.connectedAt<5e3?setTimeout((()=>this.connect()),6e4):this.connect()}get status(){return this._status}async connect(){try{this.updateConnectionStats.attempt(),this._status=0,await this.relay.connect()}catch(e){throw this.debug("Failed to connect",e),this._status=3,e}}disconnect(){this._status=2,this.relay.close()}async handleNotice(e){(e.includes("oo many")||e.includes("aximum"))&&(this.disconnect(),setTimeout((()=>this.connect()),2e3),console.log(this.relay.url,"Relay complaining?",e)),this.emit("notice",this,e)}subscribe(e){const{filter:t}=e,n=this.relay.sub([t],{id:e.subId});this.debug(`Subscribed to ${JSON.stringify(t)}`),n.on("event",(t=>{const n=new ph(void 0,t);n.relay=this,e.eventReceived(n,this)})),n.on("eose",(()=>{e.eoseReceived(this)}));const r=n.unsub;return n.unsub=()=>{this.debug(`Unsubscribing from ${JSON.stringify(t)}`),this.activeSubscriptions.delete(e),r()},this.activeSubscriptions.add(e),e.on("close",(()=>{this.activeSubscriptions.delete(e)})),n}async publish(e){const t=await e.toNostrEvent(),n=this.relay.publish(t);n.on("failed",(t=>{this.debug("Publish failed",t,e.rawEvent())})),n.on("ok",(()=>{this.debug("Publish ok",e.rawEvent())})),this.debug(`Published event ${e.id}`,e.rawEvent())}scoreSlowerEvent(e){}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++}};get connectionStats(){return this._connectionStats}},gh=class extends Da{relays=new Map;debug;constructor(e=[],t){super(),this.debug=t.debug.extend("pool");for(const t of e){const e=new yh(t);e.on("notice",((e,t)=>this.emit("notice",e,t))),e.on("connect",(()=>this.handleRelayConnect(t))),e.on("disconnect",(()=>this.emit("relay:disconnect",e))),e.on("flapping",(()=>this.handleFlapping(e))),this.relays.set(t,e)}}handleRelayConnect(e){this.debug(`Relay ${e} connected`),this.emit("relay:connect",this.relays.get(e)),this.stats().connected===this.relays.size&&this.emit("connect")}async connect(e){const t=[];this.debug(`Connecting to ${this.relays.size} relays${e?`, timeout ${e}...`:""}`);for(const n of this.relays.values())if(e){const r=new Promise(((t,n)=>{setTimeout((()=>n(`Timed out after ${e}ms`)),e)}));t.push(Promise.race([n.connect(),r]).catch((e=>{this.debug(`Failed to connect to relay ${n.url}: ${e}`)})))}else t.push(n.connect());await Promise.all(t)}handleFlapping(e){this.debug(`Relay ${e.url} is flapping`),this.relays.delete(e.url),this.emit("flapping",e)}size(){return this.relays.size}stats(){const e={total:0,connected:0,disconnected:0,connecting:0};for(const t of this.relays.values())e.total++,1===t.status?e.connected++:3===t.status?e.disconnected++:0===t.status&&e.connecting++;return e}urls(){return Array.from(this.relays.keys())}};var bh={closeOnEose:!0,cacheUsage:"CACHE_FIRST",groupable:!0,groupableDelay:100},wh=class extends Da{subId;filter;opts;relaySet;ndk;relaySubscriptions;debug;eventFirstSeen=new Map;eosesSeen=new Set;eventsPerRelay=new Map;constructor(e,t,n,r,o){if(super(),this.ndk=e,this.opts={...bh,...n||{}},this.subId=o||n?.subId||function(e){const t=Object.keys(e)||[],n=[];for(const r of t)if("kinds"===r){const t=[r,e.kinds.join(",")];n.push(t.join(":"))}else n.push(r);return n.push(Math.floor(999999999*Math.random()).toString()),n.join("-")}(t),this.filter=t,this.relaySet=r,this.relaySubscriptions=new Map,this.debug=e.debug.extend(`subscription:${this.subId}`),"ONLY_CACHE"===this.opts.cacheUsage&&!this.opts.closeOnEose)throw new Error("Cannot use cache-only options with a persistent subscription")}groupableId(){if(!this.opts?.groupable)return null;const e=(this.filter.kinds?.length||0)>0,t=!this.filter.since&&!this.filter.until,n=!this.filter.limit;if(e&&t&&n){let e=this.filter.kinds.join(",");return e+=`-${Object.keys(this.filter||{}).sort().join("-")}`,e}return null}shouldQueryCache(){return"ONLY_RELAY"!==this.opts?.cacheUsage}shouldQueryRelays(){return"ONLY_CACHE"!==this.opts?.cacheUsage}shouldWaitForCache(){return this.opts.closeOnEose&&!!this.ndk.cacheAdapter?.locking&&this.shouldQueryRelays()&&"PARALLEL"!==this.opts.cacheUsage}async start(){let e;if(this.shouldQueryCache()&&(e=this.startWithCache(),this.shouldWaitForCache()&&(await e,(t=this).filter.ids&&function(e){const t=e.filter.ids;return!!t&&t.length===e.eventFirstSeen.size}(t))))return this.debug("cache hit, fully filled: skipping relay query"),void this.emit("eose",this);var t;this.shouldQueryRelays()&&this.startWithRelaySet()}stop(){this.relaySubscriptions.forEach((e=>e.unsub())),this.relaySubscriptions.clear(),this.emit("close",this)}async startWithCache(){if(this.ndk.cacheAdapter?.query){const e=this.ndk.cacheAdapter.query(this);this.ndk.cacheAdapter.locking&&await e}}startWithRelaySet(){this.relaySet||(this.relaySet=function(e,t){const n=new Set;return e.pool?.relays.forEach((t=>{t.complaining?e.debug(`Relay ${t.url} is complaining, not adding to set`):n.add(t)})),new mh(n,e)}(this.ndk,this.filter)),this.relaySet&&this.relaySet.subscribe(this)}eventReceived(e,t,n=!1){if(!n&&t){let n=this.eventsPerRelay.get(t);n||(n=new Set,this.eventsPerRelay.set(t,n)),n.add(e.id);if(this.eventFirstSeen.has(e.id)){const n=Date.now()-(this.eventFirstSeen.get(e.id)||0);return t.scoreSlowerEvent(n),void this.emit("event:dup",e,t,n,this)}this.ndk.cacheAdapter&&this.ndk.cacheAdapter.setEvent(e,this.filter),this.eventFirstSeen.set(`${e.id}`,Date.now())}else this.eventFirstSeen.set(`${e.id}`,0);this.emit("event",e,t,this)}eoseTimeout;eoseReceived(e){this.opts?.closeOnEose&&(this.relaySubscriptions.get(e)?.unsub(),this.relaySubscriptions.delete(e),0===this.relaySubscriptions.size&&this.emit("close",this)),this.eosesSeen.add(e);this.eosesSeen.size===this.relaySet?.size()?this.emit("eose"):(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.eoseTimeout=setTimeout((()=>{this.emit("eose")}),500))}},vh=class extends wh{subscriptions;constructor(e,t){const n=e.debug.extend("subscription-group");super(e,function(e){const t={};return e.forEach((e=>{Object.entries(e).forEach((([e,n])=>{Array.isArray(n)?void 0===t[e]?t[e]=[...n]:t[e]=Array.from(new Set([...t[e],...n])):t[e]=n}))})),t}(t.map((e=>e.filter))),t[0].opts,t[0].relaySet),this.subscriptions=t,n("merged filters",{count:t.length,mergedFilters:this.filter}),this.on("event",this.forwardEvent),this.on("event:dup",this.forwardEventDup),this.on("eose",this.forwardEose),this.on("close",this.forwardClose)}isEventForSubscription(e,t){const{filter:n}=t;return!!n&&Bi(n,e.rawEvent())}forwardEvent(e,t){for(const n of this.subscriptions)this.isEventForSubscription(e,n)&&n.emit("event",e,t,n)}forwardEventDup(e,t,n){for(const r of this.subscriptions)this.isEventForSubscription(e,r)&&r.emit("event:dup",e,t,n,r)}forwardEose(){for(const e of this.subscriptions)e.emit("eose",e)}forwardClose(){for(const e of this.subscriptions)e.emit("close",e)}};var mh=class{relays;debug;ndk;constructor(e,t){this.relays=e,this.ndk=t,this.debug=t.debug.extend("relayset")}static fromRelayUrls(e,t){const n=new Set;for(const r of e){const e=t.pool.relays.get(r);e&&n.add(e)}return new mh(new Set(n),t)}subscribeOnRelay(e,t){const n=e.subscribe(t);t.relaySubscriptions.set(e,n)}getId(){const e=Array.from(this.relays).map((e=>e.url)).sort().join(",");return bo(Wo(e))}subscribe(e){const t=e.groupableId(),n=`${this.getId()}:${t}`;if(!t)return this.executeSubscription(e),e;const r=this.ndk.delayedSubscriptions.get(n);return r?r.push(e):(setTimeout((()=>{this.executeDelayedSubscription(n)}),e.opts.groupableDelay),this.ndk.delayedSubscriptions.set(n,[e])),e}executeDelayedSubscription(e){const t=this.ndk.delayedSubscriptions.get(e);this.ndk.delayedSubscriptions.delete(e),t&&(t.length>1?this.executeSubscriptions(t):this.executeSubscription(t[0]))}executeSubscriptions(e){const t=e[0].ndk,n=new vh(t,e);this.executeSubscription(n)}executeSubscription(e){this.debug("subscribing",{filter:e.filter});for(const t of this.relays)if(1===t.status)this.subscribeOnRelay(t,e);else{const n=()=>{this.debug("new relay coming online for active subscription",{relay:t.url,filter:e.filter}),this.subscribeOnRelay(t,e)};t.once("connect",n),e.once("close",(()=>{t.removeListener("connect",n)}))}return e}async publish(e){this.relays.forEach((async t=>{try{await t.publish(e)}catch(e){}}))}size(){return this.relays.size}};var _h=class extends Da{pool;signer;cacheAdapter;debug;devWriteRelaySet;delayedSubscriptions;constructor(e={}){super(),this.debug=e.debug||qa("ndk"),this.pool=new gh(e.explicitRelayUrls||[],this),this.signer=e.signer,this.cacheAdapter=e.cacheAdapter,this.delayedSubscriptions=new Map,e.devWriteRelayUrls&&(this.devWriteRelaySet=mh.fromRelayUrls(e.devWriteRelayUrls,this))}toJSON(){return{relayCount:this.pool.relays.size}.toString()}async connect(e){return this.debug("Connecting to relays",{timeoutMs:e}),this.pool.connect(e)}getUser(e){const t=new ch(e);return t.ndk=this,t}subscribe(e,t,n,r=!0){const o=new wh(this,e,t,n);return r&&o.start(),o}async publish(e,t){return t||(t=this.devWriteRelaySet||function(e,t){const n=new Set;return e.pool?.relays.forEach((e=>n.add(e))),new mh(n,e)}(this)),t.publish(e)}async fetchEvent(e,t={},n){let r;if(r="string"==typeof e?function(e){let t;try{switch(t=Di.decode(e),t.type){case"nevent":return{ids:[t.data.id]};case"note":return{ids:[t.data]};case"naddr":return{authors:[t.data.pubkey],"#d":[t.data.identifier],kinds:[t.data.kind]}}}catch(e){}return{ids:[e]}}(e):e,!r)throw new Error(`Invalid filter: ${JSON.stringify(e)}`);return new Promise((e=>{const o=this.subscribe(r,{...t,closeOnEose:!0},n,!1);o.on("event",(t=>{t.ndk=this,e(t)})),o.on("eose",(()=>{e(null)})),o.start()}))}async fetchEvents(e,t={},n){return new Promise((r=>{const o=new Map,i=this.subscribe(e,{...t,closeOnEose:!0},n,!1);i.on("event",(e=>{const t=o.get(e.tagId());var n,r;t&&(r=e,e=(n=t).created_at>r.created_at?n:r),e.ndk=this,o.set(e.tagId(),e)})),i.on("eose",(()=>{r(new Set(o.values()))})),i.start()}))}async assertSigner(){if(!this.signer)throw this.emit("signerRequired"),new Error("Signer required")}};new qa("nostr:adapter");const xh=new qa("nostr:adapter:profiles"),Eh=new qa("nostr:adapter:write");class kh{relayStatus={};#e=null;#t={};#n=new ea;#r={};tags;referenceTags;type;#o;chatId;relayUrls=[];#i=[];#s=[];#a;#c={};#u={};constructor(e,{tags:t,referenceTags:n,type:r="DM",chatId:o,websiteOwnerPubkey:i,relays:s}={}){this.pubkey=e,this.#o=i,this.relayUrls=s,r&&this.setChatConfiguration(r,t,n,o)}setChatConfiguration(e,t,n,r){this.type=e,this.tags=t,this.chatId=r,this.referenceTags=n,this.#e&&this.#l();let o=[];switch(this.type){case"DM":o.push({kinds:[4],"#p":[this.pubkey,this.#o],authors:[this.pubkey,this.#o]});break;case"GROUP":this.chatId&&o.push({kinds:[41,42],"#e":[this.chatId],limit:200});case"GLOBAL":this.tags&&this.tags.length>0&&o.push({kinds:[1],"#t":this.tags,limit:20}),this.referenceTags&&this.referenceTags.length>0&&o.push({kinds:[1],"#r":this.referenceTags,limit:20})}o&&o.length>0&&(this.#h(),this.subscribe(o,(e=>{this.#f(e)})))}async getPubKey(){return this.pubkey}on(e,t){this.#n.on(e,t)}async send(e,{tagPubKeys:t,tags:n}={}){let r;n||(n=[]),r="DM"===this.type?await this.sendKind4(e,{tagPubKeys:t,tags:n}):"GROUP"===this.type?await this.sendKind42(e,{tagPubKeys:t,tags:n,chatId:this.chatId}):await this.sendKind1(e,{tagPubKeys:t,tags:n}),r.id=Ci(r);const o=await this.signEvent(r);return this.#d(o),r.id}async sendKind4(e,{tagPubKeys:t,tags:n}={}){let r=await this.encrypt(this.#o,e);return{kind:4,pubkey:this.pubkey,created_at:Math.floor(Date.now()/1e3),content:r,tags:[["p",this.#o],...n]}}async sendKind42(e,{tagPubKeys:t,tags:n,chatId:r}={}){n||(n=[]),this.tags&&this.tags.forEach((e=>n.push(["t",e])));const o=!!n.find((e=>"e"===e[0]));o||n.push(["e",r,"wss://nos.lol",o?"reply":"root"]),this.referenceTags&&this.referenceTags.forEach((e=>n.push(["r",e])));let i={kind:42,created_at:Math.floor(Date.now()/1e3),tags:n,content:e,pubkey:this.pubkey};if(t)for(let e of t)e&&i.tags.push(["p",e]);return i.id=Ci(i),this.subscribeToEventAndResponses(i.id),i}async sendKind1(e,{tagPubKeys:t,tags:n}={}){n||(n=[]),this.tags&&this.tags.forEach((e=>n.push(["t",e]))),this.referenceTags&&this.referenceTags.forEach((e=>n.push(["r",e])));let r={kind:1,created_at:Math.floor(Date.now()/1e3),tags:n,content:e,pubkey:this.pubkey};if(t)for(let e of t)e&&r.tags.push(["p",e]);return r.id=Ci(r),this.subscribeToEventAndResponses(r.id),r}async#d(e){Eh("publish",e),this.#e.send(["EVENT",e])}async onEvent(e,t){this.#p(e.pubkey),t(e)}async delayedSubscribe(e,t,n){this.#c[t]=this.#c[t]||[],this.#c[t].push(e),this.#u[t]||(this.#u[t]=setTimeout((()=>{delete this.#u[t];let e=this.#c[t];delete this.#c[t];let n=[];n=e.reduce(((e,t,n)=>(n%10==0&&e.push([]),e[e.length-1].push(t),e)),n),n.forEach((e=>{this.subscribe(e,(e=>{this.#f(e)}))}))}),n))}async subscribe(e,t=null){return t||(t=e=>{this.#f(e)}),this.#y(e,t)}async#y(e,t){const n=ha();return this.#r[n]=t,Array.isArray(e)||(e=[e]),this.#e.subscribe(n,e),this.#e.on("event",((e,t,n)=>{this.onEvent(n,this.#r[t])})),n}async#f(e){if(this.#t[e.id])return;this.#t[e.id]=!0,4===e.kind&&(e.content=await this.decrypt(this.#o,e.content));let t,n=[];if(5===e.kind&&(n=e.tags.filter((e=>"e"===e[0])).map((e=>e[1]))),9735===e.kind){t=function(e){const t=e.getMatchingTags("description")[0],n=e.getMatchingTags("bolt11")[0];let r,o;if(!t||!n||!n[1])return null;try{let e=t[1];if(e.startsWith("%")&&(e=decodeURIComponent(e)),""===e)return null;o=JSON.parse(e),r=nh.decode(n[1])}catch(e){return null}const i=r.sections.find((e=>"amount"===e.name));if(!i)return null;const s=parseInt(i.value);if(!s)return null;const a=o.content,c=o.pubkey,u=e.getMatchingTags("p")[0][1];let l=e.getMatchingTags("e")[0];l||(l=e.getMatchingTags("a")[0]);const h=l?l[1]:void 0;return{id:e.id,zapper:e.pubkey,zappee:c,zapped:u,zappedEvent:h,amount:s,comment:a}}(new ph(null,e)),console.log(`received a zap invoice: ${t}`,e)}switch(e.kind){case 1:case 42:case 4:this.#n.emit("message",e);break;case 41:this.#n.emit("channelMetadata",e);break;case 5:this.#n.emit("deleted",n);break;case 7:this.#n.emit("reaction",e);break;case 9735:this.#n.emit("zap",t);break;default:console.log("unknown event kind",e.kind,e)}}subscribeToEventAndResponses(e){this.subscribe([{ids:[e]},{"#e":[e]}],(e=>{this.#f(e)}))}subscribeToResponses(e){this.subscribe([{"#e":[e.id]}],(e=>{this.#f(e),this.subscribeToResponses(e)}))}#h(){this.relayUrls.forEach((e=>{this.relayStatus[e]="disconnected"})),this.#n.emit("connectivity",this.relayStatus),this.#e=new Qs(this.relayUrls),this.#e.on("open",(e=>{this.relayStatus[e.url]="connected",this.#n.emit("connectivity",this.relayStatus)})),this.#e.on("error",((e,t,n)=>{this.relayStatus[e.url]="error",this.#n.emit("connectivity",this.relayStatus),console.log("error from relay",e.url,t,n)})),this.#e.on("close",((e,t)=>{this.relayStatus[e.url]="closed",this.#n.emit("connectivity",this.relayStatus),console.log("error from relay",e.url,t)})),this.#e.on("notice",((e,t)=>{console.log("notice",e.url,t)}))}#l(){this.relayUrls.forEach((e=>{this.relayStatus[e]="disconnected"})),this.#n.emit("connectivity",this.relayStatus),this.#e.close(),this.#e=null}reqProfile(e){this.#p(e)}#p(e,t=null){this.#i.includes(e)||this.#s.includes(e)||(this.#i.push(e),this.#s.push(e),this.#a||(this.#a=setTimeout((()=>{this.#a=null,this.#g()}),500)))}async#g(){if(this.#i.length>0){xh("requesting profiles",this.#i);const e=await this.subscribe({kinds:[0],authors:this.#i},(e=>{this.#b(e)}));xh("subscribed to request",{subId:e}),this.#i=[],setTimeout((()=>{xh("unsubscribing from request",{subId:e}),this.#e.unsubscribe(e)}),5e3)}}#b(e){let t;xh("received profile",e);try{t=JSON.parse(e.content)}catch(t){return void xh("failed to parse profile",e)}this.#n.emit("profile",{pubkey:e.pubkey,profile:t})}}class Sh extends kh{constructor(e,t={}){super(e,t)}async signEvent(e){return await window.nostr.signEvent(e)}async encrypt(e,t){return await window.nostr.nip04.encrypt(e,t)}async decrypt(e,t){return await window.nostr.nip04.decrypt(e,t)}}function Ah(){Ah=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var i=t&&t.prototype instanceof f?t:f,s=Object.create(i.prototype),a=new S(o||[]);return r(s,"_invoke",{value:_(e,n,a)}),s}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h={};function f(){}function d(){}function p(){}var y={};c(y,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(A([])));b&&b!==t&&n.call(b,i)&&(y=b);var w=p.prototype=f.prototype=Object.create(y);function v(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function m(e,t){function o(r,i,s,a){var c=l(e[r],e,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){o("next",e,s,a)}),(function(e){o("throw",e,s,a)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return o("throw",e,s,a)}))}a(c.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function _(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return O()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=x(s,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=l(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return d.prototype=p,r(w,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:d,configurable:!0}),d.displayName=c(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,a,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},v(m.prototype),c(m.prototype,s,(function(){return this})),e.AsyncIterator=m,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new m(u(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},v(w),c(w,a,"Generator"),c(w,i,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=A,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function Oh(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function Ch(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){Oh(i,r,o,s,a,"next",e)}function a(e){Oh(i,r,o,s,a,"throw",e)}s(void 0)}))}}function Ph(){return Ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ph.apply(this,arguments)}var Ih,Lh,jh=function(){function e(e){this.events=new ea,this.relay=e.relay||"wss://nostr.vulpem.com",this.self={pubkey:vi(e.secretKey),secret:e.secretKey}}var t=e.prototype;return t.call=function(){var e=Ch(Ah().mark((function e(t,n){var r,o,i,s,a,c,u,l,h,f,d=this;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.target,o=t.request,i=o.id,s=void 0===i?Bh():i,a=o.method,c=o.params,u=void 0===c?[]:c,e.next=3,Mh(this.relay);case 3:return l=e.sent,h=Rh(s,a,u),e.next=7,$h(this.self.secret,r,h);case 7:return f=e.sent,e.abrupt("return",new Promise(function(){var e=Ch(Ah().mark((function e(t,o){var i;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.sub([{kinds:[24133],authors:[r],"#p":[d.self.pubkey],limit:1}]),e.next=3,Fh(l,f,!0);case 3:n&&!0===n.skipResponse&&t(),i.on("event",function(){var e=Ch(Ah().mark((function e(n){var r,i;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rs.decrypt(d.self.secret,n.pubkey,n.content);case 3:if(i=e.sent){e.next=6;break}throw new Error("failed to decrypt event");case 6:r=JSON.parse(i),e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return");case 12:if(Hh(r)){e.next=14;break}return e.abrupt("return");case 14:if(r.id===s){e.next=16;break}return e.abrupt("return");case 16:r.error&&o(r.error),r.result&&t(r.result);case 18:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.listen=function(){var e=Ch(Ah().mark((function e(){var t,n,r=this;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mh(this.relay);case 2:return t=e.sent,(n=t.sub([{kinds:[24133],"#p":[this.self.pubkey],since:Th()}])).on("event",function(){var e=Ch(Ah().mark((function e(n){var o,i,s,a,c;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rs.decrypt(r.self.secret,n.pubkey,n.content);case 3:if(i=e.sent){e.next=6;break}throw new Error("failed to decrypt event");case 6:o=JSON.parse(i),e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return");case 12:if(Nh(o)){e.next=14;break}return e.abrupt("return");case 14:return e.next=17,r.handleRequest(o,n);case 17:return s=e.sent,u=s.id,l=s.result,h=s.error,a=JSON.stringify({id:u,result:l,error:h}),e.next=21,$h(r.self.secret,n.pubkey,a);case 21:c=e.sent,t.publish(c);case 23:case"end":return e.stop()}var u,l,h}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.handleRequest=function(){var e=Ch(Ah().mark((function e(t,n){var r,o,i,s,a;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,o=t.method,i=t.params,s=null,a=null,e.prev=3,this.event=n,e.next=7,this[o].apply(this,i);case 7:s=e.sent,this.event=void 0,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),a=e.t0 instanceof Error?e.t0.message:"unknown error";case 14:return e.abrupt("return",{id:r,result:s,error:a});case 15:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(t,n){return e.apply(this,arguments)}}(),e}();function Th(){return Math.floor(Date.now()/1e3)}function Bh(){return Math.random().toString().slice(2)}function Rh(e,t,n){return JSON.stringify({id:e,method:t,params:n})}function $h(e,t,n){return Uh.apply(this,arguments)}function Uh(){return(Uh=Ch(Ah().mark((function e(t,n,r){var o,i,s,a,c,u,l;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rs.encrypt(t,n,r);case 2:if(o=e.sent,i={kind:24133,created_at:Th(),pubkey:vi(t),tags:[["p",n]],content:o,id:"",sig:""},s=Ci(i),a=ji(i,t),c=Ph({},i,{id:s,sig:a}),u=Ii(c),l=Li(c),u&&l){e.next=11;break}throw new Error("Event is not valid");case 11:return e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nh(e){if(!e)return!1;var t=Object.keys(e);return!!(t.includes("id")&&t.includes("method")&&t.includes("params"))}function Hh(e){if(!e)return!1;var t=Object.keys(e);return!!(t.includes("id")&&t.includes("result")&&t.includes("error"))}function Mh(e){return qh.apply(this,arguments)}function qh(){return qh=Ch(Ah().mark((function e(t){var n;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Fi(t),e.next=3,n.connect();case 3:return e.next=5,new Promise((function(e,t){n.on("connect",(function(){e()})),n.on("error",(function(){t(new Error("not possible to connect to "+n.url))}))}));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),qh.apply(this,arguments)}function Fh(e,t,n){return Dh.apply(this,arguments)}function Dh(){return Dh=Ch(Ah().mark((function e(t,n,r){return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=!1),e.next=3,new Promise((function(e,o){t.on("error",(function(){o(new Error("failed to connect to "+t.url))}));var i=t.publish(n);r&&e(),i.on("failed",(function(e){o(e)})),i.on("ok",(function(){e()}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Dh.apply(this,arguments)}!function(e){e.FIVE_MINS="5mins",e.ONE_HR="1hour",e.ONE_DAY="1day",e.ONE_WEEK="1week",e.ONE_MONTH="1month",e.ONE_YEAR="1year"}(Lh||(Lh={}));var zh=((Ih={})[Lh.FIVE_MINS]=Math.round(Date.now()/1e3)+300,Ih[Lh.ONE_HR]=Math.round(Date.now()/1e3)+3600,Ih[Lh.ONE_DAY]=Math.round(Date.now()/1e3)+86400,Ih[Lh.ONE_WEEK]=Math.round(Date.now()/1e3)+604800,Ih[Lh.ONE_MONTH]=Math.round(Date.now()/1e3)+2592e3,Ih[Lh.ONE_YEAR]=Math.round(Date.now()/1e3)+31536e3,Ih),Kh=function(){function e(e){var t=e.target,n=e.metadata,r=e.relay;this.target=t,this.metadata=n,this.relay=r}e.fromURI=function(t){var n=new URL(t),r=n.hostname||n.pathname.substring(2);if(!r)throw new Error("Invalid connect URI: missing target");var o=n.searchParams.get("relay");if(!o)throw new Error("Invalid connect URI: missing relay");var i=n.searchParams.get("metadata");if(!i)throw new Error("Invalid connect URI: missing metadata");try{return new e({target:r,metadata:JSON.parse(i),relay:o})}catch(e){throw new Error("Invalid connect URI: metadata is not valid JSON")}};var t=e.prototype;return t.toString=function(){return"nostrconnect://"+this.target+"?metadata="+encodeURIComponent(JSON.stringify(this.metadata))+"&relay="+encodeURIComponent(this.relay)},t.approve=function(){var e=Ch(Ah().mark((function e(t){var n;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new jh({relay:this.relay,secretKey:t}),e.next=3,n.call({target:this.target,request:{method:"connect",params:[vi(t)]}},{skipResponse:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.reject=function(){var e=Ch(Ah().mark((function e(t){var n;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new jh({relay:this.relay,secretKey:t}),e.next=3,n.call({target:this.target,request:{method:"disconnect",params:[]}},{skipResponse:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}(),Gh=function(){function e(e){var t,n,r=e.target,o=e.relay,i=e.secretKey;this.events=new ea,this.nip04={encrypt:(n=Ch(Ah().mark((function e(t,n){return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)}),decrypt:(t=Ch(Ah().mark((function e(t,n){return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented");case 1:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},this.rpc=new jh({relay:o,secretKey:i}),r&&(this.target=r)}var t=e.prototype;return t.init=function(){var e=Ch(Ah().mark((function e(){var t=this;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rpc.listen();case 2:e.sent.on("event",function(){var e=Ch(Ah().mark((function e(n){var r,o,i,s;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rs.decrypt(t.rpc.self.secret,n.pubkey,n.content);case 3:if(o=e.sent){e.next=6;break}throw new Error("failed to decrypt event");case 6:r=JSON.parse(o),e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return");case 12:if(Nh(r)){e.next=14;break}return e.abrupt("return");case 14:e.t1=r.method,e.next="connect"===e.t1?17:"disconnect"===e.t1?23:26;break;case 17:if(r.params&&1===r.params.length){e.next=19;break}throw new Error("connect: missing pubkey");case 19:return i=r.params,s=i[0],t.target=s,t.events.emit("connect",s),e.abrupt("break",26);case 23:return t.target=void 0,t.events.emit("disconnect"),e.abrupt("break",26);case 26:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.on=function(e,t){this.events.on(e,t)},t.off=function(e,t){this.events.off(e,t)},t.disconnect=function(){var e=Ch(Ah().mark((function e(){return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.target){e.next=2;break}throw new Error("Not connected");case 2:return this.events.emit("disconnect"),e.prev=3,e.next=6,this.rpc.call({target:this.target,request:{method:"disconnect",params:[]}},{skipResponse:!0});case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),new Error("Failed to disconnect");case 11:this.target=void 0;case 12:case"end":return e.stop()}}),e,this,[[3,8]])})));return function(){return e.apply(this,arguments)}}(),t.getPublicKey=function(){var e=Ch(Ah().mark((function e(){var t;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.target){e.next=2;break}throw new Error("Not connected");case 2:return e.next=4,this.rpc.call({target:this.target,request:{method:"get_public_key",params:[]}});case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.signEvent=function(){var e=Ch(Ah().mark((function e(t){var n;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.target){e.next=2;break}throw new Error("Not connected");case 2:return e.next=4,this.rpc.call({target:this.target,request:{method:"sign_event",params:[t]}});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.describe=function(){var e=Ch(Ah().mark((function e(){var t;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.target){e.next=2;break}throw new Error("Not connected");case 2:return e.next=4,this.rpc.call({target:this.target,request:{method:"describe",params:[]}});case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.delegate=function(){var e=Ch(Ah().mark((function e(t,n){var r;return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=this.rpc.self.pubkey),this.target){e.next=3;break}throw new Error("Not connected");case 3:if(!n.until||"number"==typeof n.until){e.next=7;break}if(Object.keys(zh).includes(n.until)){e.next=6;break}throw new Error("conditions.until must be either a number or a valid TimeRange");case 6:n.until=zh[n.until];case 7:if(!n.since||"number"==typeof n.since){e.next=11;break}if(Object.keys(zh).includes(n.since)){e.next=10;break}throw new Error("conditions.since must be either a number or a valid TimeRange");case 10:n.since=zh[n.since];case 11:return e.next=13,this.rpc.call({target:this.target,request:{method:"delegate",params:[t,n]}});case 13:return r=e.sent,e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.getRelays=function(){var e=Ch(Ah().mark((function e(){return Ah().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e}();class Wh extends kh{#w=null;constructor(e,t,n={}){super(e,n),this.#w=t}async signEvent(e){const t=new Gh({secretKey:this.#w,target:this.pubkey});return await t.init(),e.sig=await t.signEvent("12323423434"),e}}class Vh extends kh{#v;constructor(e={}){let t=localStorage.getItem("nostrichat-discardable-key"),n=localStorage.getItem("nostrichat-discardable-public-key");t||(t=wi(),console.log("generated key",t),n=vi(t)),localStorage.setItem("nostrichat-discardable-key",t),localStorage.setItem("nostrichat-discardable-public-key",n),super(n,e),this.#v=t,console.log(t)}async signEvent(e){return e.sig=await ji(e,this.#v),e}async encrypt(e,t){return console.log(this.#v),await rs.encrypt(this.#v,e,t)}async decrypt(e,t){return await rs.decrypt(this.#v,e,t)}}function Yh(t){let n,o,i,s,a,c,u,l,h=function(t){let n,r,o;return{c(){n=_("button"),n.textContent="Browser Extension (NIP-07)",C(n,"class","bg-purple-800 hover:bg-purple-700 w-full p-4 rounded-xl text-center font-regular text-gray-200 svelte-cpjycc")},m(e,i){w(e,n,i),r||(o=A(n,"click",O(t[4])),r=!0)},p:e,d(e){e&&v(n),r=!1,o()}}}(t),f=t[3]&&Jh(t);return{c(){n=_("div"),h&&h.c(),o=k(),i=_("button"),i.textContent="Nostr Connect (NIP-46)",s=k(),a=_("button"),a.innerHTML='Anonymous\n        <span class="text-xs text-gray-300 svelte-cpjycc">(Ephemeral Keys)</span>',c=k(),f&&f.c(),C(i,"class","bg-purple-800 hover:bg-purple-700 w-full p-4 rounded-xl text-center font-regular text-gray-200 svelte-cpjycc"),C(a,"class","bg-purple-800 hover:bg-purple-700 w-full p-4 rounded-xl text-center font-regular text-gray-200 svelte-cpjycc"),C(n,"class","flex flex-col gap-1 svelte-cpjycc")},m(e,r){w(e,n,r),h&&h.m(n,null),b(n,o),b(n,i),b(n,s),b(n,a),b(n,c),f&&f.m(n,null),u||(l=[A(i,"click",O(t[7])),A(a,"click",O(t[6]))],u=!0)},p(e,t){e[3]?f?f.p(e,t):(f=Jh(e),f.c(),f.m(n,null)):f&&(f.d(1),f=null)},d(e){e&&v(n),h&&h.d(),f&&f.d(),u=!1,r(l)}}}function Zh(t){let n,o,i,s,a,c,u;return{c(){n=_("p"),n.textContent="Scan this with your Nostr Connect (click to copy to clipboard)",o=k(),i=_("div"),i.innerHTML="",s=k(),a=_("button"),a.textContent="Cancel",C(n,"class","text-gray-600 mb-3 svelte-cpjycc"),C(i,"class","bg-white w-full p-3 svelte-cpjycc"),C(a,"class","bg-purple-800 hover:bg-purple-700 w-full p-2 rounded-xl text-center font-regular text-white svelte-cpjycc")},m(e,r){w(e,n,r),w(e,o,r),w(e,i,r),w(e,s,r),w(e,a,r),c||(u=[A(i,"click",O(t[8])),A(a,"click",O(t[15]))],c=!0)},p:e,d(e){e&&(v(n),v(o),v(i),v(s),v(a)),c=!1,r(u)}}}function Jh(e){let t,n,r,o,i,s=1==e[2]&&Qh(e);return{c(){t=_("button"),t.textContent="View Advanced",n=k(),s&&s.c(),r=S(),C(t,"class","text-purple-700 my-4 hover:underline text-xs svelte-cpjycc")},m(a,c){w(a,t,c),w(a,n,c),s&&s.m(a,c),w(a,r,c),o||(i=A(t,"click",e[16]),o=!0)},p(e,t){1==e[2]?s?s.p(e,t):(s=Qh(e),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(e){e&&(v(t),v(n),v(r)),s&&s.d(e),o=!1,i()}}}function Qh(t){let n,r,o;return{c(){n=_("button"),n.textContent="Reset Anonymous Keys",C(n,"class","bg-red-700 hover:bg-red-600 w-full p-4 rounded-xl text-center font-regular text-gray-200 svelte-cpjycc")},m(e,i){w(e,n,i),r||(o=A(n,"click",O(t[5])),r=!0)},p:e,d(e){e&&v(n),r=!1,o()}}}function Xh(t){let n,r,i,s,a,c,u,l,h;function f(e,t){return e[1]?Zh:Yh}let d=f(t),p=d&&d(t);return{c(){n=_("div"),r=_("h3"),r.textContent="How whould you like to connect?",i=k(),s=_("button"),s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 svelte-cpjycc" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="--darkreader-inline-stroke: currentColor;" data-darkreader-inline-stroke=""><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-cpjycc"></path></svg>',a=k(),c=_("div"),u=k(),p&&p.c(),C(r,"class","m-0 text-lg svelte-cpjycc"),C(s,"id","close-popup"),C(s,"class","bg-transparent border-none text-white cursor-pointer svelte-cpjycc"),C(n,"class","flex justify-between items-center p-4 bg-purple-700 text-white md:rounded-t-md svelte-cpjycc"),C(c,"class","flex-1 p-4 overflow-y-auto svelte-cpjycc")},m(e,f){w(e,n,f),b(n,r),b(n,i),b(n,s),w(e,a,f),w(e,c,f),b(c,u),p&&p.m(c,null),l||(h=A(s,"click",(function(){o(t[0])&&t[0].apply(this,arguments)})),l=!0)},p(e,[n]){d===(d=f(t=e))&&p?p.p(t,n):(p&&p.d(1),p=d&&d(t),p&&(p.c(),p.m(c,null)))},i:e,o:e,d(e){e&&(v(n),v(a),v(c)),p&&p.d(),l=!1,h()}}}function ef(e,t,n){let r,o,{firstStartupDone:i}=t,{managedLogin:s}=t,{startPage:a}=t,{websiteOwnerPubkey:c}=t,{chatConfiguration:u}=t,{relays:l}=t,{toggleChat:h}=t;function f(){window.nostr.getPublicKey().then((e=>{localStorage.setItem("nostrichat-type","nip07"),ce.set(new Sh(e,o))}))}T((()=>{const e=localStorage.getItem("nostrichat-type");"nip07"===e?f():"nip-46"===e&&y(),o={type:u.chatType,tags:u.chatTags,referenceTags:u.chatReferenceTags,websiteOwnerPubkey:c,relays:l},"chat"===a?(i(),ce.set(new Vh(o))):s()}));let d=!1,p=!1;async function y(){let e=localStorage.getItem("nostrichat-nostr-connect-key"),t=localStorage.getItem("nostrichat-nostr-connect-public-key");if(e)return void ce.set(new Wh(t,e,o));e=wi();const i=new Gh({secretKey:e,relay:"wss://nostr.vulpem.com"});let s,a,c;i.events.on("connect",(o=>{localStorage.setItem("nostrichat-nostr-connect-key",e),localStorage.setItem("nostrichat-nostr-connect-public-key",o),localStorage.setItem("nostrichat-type","nip-46"),console.log("connected to nostr connect relay"),t=o,ce.set(new Wh(t,e)),n(1,r=null)})),i.events.on("disconnect",(()=>{console.log("disconnected from nostr connect relay")})),await i.init();try{s=window.document.title||"Nostrichat",a=new URL(window.location.href),c=a.hostname}catch(e){a=window.location.href,c=a}const u=new Kh({target:vi(e),relay:"wss://nostr.vulpem.com",metadata:{name:s,description:"",url:a}});n(1,r=u.toString())}(localStorage.getItem("nostrichat-discardable-key")||localStorage.getItem("nostrichat-discardable-public-key"))&&(p=!0);return e.$$set=e=>{"firstStartupDone"in e&&n(9,i=e.firstStartupDone),"managedLogin"in e&&n(10,s=e.managedLogin),"startPage"in e&&n(11,a=e.startPage),"websiteOwnerPubkey"in e&&n(12,c=e.websiteOwnerPubkey),"chatConfiguration"in e&&n(13,u=e.chatConfiguration),"relays"in e&&n(14,l=e.relays),"toggleChat"in e&&n(0,h=e.toggleChat)},[h,r,d,p,f,function(){localStorage.removeItem("nostrichat-discardable-key"),localStorage.removeItem("nostrichat-discardable-public-key"),n(3,p=!1)},async function(){ce.set(new Vh(o))},y,function(){navigator.clipboard.writeText(r)},i,s,a,c,u,l,()=>{n(1,r=null)},()=>n(2,d=!d)]}class tf extends ie{constructor(e){super(),oe(this,e,ef,Xh,i,{firstStartupDone:9,managedLogin:10,startPage:11,websiteOwnerPubkey:12,chatConfiguration:13,relays:14,toggleChat:0})}}var nf,rf={},of={},sf={},af=Jn&&Jn.__extends||(nf=function(e,t){return nf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},nf(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}nf(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function cf(e,t,n){if(Object.setPrototypeOf(e,n.prototype),t===n)if(e.name=t.name,Error.captureStackTrace)Error.captureStackTrace(e,n);else{var r=new Error(e.message).stack;r&&(e.stack=function(e,t){if(!e)return e;if(!t)return e;var n=new RegExp("\\s+at\\s".concat(t,"\\s")),r=e.split("\n");return r.filter((function(e){return!e.match(n)})).join("\n")}(r,"new ".concat(t.name)))}}Object.defineProperty(sf,"__esModule",{value:!0}),sf.InternalError=sf.InvalidDataError=sf.RoutingError=sf.UnsupportedMethodError=sf.ConnectionError=sf.RejectionError=sf.MissingProviderError=void 0;var uf=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.MissingProviderError=uf;var lf=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.RejectionError=lf;var hf=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.ConnectionError=hf;var ff=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.UnsupportedMethodError=ff;var df=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.RoutingError=df;var pf=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.InvalidDataError=pf;var yf=function(e){function t(n){var r=this.constructor,o=e.call(this,n)||this;return cf(o,r,t),o}return af(t,e),t}(Error);sf.InternalError=yf,Object.defineProperty(of,"__esModule",{value:!0}),of.requestProvider=void 0;var gf=sf;of.requestProvider=function(e){return new Promise((function(e,t){if("undefined"==typeof window)return t(new Error("Must be called in a browser context"));var n=window.webln;if(!n)return t(new gf.MissingProviderError("Your browser has no WebLN provider"));n.enable().then((function(){return e(n)})).catch((function(e){return t(e)}))}))};var bf,wf,vf,mf={};function _f(e){let t,n,r=(e[2]||e[1])+"";return{c(){t=_("span"),n=E(r),C(t,"class","text-base text-white flex flex-col items-center")},m(e,r){w(e,t,r),b(t,n)},p(e,t){6&t&&r!==(r=(e[2]||e[1])+"")&&P(n,r)},d(e){e&&v(t)}}}function xf(e){let t,n;return{c(){t=_("span"),n=E(e[0]),C(t,"class","text-xl")},m(e,r){w(e,t,r),b(t,n)},p(e,t){1&t&&P(n,e[0])},d(e){e&&v(t)}}}function Ef(t){let n,o,i;function s(e,t){return e[3]?_f:xf}let a=s(t),c=a(t);return{c(){n=_("div"),c.c()},m(e,r){w(e,n,r),c.m(n,null),o||(i=[A(n,"mouseenter",t[7]),A(n,"mouseleave",t[8]),A(n,"click",O(t[4]))],o=!0)},p(e,[t]){a===(a=s(e))&&c?c.p(e,t):(c.d(1),c=a(e),c&&(c.c(),c.m(n,null)))},i:e,o:e,d(e){e&&v(n),c.d(),o=!1,r(i)}}}function kf(e,t,n){let r;c(e,he,(e=>n(9,r=e)));let{icon:o,amount:i,amountDisplay:s,event:a,mobilePR:u}=t,h=!1;return e.$$set=e=>{"icon"in e&&n(0,o=e.icon),"amount"in e&&n(1,i=e.amount),"amountDisplay"in e&&n(2,s=e.amountDisplay),"event"in e&&n(6,a=e.event),"mobilePR"in e&&n(5,u=e.mobilePR)},[o,i,s,h,async function(){const e=new class{_userPromise;nip04Queue=[];nip04Processing=!1;debug;constructor(){if(!window.nostr)throw new Error("NIP-07 extension not available");this.debug=qa("ndk:nip07")}async blockUntilReady(){const e=await(window.nostr?.getPublicKey());if(!e)throw new Error("User rejected access");return new ch({hexpubkey:e})}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}async sign(e){if(!window.nostr)throw new Error("NIP-07 extension not available");return(await window.nostr.signEvent(e)).sig}async encrypt(e,t){if(!window.nostr)throw new Error("NIP-07 extension not available");const n=e.hexpubkey();return this.queueNip04("encrypt",n,t)}async decrypt(e,t){if(!window.nostr)throw new Error("NIP-07 extension not available");const n=e.hexpubkey();return this.queueNip04("decrypt",n,t)}async queueNip04(e,t,n){return new Promise(((r,o)=>{this.nip04Queue.push({type:e,counterpartyHexpubkey:t,value:n,resolve:r,reject:o}),this.nip04Processing||this.processNip04Queue()}))}async processNip04Queue(e,t=0){if(!e&&0===this.nip04Queue.length)return void(this.nip04Processing=!1);this.nip04Processing=!0;const{type:n,counterpartyHexpubkey:r,value:o,resolve:i,reject:s}=e||this.nip04Queue.shift();this.debug("Processing encryption queue item",{type:n,counterpartyHexpubkey:r,value:o});try{let e;e="encrypt"===n?await window.nostr.nip04.encrypt(r,o):await window.nostr.nip04.decrypt(r,o),i(e)}catch(i){if(i.message&&i.message.includes("call already executing")&&t<5)return this.debug("Retrying encryption queue item",{type:n,counterpartyHexpubkey:r,value:o,retries:t}),void setTimeout((()=>{this.processNip04Queue(e,t+1)}),50*t);s(i)}this.processNip04Queue()}},t=new _h({explicitRelayUrls:["wss://nos.lol","wss://relay.nostr.band","wss://relay.damus.io","wss://nostr.mom","wss://no.str.cr"]});let o,s;t.signer=e,await t.connect();try{const e=new ph(t,a);o=await e.zap(1e3*i)}catch(e){return void alert(e)}try{s=await rf.requestProvider()}catch(e){return void n(5,u=o)}try{await s.sendPayment(o),l(he,r=null,r)}catch(e){n(5,u=o)}},u,a,()=>n(3,h=!0),()=>n(3,h=!1)]}Object.defineProperty(mf,"__esModule",{value:!0}),bf=rf,wf=Jn&&Jn.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),vf=Jn&&Jn.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||wf(t,e,n)},Object.defineProperty(bf,"__esModule",{value:!0}),vf(of,bf),vf(mf,bf),vf(sf,bf);class Sf extends ie{constructor(e){super(),oe(this,e,kf,Ef,i,{icon:0,amount:1,amountDisplay:2,event:6,mobilePR:5})}}function Af(e,t,n){const r=e.slice();return r[32]=t[n],r}function Of(t){let n;return{c(){n=E("")},m(e,t){w(e,n,t)},p:e,d(e){e&&v(n)}}}function Cf(e){let t,n,r,o,i=e[9]/1e3+"";return{c(){t=_("p"),n=E("\n            "),r=_("span"),o=E(i),C(r,"class","text-orange-500 font-semibold svelte-cpjycc"),C(t,"class","flex flex-col items-center my-4 svelte-cpjycc")},m(e,i){w(e,t,i),b(t,n),b(t,r),b(r,o)},p(e,t){512&t[0]&&i!==(i=e[9]/1e3+"")&&P(o,i)},d(e){e&&v(t)}}}function Pf(e){let t,n,r,o;const i=[Lf,If],s=[];function a(e,t){return e[8]?0:1}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),r=S()},m(e,n){s[t].m(e,n),w(e,r,n),o=!0},p(e,o){let c=t;t=a(e),t===c?s[t].p(e,o):(V(),J(s[c],1,1,(()=>{s[c]=null})),Y(),n=s[t],n?n.p(e,o):(n=s[t]=i[t](e),n.c()),Z(n,1),n.m(r.parentNode,r))},i(e){o||(Z(n),o=!0)},o(e){J(n),o=!1},d(e){e&&v(r),s[t].d(e)}}}function If(e){let t,n,r,o,i,s,a,c,u,l,h,f,d,p,y,g,m,x,E,S,A,O,P,I,L;function j(t){e[20](t)}let T={icon:"",amount:500,event:e[0]};function B(t){e[21](t)}void 0!==e[8]&&(T.mobilePR=e[8]),r=new Sf({props:T}),R.push((()=>X(r,"mobilePR",j)));let $={icon:"",amount:2500,amountDisplay:"2.5k",event:e[0]};function U(t){e[22](t)}void 0!==e[8]&&($.mobilePR=e[8]),a=new Sf({props:$}),R.push((()=>X(a,"mobilePR",B)));let N={icon:"",amount:5e3,amountDisplay:"5k",event:e[0]};function H(t){e[23](t)}void 0!==e[8]&&(N.mobilePR=e[8]),h=new Sf({props:N}),R.push((()=>X(h,"mobilePR",U)));let M={icon:"",amount:1e4,amountDisplay:"10k",event:e[0]};function F(t){e[24](t)}void 0!==e[8]&&(M.mobilePR=e[8]),y=new Sf({props:M}),R.push((()=>X(y,"mobilePR",H)));let D={icon:"",amount:1e5,amountDisplay:"100k",event:e[0]};function z(t){e[25](t)}void 0!==e[8]&&(D.mobilePR=e[8]),E=new Sf({props:D}),R.push((()=>X(E,"mobilePR",F)));let K={icon:"",amount:1e6,amountDisplay:"1M",event:e[0]};return void 0!==e[8]&&(K.mobilePR=e[8]),P=new Sf({props:K}),R.push((()=>X(P,"mobilePR",z))),{c(){t=_("div"),n=_("div"),ee(r.$$.fragment),i=k(),s=_("div"),ee(a.$$.fragment),u=k(),l=_("div"),ee(h.$$.fragment),d=k(),p=_("div"),ee(y.$$.fragment),m=k(),x=_("div"),ee(E.$$.fragment),A=k(),O=_("div"),ee(P.$$.fragment),C(n,"class","flex flex-col hover:bg-orange-500 text-white rounded-full w-12 h-12 items-center justify-center cursor-pointer svelte-cpjycc"),C(s,"class","flex flex-col hover:bg-orange-500 text-white rounded-full w-12 h-12 items-center justify-center cursor-pointer svelte-cpjycc"),C(l,"class","flex flex-col hover:bg-orange-500 text-white rounded-full w-12 h-12 items-center justify-center cursor-pointer svelte-cpjycc"),C(p,"class","flex flex-col hover:bg-orange-500 text-white rounded-full w-12 h-12 items-center justify-center cursor-pointer svelte-cpjycc"),C(x,"class","flex flex-col hover:bg-orange-500 text-white rounded-full w-12 h-12 items-center justify-center cursor-pointer svelte-cpjycc"),C(O,"class","flex flex-col hover:bg-orange-500 text-white rounded-full w-12 h-12 items-center justify-center cursor-pointer svelte-cpjycc"),C(t,"class","flex flex-row items-stretch justify-between w-full svelte-cpjycc")},m(e,o){w(e,t,o),b(t,n),te(r,n,null),b(t,i),b(t,s),te(a,s,null),b(t,u),b(t,l),te(h,l,null),b(t,d),b(t,p),te(y,p,null),b(t,m),b(t,x),te(E,x,null),b(t,A),b(t,O),te(P,O,null),L=!0},p(e,t){const n={};1&t[0]&&(n.event=e[0]),!o&&256&t[0]&&(o=!0,n.mobilePR=e[8],q((()=>o=!1))),r.$set(n);const i={};1&t[0]&&(i.event=e[0]),!c&&256&t[0]&&(c=!0,i.mobilePR=e[8],q((()=>c=!1))),a.$set(i);const s={};1&t[0]&&(s.event=e[0]),!f&&256&t[0]&&(f=!0,s.mobilePR=e[8],q((()=>f=!1))),h.$set(s);const u={};1&t[0]&&(u.event=e[0]),!g&&256&t[0]&&(g=!0,u.mobilePR=e[8],q((()=>g=!1))),y.$set(u);const l={};1&t[0]&&(l.event=e[0]),!S&&256&t[0]&&(S=!0,l.mobilePR=e[8],q((()=>S=!1))),E.$set(l);const d={};1&t[0]&&(d.event=e[0]),!I&&256&t[0]&&(I=!0,d.mobilePR=e[8],q((()=>I=!1))),P.$set(d)},i(e){L||(Z(r.$$.fragment,e),Z(a.$$.fragment,e),Z(h.$$.fragment,e),Z(y.$$.fragment,e),Z(E.$$.fragment,e),Z(P.$$.fragment,e),L=!0)},o(e){J(r.$$.fragment,e),J(a.$$.fragment,e),J(h.$$.fragment,e),J(y.$$.fragment,e),J(E.$$.fragment,e),J(P.$$.fragment,e),L=!1},d(e){e&&v(t),ne(r),ne(a),ne(h),ne(y),ne(E),ne(P)}}}function Lf(t){let n,r,o,i,s,a,c,u;return{c(){n=_("div"),r=_("a"),o=E("Open in wallet"),s=k(),a=_("button"),a.textContent="Cancel",C(r,"href",i=`lightning:${t[8]}`),C(r,"class","text-center w-full p-3 bg-black text-white rounded-t-xl svelte-cpjycc"),C(a,"class","bg-white rounder-b-xl p-3 svelte-cpjycc"),C(n,"class","flex flex-col gap-3 w-full svelte-cpjycc")},m(e,i){w(e,n,i),b(n,r),b(r,o),b(n,s),b(n,a),c||(u=A(a,"click",t[19]),c=!0)},p(e,t){256&t[0]&&i!==(i=`lightning:${e[8]}`)&&C(r,"href",i)},i:e,o:e,d(e){e&&v(n),c=!1,u()}}}function jf(e){let t,n;return{c(){t=_("div"),n=E(e[10]),C(t,"class","text-xs text-gray-400 svelte-cpjycc")},m(e,r){w(e,t,r),b(t,n)},p(e,t){1024&t[0]&&P(n,e[10])},d(e){e&&v(t)}}}function Tf(t){let n;return{c(){n=_("div"),n.textContent="Website owner",C(n,"class","text-purple-500 text-xs svelte-cpjycc")},m(e,t){w(e,n,t)},p:e,d(e){e&&v(n)}}}function Bf(e){let t,n,r=Q(e[1][e[0].id]),o=[];for(let t=0;t<r.length;t+=1)o[t]=Rf(Af(e,r,t));const i=e=>J(o[e],1,1,(()=>{o[e]=null}));return{c(){t=_("div");for(let e=0;e<o.length;e+=1)o[e].c();C(t,"class","pl-5 border-l border-l-gray-400 flex flex-col gap-4 svelte-cpjycc")},m(e,r){w(e,t,r);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);n=!0},p(e,n){if(7&n[0]){let s;for(r=Q(e[1][e[0].id]),s=0;s<r.length;s+=1){const i=Af(e,r,s);o[s]?(o[s].p(i,n),Z(o[s],1)):(o[s]=Rf(i),o[s].c(),Z(o[s],1),o[s].m(t,null))}for(V(),s=r.length;s<o.length;s+=1)i(s);Y()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)Z(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)J(o[e]);n=!1},d(e){e&&v(t),m(o,e)}}}function Rf(e){let t,n;return t=new Nf({props:{websiteOwnerPubkey:e[2],event:e[32],responses:e[1]}}),{c(){ee(t.$$.fragment)},m(e,r){te(t,e,r),n=!0},p(e,n){const r={};4&n[0]&&(r.websiteOwnerPubkey=e[2]),3&n[0]&&(r.event=e[32]),2&n[0]&&(r.responses=e[1]),t.$set(r)},i(e){n||(Z(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){ne(t,e)}}}function $f(e){let t,n,o,i,s,c,u,l,h,f,d,p,y,g,m,x,I,L,j,T,B,R,$,U,N,H,M,q,F,D,z=e[0].content+"";function K(e,t){return e[9]>0?Cf:Of}let G=K(e),W=G(e),Q=e[6]&&Pf(e);let X=function(e,t){return e[13]?Tf:jf}(e),ee=X(e),te=e[1][e[0].id].length>0&&Bf(e);return{c(){t=_("div"),n=_("div"),o=_("div"),i=_("a"),s=_("img"),l=k(),h=_("button"),W.c(),d=k(),p=_("div"),Q&&Q.c(),g=k(),m=_("div"),x=_("div"),I=k(),L=_("div"),j=E(z),B=k(),R=_("div"),$=_("div"),U=_("span"),U.textContent=`${e[14].toLocaleString()}`,N=k(),ee.c(),H=k(),te&&te.c(),M=S(),a(s.src,c=e[4])||C(s,"src",c),C(s,"class","block w-8 h-8 rounded-full "+(e[13]?"ring-purple-700 ring-4":"")+" svelte-cpjycc"),C(s,"alt",""),C(i,"href",u=`nostr:${e[5]}`),C(i,"class","svelte-cpjycc"),C(h,"class",f="rounded-full "+(e[9]>0?"opacity-100 text-base":"bg-orange-500 opacity-10 text-xl")+" w-8 h-8 flex items-center justify-center hover:opacity-100 svelte-cpjycc"),C(p,"class",y=(e[6]?"w-full rounded-full bg-white  drop-shadow-xl justify-between border-2 border-gray-200":" rounded-full w-8 h-8 justify-center")+" flex items-center absolute ml-5 mt-10 z-10 svelte-cpjycc"),C(o,"class","min-w-fit flex flex-col gap-2 svelte-cpjycc"),C(x,"class","flex flex-row justify-between text-center overflow-clip text-clip w-full svelte-cpjycc"),C(L,"class",T="max-h-64 text-base cursor-pointer border border-slate-200 "+(e[11]===e[0].id?"bg-purple-700 text-white":"bg-white text-gray-900 hover:bg-slate-100")+" p-4 py-2 overflow-auto rounded-2xl shadow-sm svelte-cpjycc"),C(U,"class","py-2 svelte-cpjycc"),C($,"class","text-xs text-gray-400 text-ellipsis overflow-clip whitespace-nowrap svelte-cpjycc"),C(R,"class","flex flex-row-reverse justify-between mt-1 overflow-clip items-center relative svelte-cpjycc"),C(m,"class","w-full overflow-hidden svelte-cpjycc"),C(n,"class","flex flex-row gap-3 svelte-cpjycc"),C(t,"class","flex flex-col gap-4 p-2-lg mb-3 text-wrap relative  svelte-cpjycc")},m(r,a){w(r,t,a),b(t,n),b(n,o),b(o,i),b(i,s),b(o,l),b(o,h),W.m(h,null),b(o,d),b(o,p),Q&&Q.m(p,null),b(n,g),b(n,m),b(m,x),b(m,I),b(m,L),b(L,j),b(m,B),b(m,R),b(R,$),b($,U),b(R,N),ee.m(R,null),w(r,H,a),te&&te.m(r,a),w(r,M,a),q=!0,F||(D=[A(h,"click",O(e[18])),A(L,"click",O(e[26])),A(L,"keydown",O(e[27])),A(L,"keyup",O(e[28])),A(t,"mouseenter",e[29]),A(t,"mouseleave",e[30])],F=!0)},p(e,t){(!q||16&t[0]&&!a(s.src,c=e[4]))&&C(s,"src",c),(!q||32&t[0]&&u!==(u=`nostr:${e[5]}`))&&C(i,"href",u),G===(G=K(e))&&W?W.p(e,t):(W.d(1),W=G(e),W&&(W.c(),W.m(h,null))),(!q||512&t[0]&&f!==(f="rounded-full "+(e[9]>0?"opacity-100 text-base":"bg-orange-500 opacity-10 text-xl")+" w-8 h-8 flex items-center justify-center hover:opacity-100 svelte-cpjycc"))&&C(h,"class",f),e[6]?Q?(Q.p(e,t),64&t[0]&&Z(Q,1)):(Q=Pf(e),Q.c(),Z(Q,1),Q.m(p,null)):Q&&(V(),J(Q,1,1,(()=>{Q=null})),Y()),(!q||64&t[0]&&y!==(y=(e[6]?"w-full rounded-full bg-white  drop-shadow-xl justify-between border-2 border-gray-200":" rounded-full w-8 h-8 justify-center")+" flex items-center absolute ml-5 mt-10 z-10 svelte-cpjycc"))&&C(p,"class",y),(!q||1&t[0])&&z!==(z=e[0].content+"")&&P(j,z),(!q||2049&t[0]&&T!==(T="max-h-64 text-base cursor-pointer border border-slate-200 "+(e[11]===e[0].id?"bg-purple-700 text-white":"bg-white text-gray-900 hover:bg-slate-100")+" p-4 py-2 overflow-auto rounded-2xl shadow-sm svelte-cpjycc"))&&C(L,"class",T),ee.p(e,t),e[1][e[0].id].length>0?te?(te.p(e,t),3&t[0]&&Z(te,1)):(te=Bf(e),te.c(),Z(te,1),te.m(M.parentNode,M)):te&&(V(),J(te,1,1,(()=>{te=null})),Y())},i(e){q||(Z(Q),Z(te),q=!0)},o(e){J(Q),J(te),q=!1},d(e){e&&(v(t),v(H),v(M)),W.d(),Q&&Q.d(),ee.d(),te&&te.d(e),F=!1,r(D)}}}function Uf(e,t,n){let r,o,i,s,a,u;c(e,fe,(e=>n(16,o=e))),c(e,ce,(e=>n(31,i=e))),c(e,he,(e=>n(3,s=e))),c(e,ue,(e=>n(17,a=e))),c(e,le,(e=>n(11,u=e)));let h,f,d,p,y,{event:g}=t,{responses:b}=t,{websiteOwnerPubkey:w}=t,v={},m=0;function _(){u===g.id?l(le,u=null,u):l(le,u=g.id,u)}T((()=>{i.delayedSubscribe({kinds:[1,42,9735],"#e":[g.id]},"responses",500)}));const x=!!w===g.pubkey;var E;i.on("zap",(()=>{n(9,m=o[g.id]?.reduce(((e,t)=>e+t.amount),0)||0)})),E=()=>{n(9,m=o[g.id]?.reduce(((e,t)=>e+t.amount),0)||0)},j().$$.after_update.push(E);let k=new Date(1e3*g.created_at);return e.$$set=e=>{"event"in e&&n(0,g=e.event),"responses"in e&&n(1,b=e.responses),"websiteOwnerPubkey"in e&&n(2,w=e.websiteOwnerPubkey)},e.$$.update=()=>{if(131072&e.$$.dirty[0]&&n(15,v=a.profiles),32769&e.$$.dirty[0]&&n(10,r=v[g.pubkey]&&v[g.pubkey].display_name||`[${g.pubkey.slice(0,6)}]`),9&e.$$.dirty[0]&&n(6,d=s===g.id),1&e.$$.dirty[0])try{n(5,f=Di.npubEncode(g.pubkey))}catch(e){n(5,f=g.pubkey)}65537&e.$$.dirty[0]&&n(9,m=o[g.id]?.reduce(((e,t)=>e+t.amount),0)||0),32769&e.$$.dirty[0]&&n(4,h=v[g.pubkey]&&v[g.pubkey].picture||`https://robohash.org/${g.pubkey.slice(0,1)}.png?set=set1`)},[g,b,w,s,h,f,d,p,y,m,r,u,_,x,k,v,o,a,()=>l(he,s=s===g.id?null:g.id,s),()=>{l(he,s=null,s)},function(e){y=e,n(8,y)},function(e){y=e,n(8,y)},function(e){y=e,n(8,y)},function(e){y=e,n(8,y)},function(e){y=e,n(8,y)},function(e){y=e,n(8,y)},()=>{_(g.id)},()=>{_(g.id)},()=>{_(g.id)},()=>n(7,p=!0),()=>n(7,p=!1)]}class Nf extends ie{constructor(e){super(),oe(this,e,Uf,$f,i,{event:0,responses:1,websiteOwnerPubkey:2},null,[-1,-1])}}var Hf={$:e=>"string"==typeof e?document.querySelector(e):e,extend:(...e)=>Object.assign(...e),cumulativeOffset(e){let t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent}while(e);return{top:t,left:n}},directScroll:e=>e&&e!==document&&e!==document.body,scrollTop(e,t){let n=void 0!==t;return this.directScroll(e)?n?e.scrollTop=t:e.scrollTop:n?document.documentElement.scrollTop=document.body.scrollTop=t:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},scrollLeft(e,t){let n=void 0!==t;return this.directScroll(e)?n?e.scrollLeft=t:e.scrollLeft:n?document.documentElement.scrollLeft=document.body.scrollLeft=t:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0}};const Mf={container:"body",duration:500,delay:0,offset:0,easing:function(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1},onStart:e,onDone:e,onAborting:e,scrollX:!1,scrollY:!0},qf=e=>{let{offset:t,duration:n,delay:r,easing:o,x:i=0,y:s=0,scrollX:a,scrollY:c,onStart:u,onDone:l,container:h,onAborting:g,element:b}=e;"function"==typeof t&&(t=t());var w=Hf.cumulativeOffset(h),v=b?Hf.cumulativeOffset(b):{top:s,left:i},m=Hf.scrollLeft(h),_=Hf.scrollTop(h),x=v.left-w.left+t,E=v.top-w.top+t,k=x-m,S=E-_;let A=!0,O=!1,C=f()+r,P=C+n;function I(e){e||(O=!0,u(b,{x:i,y:s}))}function L(e){!function(e,t,n){a&&Hf.scrollLeft(e,n),c&&Hf.scrollTop(e,t)}(h,_+S*e,m+k*e)}function j(){A=!1}return function(e){let t;0===p.size&&d(y),new Promise((n=>{p.add(t={c:e,f:n})}))}((e=>{if(!O&&e>=C&&I(!1),O&&e>=P&&(L(1),j(),l(b,{x:i,y:s})),!A)return g(b,{x:i,y:s}),!1;if(O){L(0+1*o((e-C)/n))}return!0})),I(r),L(0),j},Ff=e=>{if(e&&e!==document&&e!==document.body)return e.scrollHeight-e.offsetHeight;{let e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)}},Df=e=>(e=(e=>{let t=Hf.extend({},Mf,e);return t.container=Hf.$(t.container),t.element=Hf.$(t.element),t})(e),qf(Hf.extend(e,{element:null,y:Ff(e.container)})));function zf(e,t,n){const r=e.slice();return r[30]=t[n],r}function Kf(e,t,n){const r=e.slice();return r[33]=t[n],r[35]=n,r}function Gf(e){let t;return{c(){t=E(e[10])},m(e,n){w(e,t,n)},p(e,n){1024&n[0]&&P(t,e[10])},d(e){e&&v(t)}}}function Wf(e){let t,n;return{c(){t=_("span"),C(t,"class",n="inline-block rounded-full "+(e[8]>e[35]?"bg-green-500":"bg-gray-300")+" w-2 h-2 svelte-cpjycc")},m(e,n){w(e,t,n)},p(e,r){256&r[0]&&n!==(n="inline-block rounded-full "+(e[8]>e[35]?"bg-green-500":"bg-gray-300")+" w-2 h-2 svelte-cpjycc")&&C(t,"class",n)},d(e){e&&v(t)}}}function Vf(e){let t,n,r,o,i,s,a=e[7].name+"",c=e[7].picture&&Yf(e),u=e[7].about&&Zf(e);return{c(){t=_("div"),c&&c.c(),n=k(),r=_("div"),o=_("div"),i=E(a),s=k(),u&&u.c(),C(o,"class","font-extrabold text-xl svelte-cpjycc"),C(r,"class","flex flex-col svelte-cpjycc"),C(t,"class","flex items-center p-4 bg-zinc-300 svelte-cpjycc")},m(e,a){w(e,t,a),c&&c.m(t,null),b(t,n),b(t,r),b(r,o),b(o,i),b(r,s),u&&u.m(r,null)},p(e,o){e[7].picture?c?c.p(e,o):(c=Yf(e),c.c(),c.m(t,n)):c&&(c.d(1),c=null),128&o[0]&&a!==(a=e[7].name+"")&&P(i,a),e[7].about?u?u.p(e,o):(u=Zf(e),u.c(),u.m(r,null)):u&&(u.d(1),u=null)},d(e){e&&v(t),c&&c.d(),u&&u.d()}}}function Yf(e){let t,n;return{c(){t=_("img"),a(t.src,n=e[7].picture)||C(t,"src",n),C(t,"class","w-12 h-12 rounded-full mr-2 svelte-cpjycc")},m(e,n){w(e,t,n)},p(e,r){128&r[0]&&!a(t.src,n=e[7].picture)&&C(t,"src",n)},d(e){e&&v(t)}}}function Zf(e){let t,n,r=e[7].about+"";return{c(){t=_("div"),n=E(r),C(t,"class","text-sm truncate font-regular svelte-cpjycc")},m(e,r){w(e,t,r),b(t,n)},p(e,t){128&t[0]&&r!==(r=e[7].about+"")&&P(n,r)},d(e){e&&v(t)}}}function Jf(e){let t,n;function r(e,n){return 2048&n[0]&&(t=null),null==t&&(t=!e[12](e[11])),t?Xf:Qf}let o=r(e,[-1,-1]),i=o(e);return{c(){i.c(),n=S()},m(e,t){i.m(e,t),w(e,n,t)},p(e,t){o===(o=r(e,t))&&i?i.p(e,t):(i.d(1),i=o(e),i&&(i.c(),i.m(n.parentNode,n)))},d(e){e&&v(n),i.d(e)}}}function Qf(t){let n,r,o,i,s;return{c(){n=_("div"),r=_("div"),o=_("button"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 svelte-cpjycc"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75" class="svelte-cpjycc"></path></svg>',C(o,"class","svelte-cpjycc"),C(r,"class","flex flex-col ml-2 svelte-cpjycc"),C(n,"class","hidden md:flex flex-row px-2 py-4 mb-3 overflow-x-hidden svelte-cpjycc")},m(e,a){w(e,n,a),b(n,r),b(r,o),i||(s=A(o,"click",O(t[15])),i=!0)},p:e,d(e){e&&v(n),i=!1,s()}}}function Xf(e){let t,n,r;return{c(){t=_("h1"),n=E("Couldn't find event with ID "),r=E(e[11]),C(t,"class","svelte-cpjycc")},m(e,o){w(e,t,o),b(t,n),b(t,r)},p(e,t){2048&t[0]&&P(r,e[11])},d(e){e&&v(t)}}}function ed(e){let t,n,r=Q(e[5]),o=[];for(let t=0;t<r.length;t+=1)o[t]=rd(zf(e,r,t));const i=e=>J(o[e],1,1,(()=>{o[e]=null}));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=S()},m(e,r){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,r);w(e,t,r),n=!0},p(e,n){if(98&n[0]){let s;for(r=Q(e[5]),s=0;s<r.length;s+=1){const i=zf(e,r,s);o[s]?(o[s].p(i,n),Z(o[s],1)):(o[s]=rd(i),o[s].c(),Z(o[s],1),o[s].m(t.parentNode,t))}for(V(),s=r.length;s<o.length;s+=1)i(s);Y()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)Z(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)J(o[e]);n=!1},d(e){e&&v(t),m(o,e)}}}function td(e){let t,n,r,o,i,s,a;return o=new Nf({props:{event:e[12](e[11]),responses:e[6],websiteOwnerPubkey:e[1]}}),{c(){t=_("div"),n=_("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 svelte-cpjycc"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75" class="svelte-cpjycc"></path></svg>',r=k(),ee(o.$$.fragment),C(n,"class"," svelte-cpjycc"),C(t,"class","md:hidden px-2 py-4 mb-3 svelte-cpjycc")},m(c,u){w(c,t,u),b(t,n),w(c,r,u),te(o,c,u),i=!0,s||(a=A(n,"click",O(e[15])),s=!0)},p(e,t){const n={};2048&t[0]&&(n.event=e[12](e[11])),64&t[0]&&(n.responses=e[6]),2&t[0]&&(n.websiteOwnerPubkey=e[1]),o.$set(n)},i(e){i||(Z(o.$$.fragment,e),i=!0)},o(e){J(o.$$.fragment,e),i=!1},d(e){e&&(v(t),v(r)),ne(o,e),s=!1,a()}}}function nd(e){let t;return{c(){t=E(" deleted")},m(e,n){w(e,t,n)},d(e){e&&v(t)}}}function rd(e){let t,n,r,o;t=new Nf({props:{event:e[30],responses:e[6],websiteOwnerPubkey:e[1]}});let i=e[30].deleted&&nd();return{c(){ee(t.$$.fragment),n=k(),i&&i.c(),r=S()},m(e,s){te(t,e,s),w(e,n,s),i&&i.m(e,s),w(e,r,s),o=!0},p(e,n){const o={};32&n[0]&&(o.event=e[30]),64&n[0]&&(o.responses=e[6]),2&n[0]&&(o.websiteOwnerPubkey=e[1]),t.$set(o),e[30].deleted?i||(i=nd(),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},i(e){o||(Z(t.$$.fragment,e),o=!0)},o(e){J(t.$$.fragment,e),o=!1},d(e){e&&(v(n),v(r)),ne(t,e),i&&i.d(e)}}}function od(e){let t,n;return{c(){t=_("b"),t.textContent="Public notes:",n=E("\n        your followers see your messages on their timeline"),C(t,"class","font-bold svelte-cpjycc")},m(e,r){w(e,t,r),w(e,n,r)},d(e){e&&(v(t),v(n))}}}function id(e){let t,n;return{c(){t=_("b"),t.textContent="Public chat:",n=E("\n        anyone can see these messages."),C(t,"class","font-bold svelte-cpjycc")},m(e,r){w(e,t,r),w(e,n,r)},d(e){e&&(v(t),v(n))}}}function sd(e){let t,n;return{c(){t=_("b"),t.textContent="Encrypted chat:",n=E("\n        only your chat partner can see these messages."),C(t,"class","font-bold svelte-cpjycc")},m(e,r){w(e,t,r),w(e,n,r)},d(e){e&&(v(t),v(n))}}}function ad(t){let n,r,o;return{c(){n=_("button"),n.innerHTML='<svg transform="scale(-1,1)" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 svelte-cpjycc"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" class="svelte-cpjycc"></path></svg>\n    &gt;',C(n,"title","Login"),C(n,"class","bg-green-700 min-h-[40px] max-h-[40px] hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 text-white rounded-md px-4 py-2 cursor-pointer svelte-cpjycc")},m(e,i){w(e,n,i),r||(o=A(n,"click",O(t[21])),r=!0)},p:e,d(e){e&&v(n),r=!1,o()}}}function cd(e){let t,n,i,s,a,c,u,l,h,f,d,p,y,g,x,S,I,L,j,T,B,R,$,U,N,H,M,q,F,D,z,K,G,W,X,ee=e[4]?.pubkey&&Gf(e),te=Q(Array(e[9])),ne=[];for(let t=0;t<te.length;t+=1)ne[t]=Wf(Kf(e,te,t));let re=e[7].name&&Vf(e),oe=e[11]&&Jf(e);const ie=[td,ed],se=[];function ae(e,t){return e[11]?0:1}function ce(e,t){return"DM"===e[2].chatType?sd:"GROUP"===e[2].chatType?id:od}j=ae(e),T=se[j]=ie[j](e);let ue=ce(e),le=ue(e),he="chat"==e[0]&&ad(e);return{c(){t=_("div"),n=_("h3"),ee&&ee.c(),i=k(),s=_("span"),a=_("div");for(let e=0;e<ne.length;e+=1)ne[e].c();c=k(),u=E(e[8]),l=E("/"),h=E(e[9]),f=E(" relays"),d=k(),p=_("button"),p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 svelte-cpjycc" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="--darkreader-inline-stroke: currentColor;" data-darkreader-inline-stroke=""><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-cpjycc"></path></svg>',y=k(),re&&re.c(),g=k(),x=_("div"),oe&&oe.c(),S=k(),I=_("div"),L=_("div"),T.c(),R=k(),$=_("div"),U=_("div"),le.c(),H=k(),M=_("div"),q=_("div"),he&&he.c(),F=k(),D=_("input"),z=k(),K=_("button"),K.innerHTML='<svg aria-hidden="true" class="w-6 h-6 rotate-90 svelte-cpjycc" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" class="svelte-cpjycc"></path></svg>',C(n,"class","m-0 text-lg svelte-cpjycc"),C(a,"class","flex flex-row gap-1 overflow-clip svelte-cpjycc"),C(s,"class","text-xs flex mr-0 ml-auto flex-col items-end mt-2 text-gray-200 gap-1 svelte-cpjycc"),C(p,"id","close-popup"),C(p,"class","bg-transparent ml-4 border-none text-white cursor-pointer svelte-cpjycc"),C(t,"class","flex justify-between items-center p-4 bg-purple-700 text-white md:rounded-t-md svelte-cpjycc"),C(L,"id","messages-container-inner"),C(L,"class",B="flex flex-col "+(!e[11]&&"mt-96")+" gap-4 svelte-cpjycc"),C(I,"id","messages-container"),C(I,"class","overflow-auto overflow-x-hidden -mx-4 px-4 min-h-full h-full svelte-cpjycc"),C(U,"class","px-2 svelte-cpjycc"),C($,"id","chat-input-warn"),C($,"class",N="border-y "+(e[11]&&"hidden")+" border-y-slate-200 -mx-4 bg-slate-100 text-black text-sm px-4 py-2 sticky bottom-0 svelte-cpjycc"),C(x,"id","chat-messages"),C(x,"class","flex-1 px-4 min-h-[192px] block overflow-y-hidden md:overflow-y-auto overflow-x-hidden svelte-cpjycc"),C(D,"type","text"),C(D,"id","message-input"),C(D,"class","flex-1 border border-gray-300 min-h-[40px] max-h-[40px] rounded-md px-4 py-2 outline-none w-3/4 svelte-cpjycc"),C(D,"placeholder","Say hello"),C(K,"class","bg-purple-700 min-h-[40px] max-h-[40px] hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 text-white rounded-md px-4 py-2 cursor-pointer svelte-cpjycc"),C(q,"class","flex space-x-4 items-center svelte-cpjycc"),C(M,"id","chat-input-container"),C(M,"class","p-4 svelte-cpjycc")},m(r,v){w(r,t,v),b(t,n),ee&&ee.m(n,null),b(t,i),b(t,s),b(s,a);for(let e=0;e<ne.length;e+=1)ne[e]&&ne[e].m(a,null);b(s,c),b(s,u),b(s,l),b(s,h),b(s,f),b(t,d),b(t,p),w(r,y,v),re&&re.m(r,v),w(r,g,v),w(r,x,v),oe&&oe.m(x,null),b(x,S),b(x,I),b(I,L),se[j].m(L,null),b(x,R),b(x,$),b($,U),le.m(U,null),w(r,H,v),w(r,M,v),b(M,q),he&&he.m(q,null),b(q,F),b(q,D),b(q,z),b(q,K),G=!0,W||(X=[A(p,"click",(function(){o(e[3])&&e[3].apply(this,arguments)})),A(D,"keydown",e[14]),A(K,"click",O(e[13]))],W=!0)},p(t,r){if(e=t,e[4]?.pubkey?ee?ee.p(e,r):(ee=Gf(e),ee.c(),ee.m(n,null)):ee&&(ee.d(1),ee=null),768&r[0]){let t;for(te=Q(Array(e[9])),t=0;t<te.length;t+=1){const n=Kf(e,te,t);ne[t]?ne[t].p(n,r):(ne[t]=Wf(n),ne[t].c(),ne[t].m(a,null))}for(;t<ne.length;t+=1)ne[t].d(1);ne.length=te.length}(!G||256&r[0])&&P(u,e[8]),(!G||512&r[0])&&P(h,e[9]),e[7].name?re?re.p(e,r):(re=Vf(e),re.c(),re.m(g.parentNode,g)):re&&(re.d(1),re=null),e[11]?oe?oe.p(e,r):(oe=Jf(e),oe.c(),oe.m(x,S)):oe&&(oe.d(1),oe=null);let o=j;j=ae(e),j===o?se[j].p(e,r):(V(),J(se[o],1,1,(()=>{se[o]=null})),Y(),T=se[j],T?T.p(e,r):(T=se[j]=ie[j](e),T.c()),Z(T,1),T.m(L,null)),(!G||2048&r[0]&&B!==(B="flex flex-col "+(!e[11]&&"mt-96")+" gap-4 svelte-cpjycc"))&&C(L,"class",B),ue!==(ue=ce(e))&&(le.d(1),le=ue(e),le&&(le.c(),le.m(U,null))),(!G||2048&r[0]&&N!==(N="border-y "+(e[11]&&"hidden")+" border-y-slate-200 -mx-4 bg-slate-100 text-black text-sm px-4 py-2 sticky bottom-0 svelte-cpjycc"))&&C($,"class",N),"chat"==e[0]?he?he.p(e,r):(he=ad(e),he.c(),he.m(q,F)):he&&(he.d(1),he=null)},i(e){G||(Z(T),G=!0)},o(e){J(T),G=!1},d(e){e&&(v(t),v(y),v(g),v(x),v(H),v(M)),ee&&ee.d(),m(ne,e),re&&re.d(e),oe&&oe.d(),se[j].d(),le.d(),he&&he.d(),W=!1,r(X)}}}function ud(e,t,n){let r,o,i,s;c(e,ce,(e=>n(4,r=e))),c(e,le,(e=>n(11,o=e))),c(e,ue,(e=>n(20,i=e))),c(e,fe,(e=>n(24,s=e)));let a,u,h=[],f=[],d={},p={},{startPage:y}=t,{websiteOwnerPubkey:g}=t,{chatConfiguration:b}=t,{toggleChat:w}=t;function v(e){let t=h.find((t=>t.id===e));return t=t||f.find((t=>t.id===e)),t}async function m(){const e=document.getElementById("message-input");if(""===e.value||" "===e.value);else{const t=e.value;e.value="";let n={tags:[],tagPubKeys:[]};!u&&g&&(n.tagPubKeys=[g]),o&&(n.tags.push(["e",o,"wss://nos.lol","root"]),n.tagPubKeys.push(v(o).pubkey));const i=await r.send(t,n);u||(u=i,localStorage.setItem("rootNoteId",u))}}function _(e){let t;if(e.tags.filter((e=>"e"===e[0])).pop(),"GLOBAL"===b.chatType)t=e.tags.filter((e=>"e"===e[0])).length>=1;else if("GROUP"===b.chatType)t=e.tags.filter((e=>"e"===e[0]&&e[1]!==b.chatId)).length>=1;else{const n=e.tags.filter((e=>"p"===e[0])).map((e=>e[1]));t=new Set(n).size>=2}if(d[e.id]||n(6,d[e.id]=[],d),t){const t=e.tags.filter((e=>"e"===e[0])).pop();t&&t[1]&&(d[t[1]]||n(6,d[t[1]]=[],d),d[t[1]].push(e)),f.push(e)}else{let t=0;for(;t<h.length&&h[t].created_at<e.created_at;)t++;h.splice(t,0,e),n(5,h),n(2,b),n(17,a),n(4,r)}n(6,d),n(2,b),n(17,a),n(4,r),x()}function x(){Df({container:document.getElementById("chat-messages"),offset:999999,duration:50}),Df({container:document.getElementById("messages-container"),offset:999999,duration:50})}function E(e){const t=h.find((t=>t.id===e.zappedEvent));t&&(s[t.id]||l(fe,s[t.id]=[],s),s[t.id].push(e))}function k(e){const t=h.find((t=>t.id===e.id));t&&(t.reactions=t.reactions||[],t.reactions.push(e),n(5,h),n(2,b),n(17,a),n(4,r))}let S={};T((()=>{r.on("message",_),r.on("connectivity",(e=>{n(18,C=e)})),r.on("reaction",k),r.on("zap",E),r.on("deleted",(e=>{e.forEach((e=>{const t=h.findIndex((t=>t.id===e));-1!==t&&(n(5,h[t].deleted=!0,h),n(5,h),n(2,b),n(17,a),n(4,r))}))})),r.on("profile",(({pubkey:e,profile:t})=>{let n=i.profiles;n[e]=t,ue.set({profiles:n,...i})})),r.on("channelMetadata",(e=>{n(7,S=JSON.parse(e.content))}))}));let A,O,C={},P=0,I=0;return e.$$set=e=>{"startPage"in e&&n(0,y=e.startPage),"websiteOwnerPubkey"in e&&n(1,g=e.websiteOwnerPubkey),"chatConfiguration"in e&&n(2,b=e.chatConfiguration),"toggleChat"in e&&n(3,w=e.toggleChat)},e.$$.update=()=>{131092&e.$$.dirty[0]&&(b!==a&&r&&(r.setChatConfiguration(b.chatType,b.chatTags,b.chatReferenceTags,b.chatId),n(5,h=[]),n(6,d={}),u=null,localStorage.removeItem("rootNoteId")),n(17,a=b)),1048576&e.$$.dirty[0]&&n(16,p=i.profiles),327696&e.$$.dirty[0]&&(n(8,P=Object.values(C).filter((e=>"connected"===e)).length),n(9,I=Object.values(C).length),r?.pubkey&&!p[r.pubkey]&&r.reqProfile(r.pubkey)),524304&e.$$.dirty[0]&&A!==r?.chatId&&(n(19,A=r?.chatId),n(7,S={})),16&e.$$.dirty[0]&&n(10,O=r?.pubkey?function(e){let t;if(p[r.pubkey]){let e=p[r.pubkey];t=e.display_name||e.displayName||e.name||e.nip05}return t||(t=`[${e.slice(0,6)}]`),t}(r.pubkey):"")},[y,g,b,w,r,h,d,S,P,I,O,o,v,m,async function(e){"Enter"===e.key&&(m(),e.preventDefault())},function(){if("GROUP"===b.chatType)l(le,o=null,o);else{const e=v(o).tags.filter((e=>"e"===e[0])).pop(),t=e&&e[1];l(le,o=t,o)}x()},p,a,C,A,i,()=>ce.set("")]}class ld extends ie{constructor(e){super(),oe(this,e,ud,cd,i,{startPage:0,websiteOwnerPubkey:1,chatConfiguration:2,toggleChat:3},null,[-1,-1])}}function hd(e){let t,n;return t=new ld({props:{startPage:e[6],toggleChat:e[4],websiteOwnerPubkey:e[1],chatConfiguration:e[2],relays:e[3]}}),{c(){ee(t.$$.fragment)},m(e,r){te(t,e,r),n=!0},p(e,n){const r={};64&n&&(r.startPage=e[6]),16&n&&(r.toggleChat=e[4]),2&n&&(r.websiteOwnerPubkey=e[1]),4&n&&(r.chatConfiguration=e[2]),8&n&&(r.relays=e[3]),t.$set(r)},i(e){n||(Z(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){ne(t,e)}}}function fd(e){let t,n;return t=new tf({props:{firstStartupDone:e[7],managedLogin:e[8],startPage:e[5],toggleChat:e[4],websiteOwnerPubkey:e[1],chatConfiguration:e[2],relays:e[3]}}),{c(){ee(t.$$.fragment)},m(e,r){te(t,e,r),n=!0},p(e,n){const r={};32&n&&(r.startPage=e[5]),16&n&&(r.toggleChat=e[4]),2&n&&(r.websiteOwnerPubkey=e[1]),4&n&&(r.chatConfiguration=e[2]),8&n&&(r.relays=e[3]),t.$set(r)},i(e){n||(Z(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){ne(t,e)}}}function dd(e){let t,n,r,o;const i=[fd,hd],s=[];function a(e,t){return e[0]?1:0}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),r=S()},m(e,n){s[t].m(e,n),w(e,r,n),o=!0},p(e,[o]){let c=t;t=a(e),t===c?s[t].p(e,o):(V(),J(s[c],1,1,(()=>{s[c]=null})),Y(),n=s[t],n?n.p(e,o):(n=s[t]=i[t](e),n.c()),Z(n,1),n.m(r.parentNode,r))},i(e){o||(Z(n),o=!0)},o(e){J(n),o=!1},d(e){e&&v(r),s[t].d(e)}}}function pd(e,t,n){let r;c(e,ce,(e=>n(10,r=e)));let{startPage:o}=t,{websiteOwnerPubkey:i}=t,{chatStarted:s}=t,{chatConfiguration:a}=t,{relays:u}=t,{toggleChat:l}=t,h=o,f=o;return e.$$set=e=>{"startPage"in e&&n(9,o=e.startPage),"websiteOwnerPubkey"in e&&n(1,i=e.websiteOwnerPubkey),"chatStarted"in e&&n(0,s=e.chatStarted),"chatConfiguration"in e&&n(2,a=e.chatConfiguration),"relays"in e&&n(3,u=e.relays),"toggleChat"in e&&n(4,l=e.toggleChat)},e.$$.update=()=>{1024&e.$$.dirty&&n(0,s=!!r)},[s,i,a,u,l,h,f,function(){n(5,h="login")},function(){n(6,f="login")},o,r]}class yd extends ie{constructor(e){super(),oe(this,e,pd,dd,i,{startPage:9,websiteOwnerPubkey:1,chatStarted:0,chatConfiguration:2,relays:3,toggleChat:4})}}function gd(e){let t;return{c(){t=_("span"),t.textContent="Nostri",C(t,"class","text-white svelte-ika13l")},m(e,n){w(e,t,n)},d(e){e&&v(t)}}}function bd(e){let t,n,r,o;return{c(){t=x("svg"),n=x("g"),r=x("g"),o=x("path"),C(o,"d","M533.187,269.019c-1.432-1.746-2.219-3.876-1.252-5.993c1.868-4.08,0.611-7.658-0.931-11.465 c-0.877-2.167-0.796-4.716-1.15-7.095c-0.221-1.493-0.057-3.199-0.742-4.435c-1.775-3.199-3.812-6.275-5.949-9.245 c-2.681-3.717-5.564-7.291-8.38-10.914c-3.325-4.284-6.581-8.633-10.09-12.766c-0.706-0.833-2.604-1.42-3.607-1.085 c-2.411,0.808-4.732,2.052-6.874,3.452c-2.771,1.812-5.435,3.317-8.928,3.713c-3.953,0.453-8.062,1.403-11.604,3.154 c-5.189,2.562-9.747,6.401-14.924,9c-4.913,2.464-8.328,6.112-11.184,10.567c-0.783,1.22-1.705,2.371-2.685,3.444 c-3.252,3.574-5.549,7.629-7.051,12.248c-1.154,3.554-2.378,7.226-4.373,10.322c-1.963,3.044-3.256,6.194-4.162,9.601 c-0.285,1.065-0.44,2.167-0.656,3.251c-2.212-0.539-4.19-0.873-6.06-1.518c-1.709-0.592-3.684-1.15-4.879-2.375 c-2.979-3.052-6.528-5.059-10.388-6.577c-3.448-1.354-6.581-3.06-9.441-5.496c-1.514-1.29-3.771-1.738-5.721-2.489 c-1.419-0.547-3.043-0.714-4.3-1.501c-3.439-2.146-6.639-4.68-10.11-6.765c-2.256-1.359-4.737-2.542-7.271-3.166 c-1.722-0.424-2.293-0.865-2.216-2.599c0.241-5.227-0.832-10.175-3.235-14.872c-2.855-5.582-8.723-8.625-14.777-7.589 c-2.697,0.461-5.573,1.347-8.128,0.833c-3.329-0.669-6.516-2-10.028-1.861c-0.612,0.025-1.31-0.437-1.864-0.82 c-4.076-2.832-8.152-5.663-12.163-8.584c-1.489-1.085-2.782-1.154-4.442-0.322c-1.221,0.612-2.705,0.955-4.08,0.967 c-6.047,0.062-12.098-0.082-18.148-0.077c-5.173,0.004-10.498,1.815-15.377-1.399c-0.241-0.159-0.588-0.216-0.886-0.221 c-3.023-0.028-4.488-1.632-5.096-4.524c-0.171-0.82-1.436-1.971-2.236-2c-3.986-0.143-7.984-0.041-11.971,0.139 c-2.187,0.102-4.619,0.004-6.483,0.922c-3.941,1.942-7.556,4.533-11.355,6.773c-1.505,0.889-3.023,1.085-3.872-0.763 c0.979-1.261,2.337-2.272,2.627-3.525c0.771-3.37-3.705-7.181-6.969-6.059c-1.498,0.514-3.003,1.208-4.272,2.138 c-2.464,1.807-4.725,3.896-7.144,5.769c-3.011,2.33-6.055,4.655-10.449,4.737c0.983-3.753-1.718-5.104-4.108-6.597 c-1.094-0.686-2.293-1.281-3.525-1.652c-3.276-1-6.348-0.763-8.956,1.828c-2.158,2.142-3.488,2.179-6.014,0.367 c-3.081-2.208-3.986-2.175-7.128,0c-1.122,0.775-2.346,1.832-3.586,1.926c-4.268,0.318-6.646,3.052-8.931,6.132 c-1.632,2.203-3.244,4.472-5.173,6.405c-4.378,4.39-8.911,8.629-13.48,12.815c-0.608,0.559-1.95,0.873-2.709,0.608 c-3.378-1.191-5.582-3.823-6.899-7.001c-2.521-6.075-4.957-12.203-7.07-18.429c-0.816-2.399-1.11-5.165-0.865-7.687 c0.559-5.786,1.771-11.51,2.411-17.291c1.196-10.796,3.583-21.343,7.405-31.445c6.773-17.891,13.934-35.643,21.2-53.342 c4.619-11.249,7.817-22.852,10.167-34.75c1.644-8.319,2.477-16.63,1.901-25.137c-0.286-4.227,0.232-8.56,0.808-12.787 c1.669-12.232-2.46-19.547-13.843-24.068c-1.403-0.559-2.766-1.228-4.149-1.844c-2.15,0-4.3,0-6.455,0 c-2.909,0.91-5.871,1.681-8.715,2.762c-3.827,1.457-7.989,2.484-10.51,6.145c-1.701,2.472-4.088,3.5-6.916,4.06 c-3.9,0.771-7.797,1.62-11.62,2.705c-3.378,0.959-6.369,2.709-9.135,5.872c6.863,1.652,13.211,3.305,19.617,4.692 c7.629,1.652,14.558,4.729,20.518,9.763c2.954,2.493,5.667,5.447,6.165,9.425c0.51,4.084,0.608,8.271,0.392,12.383 c-0.563,10.694-4.137,20.661-7.976,30.515c-2.358,6.059-5.406,11.876-7.36,18.054c-4.321,13.656-8.486,27.348-14.19,40.522 c-3.309,7.646-6.83,15.251-8.307,23.534c-1.722,9.657-3.264,19.343-4.917,29.013c-0.845,4.958-0.877,10.049-2.864,14.819 c-0.873,2.093-1.269,4.406-1.693,6.654c-0.975,5.182-1.832,10.379-2.733,15.573c0,7.838,0,15.675,0,23.513 c0.632,3.905,1.363,7.801,1.877,11.722c1.481,11.232,4.773,21.955,8.825,32.489c0.816,2.121,1.322,4.378,1.783,6.613 c0.718,3.473,1.069,7.365,4.309,9.303c2.427,1.452,2.982,3.402,3.603,5.671c1.828,6.684,1.318,13.428,0.147,20.086 c-1.114,6.341-0.845,12.525,0.861,18.65c2.313,8.318,4.72,16.613,7.291,24.859c0.461,1.48,1.71,2.896,2.946,3.916 c5.3,4.382,10.735,8.605,16.108,12.897c0.355,0.281,0.645,0.656,0.914,1.028c2.652,3.672,6.373,5.879,10.677,6.638 c8.262,1.457,16.275,4.117,24.664,4.929c1.363,0.131,2.742,0.453,4.035,0.906c2.362,0.828,4.696,1.733,7.038,2.623 c1.257,0.824,2.391,1.832,3.415,3.064c-0.698,2.239-1.901,4.234-3.199,6.164c-3.529,5.239-8.344,8.948-14.007,11.633 c-5.818,2.754-11.975,4.442-18.242,5.744c-8.115,1.686-16.259,3.231-24.378,4.88c-6.789,1.379-13.248,3.79-19.633,6.414 c-8.25,3.39-16.463,6.879-24.77,10.13c-6.447,2.525-13.158,4.149-20.086,4.68c-2.077,0.159-4.178,0.017-6.267,0.065 c-0.604,0.017-1.326,0.045-1.783,0.367c-3.46,2.437-7.446,3.407-11.481,4.272c-1.607,0.347-3.203,0.742-4.802,1.117 c-4.423,1.049-7.703,3.672-10.237,7.36c-2.481,3.619-3.827,7.691-4.762,11.914c-1.26,5.708-1.685,11.521-1.921,17.344 c-0.306,7.405-0.526,14.814-0.828,22.22c-0.082,2.023-0.367,4.035-0.486,6.059c-0.033,0.592,0.012,1.302,0.314,1.779 c3.525,5.654,7.299,11.126,12.276,15.643c4.251,3.859,8.993,6.769,14.819,7.557c0.171,0.024,0.326,0.175,0.485,0.265 c1.775,0,3.55,0,5.32,0c1.032-0.253,2.085-0.444,3.097-0.767c2.216-0.702,4.415-1.461,6.663-2.212 c-0.196-1.881-0.971-3.166-2.317-3.962c-1.236-0.734-2.595-1.301-3.958-1.771c-1.73-0.596-3.55-0.942-5.275-1.554 c-1.114-0.396-2.208-0.968-3.174-1.648c-1.367-0.968-1.979-2.424-2.052-4.097c0.069-0.102,0.118-0.257,0.212-0.298 c4.643-1.885,7.16-5.879,9.694-9.837c0.298-0.461,0.294-1.195,0.241-1.787c-0.445-4.696-1.775-9.184-3.354-13.599 c-1.75-4.884-3.595-9.73-5.333-14.614c-0.551-1.547-0.836-3.183-1.326-4.749c-0.318-1.017,0.11-1.543,0.938-1.971 c1.64-0.841,3.423-0.832,5.189-0.886c2.464-0.073,4.945,0.041,7.393-0.188c1.408-0.131,2.925-0.515,4.121-1.236 c13.692-8.303,28.474-14.003,43.791-18.413c13.876-3.998,27.997-6.915,42.244-9.229c6.247-1.012,12.501-1.967,18.76-2.897 c0.918-0.134,1.665-0.428,2.371-1.027c4.227-3.595,9.217-5.586,14.635-6.259c5.773-0.715,11.608-0.951,17.393-1.563 c3.578-0.379,7.161-0.905,10.678-1.656c4.308-0.918,8.045-3.129,11.146-6.205c2.688-2.669,5.132-5.59,7.593-8.482 c3.28-3.855,6.414-7.834,9.727-11.661c1.02-1.179,2.432-2.012,3.631-3.039c0.792-0.674,1.501-0.653,2.391-0.11 c4.125,2.529,8.576,4.32,13.199,5.712c5.716,1.722,11.566,2.75,17.495,3.374c10.983,1.159,22,1.204,33.023,0.906 c3.166-0.086,6.333-0.09,9.503-0.184c0.93-0.029,1.718,0.171,2.473,0.729c3.309,2.444,6.646,4.852,9.963,7.291 c3.117,2.293,6.345,4.402,9.927,5.92c0.641,0.273,1.277,0.612,1.95,0.735c2.758,0.497,4.741,2.235,6.744,4.002 c5.908,5.214,11.343,10.894,16.161,17.111c6.324,8.156,12.468,16.455,18.617,24.745c6.152,8.295,12.342,16.557,19.396,24.125 c6.863,7.36,14.423,13.868,23.122,18.984c0.775,0.457,1.432,0.955,1.844,1.815c3.187,6.655,8.475,11.09,15.076,14.093 c6.81,3.097,14.006,4.256,21.444,4.142c10.33-0.159,20.062-2.53,28.906-8.014c5.264-3.264,9.572-7.471,12.347-13.097 c1.15-2.338,2.109-4.737,2.269-7.385c0.016-0.29,0.212-0.571,0.326-0.853c0-0.633,0-1.27,0-1.901 c-3.488-0.6-6.802,0.208-10.045,1.362c-3.101,1.102-6.124,2.416-9.25,3.443c-2.692,0.886-5.442,1.673-8.225,2.195 c-4.554,0.853-8.042-1.113-10.037-5.41c0.804-1.049,1.995-1.195,3.194-1.253c2.338-0.113,4.685-0.143,7.022-0.302 c0.799-0.053,1.664-0.249,2.338-0.648c0.6-0.359,1.121-1.024,1.411-1.673c0.498-1.126,0.311-1.44-0.869-2.085 c-3.402-1.856-6.993-3.264-10.714-4.324c-8.421-2.399-17.055-3.028-25.757-3.061c-1.836-0.008-3.677-0.004-5.513,0.082 c-0.963,0.045-1.66-0.249-2.366-0.906c-4.843-4.5-9.094-9.53-13.166-14.721c-6.613-8.429-12.48-17.389-18.47-26.259 c-2.836-4.198-5.786-8.319-8.769-12.411c-0.999-1.375-2.244-2.574-3.419-3.811c-0.384-0.404-0.885-0.727-1.383-0.991 c-1.358-0.727-2.269-0.408-2.905,1.003c-0.229,0.511-0.379,1.062-0.648,1.828c-0.633-0.465-1.179-0.841-1.697-1.253 c-5.03-4.019-8.866-9.058-11.905-14.655c-2.954-5.446-5.627-11.048-8.344-16.626c-2.607-5.353-5.092-10.767-8.438-15.712 c-1.521-2.248-3.317-4.312-4.9-6.523c-0.783-1.094-1.709-1.229-2.949-1.094c-5.324,0.579-10.625,0.494-15.843-0.894 c-2.591-0.689-5.035-1.718-7.1-3.488c-1.473-1.269-2.562-2.746-3.211-4.513c1.95-0.433,3.893-0.897,5.818-1.424 c6.459-1.767,12.926-2.469,19.552-2.081c7.964,0.466,15.92,1.159,23.892,1.437c2.853,0.098,5.966-0.172,8.557-1.244 c3.859-1.596,7.544-3.799,10.971-6.206c5.075-3.566,9.702-7.78,14.847-11.232c2.379-1.595,3.203-3.292,3.306-5.92 c0.134-3.509,1.9-4.781,5.3-4.149c0.6,0.114,1.203,0.253,1.787,0.44c3.852,1.229,7.633,1.028,11.489-0.163 c2.962-0.914,6.066-1.354,9.053-2.195c0.547-0.154,1.024-1.199,1.163-1.909c0.094-0.481-0.616-1.068-0.693-1.648 c-0.127-0.922-0.384-2.402,0.057-2.705c0.854-0.575,2.154-0.656,3.265-0.636c0.881,0.016,1.733,0.62,2.627,0.729 c2.064,0.258,3.995,0.021,5.247-1.986c1.232-1.971,1.277-3.864-0.163-5.757c-0.465-0.608-1.069-1.249-1.191-1.946 c-0.163-0.938-0.273-2.199,0.212-2.881c1.779-2.488,3.771-4.83,5.77-7.152c1.828-2.121,4.251-3.354,6.997-3.541 c0.967-0.065,2.158,0.742,2.966,1.465c0.633,0.562,0.686,1.729,1.261,2.407c0.674,0.795,1.628,1.347,2.465,2.007 c0.571-0.877,1.358-1.688,1.656-2.651c0.311-0.992-0.028-2.175,0.236-3.187c0.213-0.812,0.743-1.738,1.416-2.195 c3.591-2.439,7.442-4.524,10.861-7.177c2.574-1.991,4.508-4.786,6.944-6.98c4.182-3.771,9.526-5.097,14.789-6.472 c3.452-0.901,4.194-1.921,3.134-5.365c-0.514-1.673-1.228-3.309-2.052-4.854c-1.062-1.987-0.531-3.362,1.297-4.402 c0.727-0.412,1.498-0.751,2.252-1.114c2.387-1.139,4.08-2.701,4.688-5.521c0.612-2.827,1.75-5.549,2.741-8.286 c1.339-3.692,2.432-7.65,7.34-8.144c0.147-0.017,0.294-0.061,0.441-0.094c0-1.077,0-2.15,0-3.228 c-1.135-1.775-2.15-3.639-3.432-5.3C536.084,271.981,534.492,270.614,533.187,269.019z"),C(o,"class","svelte-ika13l"),C(r,"class","svelte-ika13l"),C(n,"class","svelte-ika13l"),C(t,"fill","#ffffff"),C(t,"version","1.1"),C(t,"id","Capa_1"),C(t,"xmlns","http://www.w3.org/2000/svg"),C(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),C(t,"width","25px"),C(t,"height","25px"),C(t,"viewBox","0 0 571.004 571.004"),C(t,"xml:space","preserve"),C(t,"class","svelte-ika13l")},m(e,i){w(e,t,i),b(t,n),b(n,r),b(r,o)},d(e){e&&v(t)}}}function wd(e){let t,n,r,o;return n=new yd({props:{startPage:e[2],websiteOwnerPubkey:e[3],chatConfiguration:{chatType:e[4],chatTags:e[5],chatId:e[8],chatReferenceTags:e[6]},relays:e[7],toggleChat:e[11]}}),{c(){t=_("div"),ee(n.$$.fragment),C(t,"id","_chat-popup"),C(t,"class",r="absolute bottom-20 right-0 w-96 bg-white rounded-md shadow-md flex flex-col transition-all text-sm "+(e[10]?"hidden":"")+" svelte-ika13l")},m(e,r){w(e,t,r),te(n,t,null),o=!0},p(e,i){const s={};4&i&&(s.startPage=e[2]),8&i&&(s.websiteOwnerPubkey=e[3]),368&i&&(s.chatConfiguration={chatType:e[4],chatTags:e[5],chatId:e[8],chatReferenceTags:e[6]}),128&i&&(s.relays=e[7]),n.$set(s),(!o||1024&i&&r!==(r="absolute bottom-20 right-0 w-96 bg-white rounded-md shadow-md flex flex-col transition-all text-sm "+(e[10]?"hidden":"")+" svelte-ika13l"))&&C(t,"class",r)},i(e){o||(Z(n.$$.fragment,e),o=!0)},o(e){J(n.$$.fragment,e),o=!1},d(e){e&&v(t),ne(n)}}}function vd(e){let t,n,r,o,i,s,a,c,l,h,f,d,p="true"!==e[1]&&gd(),y="true"!==e[0]&&bd(),g=e[9]&&wd(e);return{c(){t=_("div"),n=_("div"),r=_("span"),p&&p.c(),o=k(),i=_("span"),s=E("Chat"),c=k(),y&&y.c(),l=k(),g&&g.c(),C(i,"class",a=u("true"!==e[1]?"text-purple-300":"text-white")+" svelte-ika13l"),C(r,"class","tracking-wider flex svelte-ika13l"),C(n,"class","text-white cursor-pointer shadow-md bg-purple-900 hover:bg-purple-700 w-full p-4 rounded-full flex-shrink-1 text-center font-semibold flex flex-row items-center gap-4 svelte-ika13l"),C(t,"id","_chat-widget-container"),C(t,"class","font-sans svelte-ika13l")},m(a,u){w(a,t,u),b(t,n),b(n,r),p&&p.m(r,null),b(r,o),b(r,i),b(i,s),b(n,c),y&&y.m(n,null),b(t,l),g&&g.m(t,null),h=!0,f||(d=A(n,"click",O(e[11])),f=!0)},p(e,[s]){"true"!==e[1]?p||(p=gd(),p.c(),p.m(r,o)):p&&(p.d(1),p=null),(!h||2&s&&a!==(a=u("true"!==e[1]?"text-purple-300":"text-white")+" svelte-ika13l"))&&C(i,"class",a),"true"!==e[0]?y||(y=bd(),y.c(),y.m(n,null)):y&&(y.d(1),y=null),e[9]?g?(g.p(e,s),512&s&&Z(g,1)):(g=wd(e),g.c(),Z(g,1),g.m(t,null)):g&&(V(),J(g,1,1,(()=>{g=null})),Y())},i(e){h||(Z(g),h=!0)},o(e){J(g),h=!1},d(e){e&&v(t),p&&p.d(),y&&y.d(),g&&g.d(),f=!1,d()}}}function md(e,t,n){let{accentColor:r}=t,{hideNostrIcon:o}=t,{simplifyNostrText:i}=t,{startPage:s}=t,{websiteOwnerPubkey:a}=t,{chatType:c}=t,{chatTags:u}=t,{chatReferenceTags:l}=t,{relays:h}=t,{chatId:f}=t;console.log("accentColor",r),0!==r.length&&(document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-50",r[0]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-100",r[1]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-200",r[2]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-300",r[3]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-400",r[4]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-500",r[5]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-600",r[6]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-700",r[7]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-800",r[8]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-900",r[9]),document.documentElement.style.setProperty("--nostri-chat-custom-accent-color-950",r[10]));let d=!1,p=!1;return e.$$set=e=>{"accentColor"in e&&n(12,r=e.accentColor),"hideNostrIcon"in e&&n(0,o=e.hideNostrIcon),"simplifyNostrText"in e&&n(1,i=e.simplifyNostrText),"startPage"in e&&n(2,s=e.startPage),"websiteOwnerPubkey"in e&&n(3,a=e.websiteOwnerPubkey),"chatType"in e&&n(4,c=e.chatType),"chatTags"in e&&n(5,u=e.chatTags),"chatReferenceTags"in e&&n(6,l=e.chatReferenceTags),"relays"in e&&n(7,h=e.relays),"chatId"in e&&n(8,f=e.chatId)},[o,i,s,a,c,u,l,h,f,d,p,()=>{d?n(10,p=!p):n(9,d=!d)},r]}var _d=document.createElement("DIV"),xd=document.currentScript;const Ed=xd.getAttribute("data-website-owner-pubkey"),kd=xd.getAttribute("data-chat-type");let Sd=xd.getAttribute("data-chat-tags"),Ad=xd.getAttribute("data-chat-id"),Od=xd.getAttribute("data-chat-reference-tags"),Cd=xd.getAttribute("data-relays"),Pd=xd.getAttribute("data-start-page"),Id=xd.getAttribute("data-hidenostricon"),Ld=xd.getAttribute("data-simplifynostrnext"),jd=xd.getAttribute("data-accentcolor");xd.parentNode.insertBefore(_d,xd),Cd||(Cd="wss://relay.f7z.io,wss://nos.lol,wss://relay.nostr.info,wss://nostr-pub.wellorder.net,wss://relay.current.fyi,wss://relay.nostr.band"),Cd=Cd.split(","),Sd=Sd?Sd.split(","):[],Od=Od?Od.split(","):[],jd=jd?jd.split(","):[],new class extends ie{constructor(e){super(),oe(this,e,md,vd,i,{accentColor:12,hideNostrIcon:0,simplifyNostrText:1,startPage:2,websiteOwnerPubkey:3,chatType:4,chatTags:5,chatReferenceTags:6,relays:7,chatId:8})}}({target:_d,props:{accentColor:jd,hideNostrIcon:Id,simplifyNostrText:Ld,startPage:Pd,websiteOwnerPubkey:Ed,chatType:kd,chatTags:Sd,chatId:Ad,chatReferenceTags:Od,relays:Cd}})}();
//# sourceMappingURL=bundle.js.map
